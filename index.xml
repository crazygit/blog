<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Soul Mate</title><link>https://crazygit.wiseturtles.com/</link><description>Recent content on Soul Mate</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Fri, 29 Nov 2019 15:29:29 +0800</lastBuildDate><atom:link href="https://crazygit.wiseturtles.com/index.xml" rel="self" type="application/rss+xml"/><item><title>fluentd教程(含实例)</title><link>https://crazygit.wiseturtles.com/2019/11/29/fluentd-tutorial/</link><pubDate>Fri, 29 Nov 2019 15:29:29 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2019/11/29/fluentd-tutorial/</guid><description>&lt;p>fluentd是一个开源的日志收集系统，能够收集各式各样的日志, 并将日志转换成方便机器处理的json格式。&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/1574818088.png" alt="fluentd日志架构">&lt;/p>
&lt;h2 id="安装">安装&lt;/h2>
&lt;p>不同操作系统的安装方式不同，具体可以参考:&lt;/p>
&lt;p>&lt;a href="https://docs.fluentd.org/installation">官方文档: Installation&lt;/a>&lt;/p>
&lt;p>另外在生产环境中安装Fluentd之前，也需要对操作系统做一些配置，如:&lt;/p>
&lt;ul>
&lt;li>设置好NTP时间同步&lt;/li>
&lt;li>调整允许操作的文件符最大个数&lt;/li>
&lt;li>优化内核中与网络相关的参数等&lt;/li>
&lt;/ul>
&lt;p>具体配置可以参考:&lt;/p>
&lt;p>&lt;a href="https://docs.fluentd.org/installation/before-install">官方文档: Before Installation&lt;/a>&lt;/p>
&lt;p>本文为了便于快速测试，直接使用fluentd的docker镜像来启动fluentd服务。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 下载fluentd镜像&lt;/span>
$ docker pull fluent/fluentd:v1.7-1
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="准备配置文件">准备配置文件&lt;/h3>
&lt;p>首先创建一些简单的文件方便测试。本文所有使用到的配置文件都已经上传到github,可以直接下载使用&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git clone https://github.com/crazygit/fluentd_demo
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>当然也可以自己动手完成&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ mkdir fluentd_demo
&lt;span class="c1"># 注意: 本文后续所有命令都在fluentd_demo目录下执行&lt;/span>
$ &lt;span class="nb">cd&lt;/span> fluentd_demo
&lt;span class="c1"># 创建用于保存fluentd的配置文件的etc目录和保存日志文件的log目录&lt;/span>
$ mkdir -p etc log
&lt;span class="c1"># 再创建一个简单的配置文件&lt;/span>
$ cat etc/fluentd_basic_setup.conf
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type http
port &lt;span class="m">8888&lt;/span>
&lt;span class="nb">bind&lt;/span> 0.0.0.0
&amp;lt;/source&amp;gt;
&amp;lt;match test.cycle&amp;gt;
@type stdout
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>配置文件解释:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>source&lt;/code>部分使用了&lt;code>http&lt;/code>输入插件，在&lt;code>8888&lt;/code>端口启动一个web服务用于收集日志&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>match&lt;/code>部分定义只要日志匹配&lt;code>test.cycle&lt;/code>标签，就将日志输出到标准输出&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>目前不用太关心配置文件的格式，后面会有详细的介绍。&lt;/p>
&lt;p>创建好的目录结构如下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">$ tree
.
├── etc
│   └── fluentd_basic_setup.conf
└── log
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="启动容器">启动容器&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker run -p 8888:8888 --rm -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>/etc:/fluentd/etc -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>/log:/fluentd/log fluent/fluentd:v1.7-1 -c /fluentd/etc/fluentd_basic_setup.conf -v
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令参数解释如下:&lt;/p>
&lt;ul>
&lt;li>&lt;code>-p&lt;/code>参数映射容器的&lt;code>8888&lt;/code>端口到宿主机的&lt;code>8888&lt;/code>端口，方便我们直接从宿主机直接访问容器&lt;/li>
&lt;li>第一个&lt;code>-v&lt;/code>参数用于挂载本地的&lt;code>etc&lt;/code>目录到容器内的&lt;code>etc&lt;/code>目录，让容器能够使用本地的配置文件&lt;/li>
&lt;li>第二个&lt;code>-v&lt;/code>参数用于挂载本地的&lt;code>log&lt;/code>目录到容器内的&lt;code>log&lt;/code>目录，便于保存输出的日志文件&lt;/li>
&lt;li>&lt;code>-c&lt;/code>参数用于设置容器内的&lt;code>fluentd&lt;/code>时候启动的使用&lt;code>/fluentd/etc/fluentd_basic_setup.conf&lt;/code>配置文件&lt;/li>
&lt;li>最后一个参数&lt;code>-v&lt;/code>用于设置容器内的&lt;code>fluentd&lt;/code>时候启动的开启&lt;code>verbose&lt;/code>模式，便于调试发现问题。&lt;/li>
&lt;/ul>
&lt;p>正常启动后，能看到如下输出&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">fluentd -c /fluentd/etc/fluentd_basic_setup.conf -v
2019-11-27 02:03:22 +0000 [info]: fluent/log.rb:322:info: parsing config file is succeeded path=&amp;#34;/fluentd/etc/fluentd_basic_setup.conf&amp;#34;
2019-11-27 02:03:22 +0000 [info]: fluent/log.rb:322:info: using configuration file: &amp;lt;ROOT&amp;gt;
&amp;lt;source&amp;gt;
@type http
port 8888
bind &amp;#34;0.0.0.0&amp;#34;
&amp;lt;/source&amp;gt;
&amp;lt;match test.cycle&amp;gt;
@type stdout
&amp;lt;/match&amp;gt;
&amp;lt;/ROOT&amp;gt;
2019-11-27 02:03:22 +0000 [info]: fluent/log.rb:322:info: starting fluentd-1.7.4 pid=6 ruby=&amp;#34;2.5.7&amp;#34;
2019-11-27 02:03:22 +0000 [info]: fluent/log.rb:322:info: spawn command to main: cmdline=[&amp;#34;/usr/bin/ruby&amp;#34;, &amp;#34;-Eascii-8bit:ascii-8bit&amp;#34;, &amp;#34;/usr/bin/fluentd&amp;#34;, &amp;#34;-c&amp;#34;, &amp;#34;/fluentd/etc/fluentd_basic_setup.conf&amp;#34;, &amp;#34;-v&amp;#34;, &amp;#34;-p&amp;#34;, &amp;#34;/fluentd/plugins&amp;#34;, &amp;#34;--under-supervisor&amp;#34;]
2019-11-27 02:03:23 +0000 [info]: fluent/log.rb:322:info: gem &amp;#39;fluentd&amp;#39; version &amp;#39;1.7.4&amp;#39;
2019-11-27 02:03:23 +0000 [info]: fluent/log.rb:322:info: adding match pattern=&amp;#34;test.cycle&amp;#34; type=&amp;#34;stdout&amp;#34;
2019-11-27 02:03:23 +0000 [info]: fluent/log.rb:322:info: adding source type=&amp;#34;http&amp;#34;
2019-11-27 02:03:23 +0000 [info]: #0 fluent/log.rb:322:info: starting fluentd worker pid=14 ppid=6 worker=0
2019-11-27 02:03:23 +0000 [debug]: #0 fluent/log.rb:302:debug: listening http bind=&amp;#34;0.0.0.0&amp;#34; port=8888
2019-11-27 02:03:23 +0000 [info]: #0 fluent/log.rb:322:info: fluentd worker is now running worker=0
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>另外，也可以通过环境变量&lt;code>FLUENTD_CONF&lt;/code>设置需要使用的配置文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 下面的命令和上面的是等效的&lt;/span>
$ docker run -p 8888:8888 --rm -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>/etc:/fluentd/etc/ -e &lt;span class="nv">FLUENTD_CONF&lt;/span>&lt;span class="o">=&lt;/span>fluentd_basic_setup.conf fluent/fluentd:v1.7-1
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="测试">测试&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 任意伪造一个用户登录的日志，向fluentd服务提交日志&lt;/span>
$ curl -i -X POST -d &lt;span class="s1">&amp;#39;json={&amp;#34;action&amp;#34;:&amp;#34;login&amp;#34;,&amp;#34;user&amp;#34;:2}&amp;#39;&lt;/span> http://localhost:8888/test.cycle
HTTP/1.1 &lt;span class="m">200&lt;/span> OK
Content-Type: text/plain
Connection: Keep-Alive
Content-Length: &lt;span class="m">0&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在&lt;code>fluentd&lt;/code>的容器里能看到如下输出&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">2019-11-27 02:05:16.583154500 +0000 test.cycle: {&amp;#34;action&amp;#34;:&amp;#34;login&amp;#34;,&amp;#34;user&amp;#34;:2}
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="fluentd事件的生命周期">Fluentd事件的生命周期&lt;/h2>
&lt;h3 id="什么是事件event">什么是事件(Event)&lt;/h3>
&lt;p>正如开篇提到过，Fluentd是一个日志收集系统，那么一条日志消息，在Fluentd里就认为是一个事件(&lt;code>Event&lt;/code>)。&lt;/p>
&lt;h3 id="事件结构">事件结构&lt;/h3>
&lt;p>Fluentd的事件由下面三部分组成&lt;/p>
&lt;ul>
&lt;li>标签(&lt;code>tag&lt;/code>): 用于说明这个事件是哪里产生的，可用于后面的事件路由&lt;/li>
&lt;li>时间(&lt;code>time&lt;/code>): 事件是什么时候发生的，时间格式为: &lt;a href="https://en.wikipedia.org/wiki/Unix_time">Epoch time&lt;/a>, 即Unix时间戳&lt;/li>
&lt;li>记录(&lt;code>record&lt;/code>): 事件内容本身，JSON格式&lt;/li>
&lt;/ul>
&lt;p>所有的输入插件都需要解析原始日志，生成满足上面结构的事件字段，比如，一条Apache的访问日志:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">192.168.0.1 - - [28/Feb/2013:12:00:00 +0900] &amp;#34;GET / HTTP/1.1&amp;#34; 200 777
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>通过&lt;code>in_tail&lt;/code>输入插件处理之后，将会得到下面的输出&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">tag: apache.access &lt;span class="c1"># 由配置文件指定&lt;/span>
time: &lt;span class="m">1362020400&lt;/span> &lt;span class="c1"># 28/Feb/2013:12:00:00 +0900&lt;/span>
record: &lt;span class="o">{&lt;/span>&lt;span class="s2">&amp;#34;user&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;-&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;method&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;GET&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;code&amp;#34;&lt;/span>:200,&lt;span class="s2">&amp;#34;size&amp;#34;&lt;/span>:777,&lt;span class="s2">&amp;#34;host&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;192.168.0.1&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;path&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="事件的处理流程">事件的处理流程&lt;/h3>
&lt;p>当fluentd收到一个事件之后，会经过一系列的处理流程:&lt;/p>
&lt;ol>
&lt;li>如修改事件的相关字段&lt;/li>
&lt;li>过滤掉一些不关心的事件&lt;/li>
&lt;li>路由事件输出到不同的地方&lt;/li>
&lt;/ol>
&lt;p>下面将一一介绍介绍事件的处理流程&lt;/p>
&lt;h4 id="过滤器filter">过滤器(Filter）&lt;/h4>
&lt;p>Filter用于定义一个事件是该被接受或者是被过滤掉(抛弃掉)。使用示例如下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat etc/fluentd_filter_demo.conf
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type http
port &lt;span class="m">8888&lt;/span>
&lt;span class="nb">bind&lt;/span> 0.0.0.0
&amp;lt;/source&amp;gt;
&amp;lt;filter test.cycle&amp;gt;
@type grep
&amp;lt;exclude&amp;gt;
key action
pattern ^logout$
&amp;lt;/exclude&amp;gt;
&amp;lt;/filter&amp;gt;
&amp;lt;match test.cycle&amp;gt;
@type stdout
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面的示例配置了让我们直接过滤掉用户&lt;code>logout&lt;/code>的事件。&lt;/p>
&lt;p>重启fluentd,使用上面的定义的配置文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker run -p 8888:8888 --rm -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>/etc:/fluentd/etc -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>/log:/fluentd/log fluent/fluentd:v1.7-1 -c /fluentd/etc/fluentd_filter_demo.conf -v
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>测试&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -i -X POST -d &lt;span class="s1">&amp;#39;json={&amp;#34;action&amp;#34;:&amp;#34;login&amp;#34;,&amp;#34;user&amp;#34;:2}&amp;#39;&lt;/span> http://localhost:8888/test.cycle
HTTP/1.1 &lt;span class="m">200&lt;/span> OK
Content-type: text/plain
Connection: Keep-Alive
Content-length: &lt;span class="m">0&lt;/span>
$ curl -i -X POST -d &lt;span class="s1">&amp;#39;json={&amp;#34;action&amp;#34;:&amp;#34;logout&amp;#34;,&amp;#34;user&amp;#34;:2}&amp;#39;&lt;/span> http://localhost:8888/test.cycle
HTTP/1.1 &lt;span class="m">200&lt;/span> OK
Content-type: text/plain
Connection: Keep-Alive
Content-length: &lt;span class="m">0&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>我们向fluentd发送了两个事件，分别是用户&lt;code>login&lt;/code>和&lt;code>logout&lt;/code>的事件。&lt;/p>
&lt;p>检查&lt;code>fluend&lt;/code>的输出&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">2019-11-27 03:38:28.973757600 +0000 test.cycle: {&amp;#34;action&amp;#34;:&amp;#34;login&amp;#34;,&amp;#34;user&amp;#34;:2}
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看到只输出了用户&lt;code>login&lt;/code>的事件，&lt;code>logout&lt;/code>事件被过滤掉了。&lt;/p>
&lt;h4 id="标识符labels">标识符(Labels)&lt;/h4>
&lt;p>从前面的例子里，我们可以看到，&lt;code>fluentd&lt;/code>的处理流程是根据我们在配置文件中的定义，从上到下依次执行的。假如我们在配置文件里定义了比较多输入源，不同的输入源需要使用不同的filters时，如果仍然按照从上到下执行的顺序的话，由于不同的处理需求，我们的配置文件可能变得非常复杂。&lt;/p>
&lt;p>通过&lt;code>label&lt;/code>，我们可以为不同的输入源指定不同的处理流程，示例如下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat etc/fluentd_labels.conf
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type http
&lt;span class="nb">bind&lt;/span> 0.0.0.0
port &lt;span class="m">8888&lt;/span>
@label @STAGING &lt;span class="c1"># 注意这里我们添加了label&lt;/span>
&amp;lt;/source&amp;gt;
&amp;lt;filter test.cycle&amp;gt;
@type grep
&amp;lt;exclude&amp;gt;
key action
pattern ^login$
&amp;lt;/exclude&amp;gt;
&amp;lt;/filter&amp;gt;
&amp;lt;label @STAGING&amp;gt;
&amp;lt;filter test.cycle&amp;gt;
@type grep
&amp;lt;exclude&amp;gt;
key action
pattern ^logout$
&amp;lt;/exclude&amp;gt;
&amp;lt;/filter&amp;gt;
&amp;lt;match test.cycle&amp;gt;
@type stdout
&amp;lt;/match&amp;gt;
&amp;lt;/label&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面的示例文件里，我们首先定义了一个filter过滤掉&lt;code>login&lt;/code>事件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">&amp;lt;filter test.cycle&amp;gt;
@type grep
&amp;lt;exclude&amp;gt;
key action
pattern ^login$
&amp;lt;/exclude&amp;gt;
&amp;lt;/filter&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>接着又在&lt;code>label&lt;/code>块里面过滤掉了&lt;code>logout&lt;/code>事件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">&amp;lt;filter test.cycle&amp;gt;
@type grep
&amp;lt;exclude&amp;gt;
key action
pattern ^login$
&amp;lt;/exclude&amp;gt;
&amp;lt;/filter&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>如果按照从上到下的顺序执行，那么我们将看不到任何&lt;code>login&lt;/code>和&lt;code>logout&lt;/code>的事件。但是实际结果如何呢？让我们来测试一下。&lt;/p>
&lt;p>使用上面定义的配置文件启动fluentd&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker run -p 8888:8888 --rm -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>/etc:/fluentd/etc -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>/log:/fluentd/log fluent/fluentd:v1.7-1 -c /fluentd/etc/fluentd_labels.conf -v
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>提交事件来测试, 同样向fluentd发送两个事件，分别是用户&lt;code>login&lt;/code>和&lt;code>logout&lt;/code>的事件。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -i -X POST -d &lt;span class="s1">&amp;#39;json={&amp;#34;action&amp;#34;:&amp;#34;login&amp;#34;,&amp;#34;user&amp;#34;:2}&amp;#39;&lt;/span> http://localhost:8888/test.cycle
HTTP/1.1 &lt;span class="m">200&lt;/span> OK
Content-Type: text/plain
Connection: Keep-Alive
Content-Length: &lt;span class="m">0&lt;/span>
$ curl -i -X POST -d &lt;span class="s1">&amp;#39;json={&amp;#34;action&amp;#34;:&amp;#34;logout&amp;#34;,&amp;#34;user&amp;#34;:2}&amp;#39;&lt;/span> http://localhost:8888/test.cycle
HTTP/1.1 &lt;span class="m">200&lt;/span> OK
Content-Type: text/plain
Connection: Keep-Alive
Content-Length: &lt;span class="m">0&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查看fluentd输出&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">2019-11-27 03:51:45.088464900 +0000 test.cycle: {&amp;#34;action&amp;#34;:&amp;#34;login&amp;#34;,&amp;#34;user&amp;#34;:2}
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看到，只有&lt;code>logout&lt;/code>事件被过滤了，原因是我们为输入设置了label&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">&amp;lt;source&amp;gt;
@type http
bind 0.0.0.0
port 8888
@label @STAGING # 注意这里我们添加了label
&amp;lt;/source&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>因此跳过中间设置的一些filter，只运行了&lt;code>&amp;lt;label @STAGING&amp;gt;...&amp;lt;/lable&amp;gt;&lt;/code>标签块里的&lt;code>filter&lt;/code>&lt;/p>
&lt;h4 id="缓冲区buffers">缓冲区(Buffers)&lt;/h4>
&lt;p>在前面的例子中，我们使用的都是&lt;code>stdout&lt;/code>这样一个没有缓冲区的输出，在生产环境中，我们用到的输出基本都是有缓冲区
的,比如&lt;code>s3&lt;/code>, &lt;code>forward&lt;/code>,&lt;code>mongodb&lt;/code>等，这些输出插件在收到事件之后，会将事件先保存到缓冲区，然后等满足特定条件之后，再将事件输出到目标输出。&lt;/p>
&lt;h2 id="配置文件语法">配置文件语法&lt;/h2>
&lt;p>配置文件由一下几部分组成&lt;/p>
&lt;h3 id="配置文件中的术语">配置文件中的术语&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;code>source&lt;/code>: 指定输入源&lt;/p>
&lt;p>例如:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 在24224端口接受TCP事件&lt;/span>
&amp;lt;source&amp;gt;
@type forward
port &lt;span class="m">24224&lt;/span>
&amp;lt;/source&amp;gt;
&amp;lt;source&amp;gt;
@type http
port &lt;span class="m">9880&lt;/span>
&amp;lt;/source&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>输入源可以一次指定多个， &lt;code>@type&lt;/code>参数指定使用哪一个输入插件。
fluentd支持各种输入插件, 比如:&lt;/p>
&lt;ul>
&lt;li>in_tail&lt;/li>
&lt;li>in_forward&lt;/li>
&lt;li>in_udp&lt;/li>
&lt;li>in_tcp&lt;/li>
&lt;li>in_unix&lt;/li>
&lt;li>in_http&lt;/li>
&lt;li>in_syslog&lt;/li>
&lt;li>in_exec&lt;/li>
&lt;li>in_dummy&lt;/li>
&lt;li>in_windows_eventlog&lt;/li>
&lt;/ul>
&lt;p>插件的具体使用可以参考文档:
&lt;a href="https://docs.fluentd.org/input">https://docs.fluentd.org/input&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>match&lt;/code>: 指定输出的目的地&lt;/p>
&lt;p>例如:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 将满足myapp.acccess标签的事件全部输出到&lt;/span>
&lt;span class="c1"># /var/log/fluent/access.%Y-%m-%d&lt;/span>
&amp;lt;match myapp.access&amp;gt;
@type file
path /var/log/fluent/access
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>输出也可以一次指定多个， &lt;code>@type&lt;/code>参数指定使用哪一个输出插件。
fluentd支持各种输出插件, 比如:&lt;/p>
&lt;ul>
&lt;li>out_copy&lt;/li>
&lt;li>out_null&lt;/li>
&lt;li>out_roundrobin&lt;/li>
&lt;li>out_stdout&lt;/li>
&lt;li>out_exec_filter&lt;/li>
&lt;li>out_forward&lt;/li>
&lt;li>out_mongo or out_mongo_replset&lt;/li>
&lt;li>out_exec&lt;/li>
&lt;li>out_file&lt;/li>
&lt;li>out_s3&lt;/li>
&lt;li>out_webhdfs&lt;/li>
&lt;/ul>
&lt;p>插件的具体使用可以参考文档:
&lt;a href="https://docs.fluentd.org/output">https://docs.fluentd.org/output&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>filter&lt;/code>: 指定事件的处理流程&lt;/p>
&lt;p>可以多个filter串联起来，比如:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">Input -&amp;gt; filter 1 -&amp;gt; ... -&amp;gt; filter N -&amp;gt; Output
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>例如:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">&amp;lt;filter myapp.access&amp;gt;
@type record_transformer
&amp;lt;record&amp;gt;
host_param &amp;#34;#{Socket.gethostname}&amp;#34;
&amp;lt;/record&amp;gt;
&amp;lt;/filter&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面的&lt;code>filter&lt;/code>会添加&lt;code>host_param&lt;/code>参数到事件&lt;/p>
&lt;p>fluentd也内置了各种&lt;code>filter&lt;/code>, 比如:&lt;/p>
&lt;ul>
&lt;li>grep&lt;/li>
&lt;li>record-transformer&lt;/li>
&lt;li>filter_stdout&lt;/li>
&lt;li>geoip&lt;/li>
&lt;li>parser&lt;/li>
&lt;/ul>
&lt;p>filter的具体使用可以参考文档:&lt;/p>
&lt;p>&lt;a href="https://docs.fluentd.org/filter">https://docs.fluentd.org/filter&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>system&lt;/code>: 指定系统级别的配置&lt;/p>
&lt;p>可以设置的参数有&lt;/p>
&lt;ul>
&lt;li>log_level&lt;/li>
&lt;li>suppress_repeated_stacktrace&lt;/li>
&lt;li>emit_error_log_interval&lt;/li>
&lt;li>suppress_config_dump&lt;/li>
&lt;li>without_source&lt;/li>
&lt;li>process_name (only available in system directive. No fluentd option)&lt;/li>
&lt;/ul>
&lt;p>例如:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;system&amp;gt;
&lt;span class="c1"># equal to -qq option&lt;/span>
log_level error
&lt;span class="c1"># equal to --without-source option&lt;/span>
without_source
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/system&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>label&lt;/code>: 用于分组特定的filter和match&lt;/p>
&lt;p>例如:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type forward
&amp;lt;/source&amp;gt;
&amp;lt;source&amp;gt;
@type tail
@label @SYSTEM
&amp;lt;/source&amp;gt;
&amp;lt;filter access.**&amp;gt;
@type record_transformer
&amp;lt;record&amp;gt;
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/record&amp;gt;
&amp;lt;/filter&amp;gt;
&amp;lt;match **&amp;gt;
@type elasticsearch
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/match&amp;gt;
&amp;lt;label @SYSTEM&amp;gt;
&amp;lt;filter var.log.middleware.**&amp;gt;
@type grep
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/filter&amp;gt;
&amp;lt;match **&amp;gt;
@type s3
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/match&amp;gt;
&amp;lt;/label&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面的配置文件中:&lt;/p>
&lt;p>&lt;code>in_forward&lt;/code>的事件将经过&lt;code>record_transformer&lt;/code> 过滤器和&lt;code>elasticsearch&lt;/code>输出。&lt;/p>
&lt;p>&lt;code>in_tail&lt;/code>输入的事件将经过&lt;code>grep&lt;/code>过滤器和&lt;code>s3&lt;/code>输出。&lt;/p>
&lt;p>另外: &lt;code>&amp;lt;label @ERROR&amp;gt;&lt;/code>属于内置的配置，用于保存内部错误，比如:
缓冲区已经满了或者无效的事件等。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>@include&lt;/code>: 引入其它的配置文件。可以将配置文件拆分为多个，便于复用。当要使用的时候，直接使用&lt;code>@include&lt;/code>引入即可，例如：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 通过绝对路径引入&lt;/span>
@include /path/to/config.conf
&lt;span class="c1"># 通过相对路径引入，相对于当前配置文件的路径&lt;/span>
@include extra.conf
&lt;span class="c1"># 模糊匹配，所有符合条件的会根据文件名的字母顺序依次导入&lt;/span>
&lt;span class="c1"># 比如: a.conf, b.conf, ..., z.conf&lt;/span>
&lt;span class="c1"># 因此, 要注意各个配置文件不应该有顺#序依赖，如果有顺序依赖，请明确指出导入的文件名&lt;/span>
@include config.d/*.conf
&lt;span class="c1"># 使用在线的配置&lt;/span>
@include http://example.com/fluent.conf
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>@include&lt;/code>指定也可以用于导入相关的参数信息，比如:&lt;/p>
&lt;p>有如下配置文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;match pattern&amp;gt;
@type forward
&lt;span class="c1"># other parameters...&lt;/span>
&amp;lt;buffer&amp;gt;
@type file
path /path/to/buffer/forward
@include /path/to/out_buf_params.conf
&amp;lt;/buffer&amp;gt;
&amp;lt;/match&amp;gt;
&amp;lt;match pattern&amp;gt;
@type elasticsearch
&lt;span class="c1"># other parameters...&lt;/span>
&amp;lt;buffer&amp;gt;
@type file
path /path/to/buffer/es
@include /path/to/out_buf_params.conf
&amp;lt;/buffer&amp;gt;
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>参数配置文件&lt;code>/path/to/out_buf_params.conf&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">flush_interval 5s
total_limit_size 100m
chunk_limit_size 1m
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="配置文件的模式匹配patterns">配置文件的模式匹配(patterns)&lt;/h3>
&lt;h4 id="通配符">通配符&lt;/h4>
&lt;p>如前面的示例可以看到，fluented主要根据事件的tag来分区不同的处理流程&lt;/p>
&lt;p>虽然我们可以明确指定需要处理的tag，比如:&lt;code>&amp;lt;filter app.log&amp;gt;&lt;/code>来指定只处理tag为&lt;code>app.log&lt;/code>的事件。我们也可以在&lt;code>filter&lt;/code>和&lt;code>match&lt;/code>中通过通配符，来处理同一类tag的事件&lt;/p>
&lt;p>tag通常是一个字符串，由&lt;code>.&lt;/code>分隔，比如&lt;code>myapp.access&lt;/code>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>*&lt;/code>: 匹配满足一个tag部分的事件, 比如: &lt;code>a.*&lt;/code>, 它将匹配&lt;code>a.b&lt;/code>这样的tag, 但是不会处理&lt;code>a&lt;/code>或者&lt;code>a.b.c&lt;/code>这类tag&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>**&lt;/code>: 匹配满足0个或多个tag部分，比如: &lt;code>a.**&lt;/code>, 它将匹配&lt;code>a&lt;/code>, &lt;code>a.b&lt;/code>, &lt;code>a.b.c&lt;/code>这三种tag&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>{X, Y, Z}&lt;/code>: 匹配满足&lt;code>X&lt;/code>,&lt;code>Y&lt;/code>或者&lt;code>Z&lt;/code>的tag, 比如: &lt;code>{a, b}&lt;/code>将匹配&lt;code>a&lt;/code>或者&lt;code>b&lt;/code>,但是不会匹配&lt;code>c&lt;/code>。&lt;/p>
&lt;p>这种格式也可以和通配符组合使用,比如&lt;code>a.{b.c}.*&lt;/code>或&lt;code>a.{b.c}.**&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>#{...}&lt;/code> 会把花括号内的字符串当做是&lt;code>ruby&lt;/code>的表达式处理。比如&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">&amp;lt;match &amp;#34;app.#{ENV[&amp;#39;FLUENTD_TAG&amp;#39;]}&amp;#34;&amp;gt;
@type stdout
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>如果设置了环境变量&lt;code>FLUENTD_TAG&lt;/code>为&lt;code>dev&lt;/code>,那上面等价于&lt;code>app.dev&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>当指定了多个模式时（使用一个或多个空格分开）,只要满足其中任意一个就行。&lt;/p>
&lt;p>比如:
&lt;code>&amp;lt;match a b&amp;gt;&lt;/code>匹配&lt;code>a&lt;/code>和&lt;code>b&lt;/code>
&lt;code>&amp;lt;match a.** b.*&amp;gt;&lt;/code>匹配&lt;code>a&lt;/code>, &lt;code>a.b&lt;/code>, &lt;code>a.b.c&lt;/code>, &lt;code>b.d&lt;/code>等&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="多个match之间的顺序注意">多个match之间的顺序注意&lt;/h4>
&lt;p>当有多个match, 需要注意一下它们的顺序， 如下面的例子，第二个match永远也不会生效&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback"># ** matches all tags. Bad :(
&amp;lt;match **&amp;gt;
@type blackhole_plugin
&amp;lt;/match&amp;gt;
&amp;lt;match myapp.access&amp;gt;
@type file
path /var/log/fluent/access
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>正确的写发应该是将确定的tag尽量写在前面，模糊匹配的写在后面。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;match myapp.access&amp;gt;
@type file
path /var/log/fluent/access
&amp;lt;/match&amp;gt;
&lt;span class="c1"># Capture all unmatched tags. Good :)&lt;/span>
&amp;lt;match **&amp;gt;
@type blackhole_plugin
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>如果需要将输出到多个match,需要使用&lt;code>out_copy&lt;/code>插件。&lt;/p>
&lt;p>另外需要注意顺序的是&lt;code>filter&lt;/code>和&lt;code>match&lt;/code>, 如果将&lt;code>filter&lt;/code>放在&lt;code>match&lt;/code>之后，那么它也永远不会生效，正确的用法如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># You should NOT put this &amp;lt;filter&amp;gt; block after the &amp;lt;match&amp;gt; block below.&lt;/span>
&lt;span class="c1"># If you do, Fluentd will just emit events without applying the filter.&lt;/span>
&amp;lt;filter myapp.access&amp;gt;
@type record_transformer
...
&amp;lt;/filter&amp;gt;
&amp;lt;match myapp.access&amp;gt;
@type file
path /var/log/fluent/access
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="常见的配置文件示例">常见的配置文件示例&lt;/h3>
&lt;p>下面给出了一些常见的使用场景的配置文件写法&lt;/p>
&lt;h4 id="简单的输入过滤输出">简单的输入，过滤，输出&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type forward
&amp;lt;/source&amp;gt;
&amp;lt;filter app.**&amp;gt;
@type record_transformer
&amp;lt;record&amp;gt;
hostname &lt;span class="s2">&amp;#34;#{Socket.gethostname}&amp;#34;&lt;/span>
&amp;lt;/record&amp;gt;
&amp;lt;/filter&amp;gt;
&amp;lt;match app.**&amp;gt;
@type file
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="多个输入">多个输入&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type forward
&amp;lt;/source&amp;gt;
&amp;lt;source&amp;gt;
@type tail
tag system.logs
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/source&amp;gt;
&amp;lt;filter app.**&amp;gt;
@type record_transformer
&amp;lt;record&amp;gt;
hostname &lt;span class="s2">&amp;#34;#{Socket.gethostname}&amp;#34;&lt;/span>
&amp;lt;/record&amp;gt;
&amp;lt;/filter&amp;gt;
&amp;lt;match &lt;span class="o">{&lt;/span>app.**,system.logs&lt;span class="o">}&lt;/span>&amp;gt;
@type file
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="使用label的输出">使用Label的输出&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type forward
&amp;lt;/source&amp;gt;
&amp;lt;source&amp;gt;
@type dstat
@label @METRICS &lt;span class="c1"># dstat events are routed to &amp;lt;label @METRICS&amp;gt;&lt;/span>
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/source&amp;gt;
&amp;lt;filter app.**&amp;gt;
@type record_transformer
&amp;lt;record&amp;gt;
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/record&amp;gt;
&amp;lt;/filter&amp;gt;
&amp;lt;match app.**&amp;gt;
@type file
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/match&amp;gt;
&amp;lt;label @METRICS&amp;gt;
&amp;lt;match **&amp;gt;
@type elasticsearch
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/match&amp;gt;
&amp;lt;/label&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="重新设置标签并重新路由fluent-plugin-routehttpsgithubcomtagomorisfluent-plugin-route-插件的使用">重新设置标签并重新路由(&lt;a href="https://github.com/tagomoris/fluent-plugin-route">fluent-plugin-route&lt;/a>插件的使用)&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;match worker.**&amp;gt;
@type route
remove_tag_prefix worker
add_tag_prefix metrics.event
&amp;lt;route **&amp;gt;
copy &lt;span class="c1"># For fall-through. Without copy, routing is stopped here.&lt;/span>
&amp;lt;/route&amp;gt;
&amp;lt;route **&amp;gt;
copy
@label @BACKUP
&amp;lt;/route&amp;gt;
&amp;lt;/match&amp;gt;
&amp;lt;match metrics.event.**&amp;gt;
@type stdout
&amp;lt;/match&amp;gt;
&amp;lt;label @BACKUP&amp;gt;
&amp;lt;match metrics.event.**&amp;gt;
@type file
path /var/log/fluent/bakcup
&amp;lt;/match&amp;gt;
&amp;lt;/label&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="根据事件内容重新路由fluent-plugin-rewrite-tag-filterhttpsgithubcomfluentfluent-plugin-rewrite-tag-filter插件的使用">根据事件内容重新路由(&lt;a href="https://github.com/fluent/fluent-plugin-rewrite-tag-filter">fluent-plugin-rewrite-tag-filter&lt;/a>插件的使用)&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type forward
&amp;lt;/source&amp;gt;
&lt;span class="c1"># event example: app.logs {&amp;#34;message&amp;#34;:&amp;#34;[info]: ...&amp;#34;}&lt;/span>
&amp;lt;match app.**&amp;gt;
@type rewrite_tag_filter
&amp;lt;rule&amp;gt;
key message
pattern ^&lt;span class="se">\[&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="se">\w&lt;/span>+&lt;span class="o">)&lt;/span>&lt;span class="se">\]&lt;/span>
tag &lt;span class="nv">$1&lt;/span>.&lt;span class="si">${&lt;/span>&lt;span class="nv">tag&lt;/span>&lt;span class="si">}&lt;/span>
&amp;lt;/rule&amp;gt;
&lt;span class="c1"># you can put more &amp;lt;rule&amp;gt;&lt;/span>
&amp;lt;/match&amp;gt;
&lt;span class="c1"># send mail when receives alert level logs&lt;/span>
&amp;lt;match alert.app.**&amp;gt;
@type mail
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/match&amp;gt;
&lt;span class="c1"># other logs are stored into file&lt;/span>
&amp;lt;match *.app.**&amp;gt;
@type file
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="重新路由事件到其它的labelout_relabelhttpsdocsfluentdorgoutputrelabel插件的使用">重新路由事件到其它的Label(&lt;a href="https://docs.fluentd.org/output/relabel">out_relabel&lt;/a>插件的使用)&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type forward
&amp;lt;/source&amp;gt;
&amp;lt;match app.**&amp;gt;
@type copy
&amp;lt;store&amp;gt;
@type forward
&lt;span class="c1"># ...&lt;/span>
&amp;lt;/store&amp;gt;
&amp;lt;store&amp;gt;
@type relabel
@label @NOTIFICATION
&amp;lt;/store&amp;gt;
&amp;lt;/match&amp;gt;
&amp;lt;label @NOTIFICATION&amp;gt;
&amp;lt;filter app.**&amp;gt;
@type grep
regexp1 message ERROR
&amp;lt;/filter&amp;gt;
&amp;lt;match app.**&amp;gt;
@type mail
&amp;lt;/match&amp;gt;
&amp;lt;/label&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="配置文件中的参数类型">配置文件中的参数类型&lt;/h3>
&lt;p>在配置文件中使用的插件，大部分都可以接受1个或多个参数，也可以指定参数类型&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>string&lt;/code>: 字符串类型&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>integer&lt;/code>: 整型&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>float&lt;/code>: 浮点型&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>size&lt;/code>: 字节(bytes)类型.为了便于阅读，它的值有几种常见的写法&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;lt;INTEGER&amp;gt;k&lt;/code>或&lt;code>&amp;lt;INTEGER&amp;gt;K&lt;/code> 表示使用单位&lt;code>KB&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;lt;INTEGER&amp;gt;m&lt;/code>或&lt;code>&amp;lt;INTEGER&amp;gt;M&lt;/code> 表示使用单位&lt;code>M&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;lt;INTEGER&amp;gt;g&lt;/code>或&lt;code>&amp;lt;INTEGER&amp;gt;G&lt;/code> 表示使用单位&lt;code>G&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;lt;INTEGER&amp;gt;t&lt;/code>或&lt;code>&amp;lt;INTEGER&amp;gt;T&lt;/code> 表示使用单位&lt;code>T&lt;/code>&lt;/li>
&lt;li>纯数字时表示使用默认单位为&lt;code>B&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>time&lt;/code>: 时间类型，默认单位为秒， 同样为了便于阅读，它的值也有几种常见的写法&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;lt;INTEGER&amp;gt;s&lt;/code>, 表示使用单位&lt;code>秒&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;lt;INTEGER&amp;gt;m&lt;/code>, 表示使用单位&lt;code>分钟&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;lt;INTEGER&amp;gt;h&lt;/code>, 表示使用单位&lt;code>小时&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;lt;INTEGER&amp;gt;d&lt;/code>, 表示使用单位&lt;code>天&lt;/code>&lt;/li>
&lt;li>纯数字时表示使用默认单位为&lt;code>秒&lt;/code>， &lt;code>0.1&lt;/code>表示&lt;code>100ms&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>array&lt;/code>: 数组类型。有两种写法:&lt;/p>
&lt;ul>
&lt;li>完整格式的写法: &lt;code>[&amp;quot;key1&amp;quot;, &amp;quot;key2&amp;quot;]&lt;/code>&lt;/li>
&lt;li>简写: &lt;code>key1,key2&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>hash&lt;/code>: 字典类型。也有两种写法:&lt;/p>
&lt;ul>
&lt;li>完整格式的写法: &lt;code>{&amp;quot;key1&amp;quot;:&amp;quot;value1&amp;quot;, &amp;quot;key2&amp;quot;:&amp;quot;value2&amp;quot;}&lt;/code>&lt;/li>
&lt;li>简写: &lt;code>key1:value1,key2:value2&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="常见的参数">常见的参数&lt;/h3>
&lt;p>以&lt;code>@&lt;/code>开始的参数表示fluented的保留参数&lt;/p>
&lt;ul>
&lt;li>&lt;code>@type&lt;/code>: 指定使用的参加类型&lt;/li>
&lt;li>&lt;code>@id&lt;/code>: 指定插件的ID&lt;/li>
&lt;li>&lt;code>@label&lt;/code>: 指定事件的标识符&lt;/li>
&lt;li>&lt;code>@log_level&lt;/code>: 指定类型&lt;/li>
&lt;/ul>
&lt;h3 id="模块section支持">模块(section)支持&lt;/h3>
&lt;p>下面的模块并不是所有的插件都支持，具体使用请结合使用的插件查看&lt;/p>
&lt;ul>
&lt;li>&lt;code>parse&lt;/code>: 指明如何解析原始内容，如解析nginx, apache日志等&lt;/li>
&lt;li>&lt;code>buffer&lt;/code>: 配置如何缓冲输出&lt;/li>
&lt;li>&lt;code>format&lt;/code>: 配置如何格式化事件&lt;/li>
&lt;li>&lt;code>extract&lt;/code>: 从事件中提取值&lt;/li>
&lt;li>&lt;code>inject&lt;/code>: 向事件注入一些属性&lt;/li>
&lt;li>&lt;code>transport&lt;/code>: 用于指定某些插件的输入输出时&lt;code>server&lt;/code>的连接信息&lt;/li>
&lt;li>&lt;code>storage&lt;/code>: 指定如何保存插件本身的状态&lt;/li>
&lt;/ul>
&lt;p>每个模块都有对应的插件，使用详情可以查看官方文档&lt;/p>
&lt;h3 id="检查配置文件的格式">检查配置文件的格式&lt;/h3>
&lt;p>可以使用下面的命令检查配置文件的格式是否正确&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker run --rm -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>/etc:/fluentd/etc/ fluent/fluentd:v1.7-1 --dry-run -c /fluentd/etc/fluentd_basic_setup.conf
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="使用fluentd收集docker容器的日志">使用Fluentd收集docker容器的日志&lt;/h2>
&lt;h3 id="docker容器日志格式">docker容器日志格式&lt;/h3>
&lt;p>在使用fluentd收集docker日志时，默认会将日志分成4个部分:&lt;/p>
&lt;p>分别是:&lt;/p>
&lt;ul>
&lt;li>&lt;code>container_id&lt;/code>: 容器的ID&lt;/li>
&lt;li>&lt;code>container_name&lt;/code>:容器的名字&lt;/li>
&lt;li>&lt;code>source&lt;/code>: 日志的类型，&lt;code>stdout&lt;/code>或&lt;code>stderr&lt;/code>&lt;/li>
&lt;li>&lt;code>log&lt;/code>: 日志本身&lt;/li>
&lt;/ul>
&lt;h3 id="收集docker容器的日志示例">收集Docker容器的日志示例&lt;/h3>
&lt;ol>
&lt;li>首先创建一个配置文件&lt;code>etc/fluentd_docker.conf&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type forward
port &lt;span class="m">24224&lt;/span>
&lt;span class="nb">bind&lt;/span> 0.0.0.0
&amp;lt;/source&amp;gt;
&amp;lt;match **&amp;gt;
@type stdout
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 启动一个fluentd服务&lt;/span>
$ docker run -it -p 24224:24224 -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>/etc:/fluentd/etc/ -e &lt;span class="nv">FLUENTD_CONF&lt;/span>&lt;span class="o">=&lt;/span>fluentd_docker.conf fluent/fluentd:v1.7-1
&lt;span class="c1"># 启动一个docker容器并使用fluentd收集日志&lt;/span>
$ docker run --log-driver&lt;span class="o">=&lt;/span>fluentd -p 5000:80 httpd
&lt;span class="c1"># 访问服务产生日志&lt;/span>
$ curl http://127.0.0.1:5000
&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&amp;lt;h1&amp;gt;It works!&amp;lt;/h1&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在fluentd的容器日志里，能看到下面的输出&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">2019-11-28 01:43:23.000000000 +0000 8da5b8365552: {&amp;#34;container_id&amp;#34;:&amp;#34;8da5b8365552b4c0c610ff5df3dc28509bfc5781ec580628143b00cf997d5b72&amp;#34;,&amp;#34;container_name&amp;#34;:&amp;#34;/confident_curie&amp;#34;,&amp;#34;source&amp;#34;:&amp;#34;stdout&amp;#34;,&amp;#34;log&amp;#34;:&amp;#34;172.17.0.1 - - [28/Nov/2019:01:43:23 +0000] \&amp;#34;GET / HTTP/1.1\&amp;#34; 200 45&amp;#34;}
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="在docker-compose中使用示例">在docker-compose中使用示例&lt;/h3>
&lt;p>为了介绍下对日志常用的处理场景，这里将收集的日志分成三部分:&lt;/p>
&lt;ul>
&lt;li>输出到fluentd的容器的标准输出，方便直接查看&lt;/li>
&lt;li>保存一份到文件，按照日期自动切割日志&lt;/li>
&lt;li>保存一份到Elasticsearch，方便通过Kibana面板直接查看&lt;/li>
&lt;/ul>
&lt;p>同时为了方便人查看，输出到fluentd标准输出和保存到日志文件的，只显示log字段的信息(不用&lt;code>contanier_id&lt;/code>, &lt;code>container_name&lt;/code>等暂时不关心的信息)，保存到Elastisearch的日志保存完整的结构。&lt;/p>
&lt;p>首先，根据我们上面的需求，创建fluentd配置文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat etc/fluentd_docker_compose.conf
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;span class="lnt">85
&lt;/span>&lt;span class="lnt">86
&lt;/span>&lt;span class="lnt">87
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;source&amp;gt;
@type forward
port &lt;span class="m">24224&lt;/span>
&lt;span class="nb">bind&lt;/span> 0.0.0.0
&amp;lt;/source&amp;gt;
&lt;span class="c1"># docker相关的日志处理&lt;/span>
&amp;lt;match docker.**&amp;gt;
&lt;span class="c1"># docker相关的日志输出三份，一份输出到fluentd容器的标准输出，便于实时查看，另一份保存到文件, 还有一份保存到Elasticsearch&lt;/span>
@type copy
&lt;span class="c1"># 输出到标准输出&lt;/span>
&amp;lt;store&amp;gt;
@type stdout
&lt;span class="c1"># 默认输出的格式是json格式，由于docker生成的日志，包含了容器信息等其他信息，不是很方便人去阅读。&lt;/span>
&lt;span class="c1"># 这里只输出我们关心的log字段&lt;/span>
&lt;span class="c1"># 使用stdout作为主format，single_value为子format，这样可以在输出log的同时保留直接tag和time信息&lt;/span>
&amp;lt;format&amp;gt;
@type stdout
output_type single_value
message_key log
add_newline &lt;span class="nb">true&lt;/span>
&amp;lt;/format&amp;gt;
&amp;lt;/store&amp;gt;
&lt;span class="c1"># 输出到文件&lt;/span>
&amp;lt;store&amp;gt;
@type file
&lt;span class="c1"># 使用tag和日期作为保存日志的文件名&lt;/span>
path /fluentd/log/&lt;span class="si">${&lt;/span>&lt;span class="nv">tag&lt;/span>&lt;span class="si">}&lt;/span>/%Y%m%d
&lt;span class="c1"># 合并多个flush chunk块到一个文件&lt;/span>
append &lt;span class="nb">true&lt;/span>
&lt;span class="c1"># 使用gzip压缩生成的日志文件&lt;/span>
compress gzip
&amp;lt;format&amp;gt;
@type stdout
output_type single_value
message_key log
add_newline &lt;span class="nb">true&lt;/span>
&amp;lt;/format&amp;gt;
&lt;span class="c1"># 使用文件作为缓冲区&lt;/span>
&amp;lt;buffer tag, time&amp;gt;
@type file
chunk_limit_size 1M
&lt;span class="c1"># 每隔1分钟写一次日志&lt;/span>
flush_interval 1m
flush_at_shutdown &lt;span class="nb">true&lt;/span>
flush_mode interval
&amp;lt;/buffer&amp;gt;
&amp;lt;/store&amp;gt;
&lt;span class="c1"># 输出到Eleastichsearch&lt;/span>
&amp;lt;store&amp;gt;
@type elasticsearch
host elasticsearch
port &lt;span class="m">9200&lt;/span>
logstash_format &lt;span class="nb">true&lt;/span>
logstash_prefix fluentd
logstash_dateformat %Y%m%d
include_tag_key &lt;span class="nb">true&lt;/span>
type_name access_log
tag_key @log_name
&amp;lt;/store&amp;gt;
&amp;lt;/match&amp;gt;
&lt;span class="c1"># 其它日志处理&lt;/span>
&amp;lt;match **&amp;gt;
@type copy
&amp;lt;store&amp;gt;
@type stdout
&amp;lt;/store&amp;gt;
&lt;span class="c1"># 输出到others目录&lt;/span>
&amp;lt;store&amp;gt;
@type file
path /fluentd/log/others/&lt;span class="si">${&lt;/span>&lt;span class="nv">tag&lt;/span>&lt;span class="si">}&lt;/span>/%Y%m%d
append &lt;span class="nb">true&lt;/span>
&amp;lt;buffer tag, time&amp;gt;
@type file
chunk_limit_size 1M
flush_interval 1m
flush_at_shutdown &lt;span class="nb">true&lt;/span>
flush_mode interval
&amp;lt;/buffer&amp;gt;
&amp;lt;/store&amp;gt;
&amp;lt;/match&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>由于使用到了elasticsearch输出插件，而默认的fluentd中并没有安装这个插件，因此，我们需要自己定义&lt;code>Dockfile&lt;/code>来安装elasticsearch插件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">$ cat fluentd/Dockerfile
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span class="err">
&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="s"> fluent/fluentd:v1.7-1&lt;/span>&lt;span class="err">
&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="k">USER&lt;/span>&lt;span class="s"> root&lt;/span>&lt;span class="err">
&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="k">RUN&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s2">&amp;#34;fluent-gem&amp;#34;&lt;/span>, &lt;span class="s2">&amp;#34;install&amp;#34;&lt;/span>, &lt;span class="s2">&amp;#34;fluent-plugin-elasticsearch&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="k">USER&lt;/span>&lt;span class="s"> fluent&lt;/span>&lt;span class="err">
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>最后创建&lt;code>docker-compose.yaml&lt;/code>文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat docker-compose.yaml
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;3&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">httpd&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpd&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;5000:80&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">webnet&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">depends_on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">fluentd&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">logging&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">driver&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">fluentd&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">options&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">fluentd-address&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;localhost:24224&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">fluentd-retry-wait&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;1s&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">fluentd-max-retries&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;10&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">docker.httpd&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">fluentd&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">build&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">./fluentd/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./etc/:/fluentd/etc&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./log/:/fluentd/log&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;24224:24224&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;24224:24224/udp&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">FLUENTD_CONF=fluentd_docker_compose.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">webnet&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">depends_on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">elasticsearch&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">kibana&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">elasticsearch&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">docker.elastic.co/elasticsearch/elasticsearch-oss:6.2.3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;9200:9200&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">webnet&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;9200:9200&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;9300:9300&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">discovery.type=single-node&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">cluster.name=docker-cluster&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">bootstrap.memory_lock=true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">http.host=0.0.0.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">transport.host=127.0.0.1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;ES_JAVA_OPTS=-Xms512m -Xmx512m&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ulimits&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">memlock&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">soft&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>-&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hard&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>-&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">es_data:/usr/share/elasticsearch/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">kibana&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">docker.elastic.co/kibana/kibana-oss:6.2.3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">SERVER_NAME&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kibana-server&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ELASTICSEARCH_URL&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">http://elasticsearch:9200&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;5601:5601&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">depends_on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">elasticsearch&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">webnet&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">webnet&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">es_data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">driver&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">local&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>最后启动服务&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker-compose up --build
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>实际使用中发现，采用上面的方式启动服务后，有时间fluentd没法收集到httpd服务的日志，最后发现原因是如果在fluentd服务还没准备就绪的情况下就启动httpd服务，就会产生这种现象。因此，建议的做法是先启动fluentd, 再启动httpd&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker-compose up --build fluentd
&lt;span class="c1"># 等fluentd服务就绪后，再启动httpd服务&lt;/span>
$ docker-compose up httpd
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>当然更优雅点的做法是控制docker-compose中服务的启动顺序，具体可以参考:&lt;/p>
&lt;p>&lt;a href="https://docs.docker.com/compose/startup-order/">https://docs.docker.com/compose/startup-order/&lt;/a>&lt;/p>
&lt;p>测试，访问 httpd服务&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 可以多执行几次，产生多一些访问记录&lt;/span>
$ curl http://127.0.0.1/5000
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>最后可以分别在fluentd的容器的终端，log目录，以及elasticsearch中看到保存的访问记录信息了。如下是通过Kibana面板看到的请求情况&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/1575000628.png" alt="Kibana面板">&lt;/p>
&lt;h2 id="更多">更多&lt;/h2>
&lt;p>更多关于Fluentd的使用方式可以参考官方文档&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.fluentd.org/how-to-guides">各种使用fluentd收集日志的场景&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Java实用第三方库之Lombok使用入门</title><link>https://crazygit.wiseturtles.com/2019/09/18/java-libraries-lombok/</link><pubDate>Wed, 18 Sep 2019 10:44:29 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2019/09/18/java-libraries-lombok/</guid><description>&lt;p>平时定义类时，难免会写很多&lt;code>Getter&lt;/code>, &lt;code>Setter&lt;/code>，&lt;code>toString&lt;/code>, &lt;code>Constructor &lt;/code>等方法。虽然可以用IDE自带的代码生成，但是生成的代码仍然很多，看起来特别臃肿。有了&lt;a href="https://projectlombok.org">&lt;code>Lombok&lt;/code>&lt;/a>这个库，用一个注解就能自动搞定这个问题。&lt;/p>
&lt;h3 id="使用效果">使用效果&lt;/h3>
&lt;p>没有对比就没有伤害。通过定义一个类，让我们来感受下&lt;code>Lombok&lt;/code>的带来的便利。&lt;/p>
&lt;p>不使用&lt;code>Lombok&lt;/code>定义一个类&lt;code>PersonWithoutLombok.java&lt;/code>, 虽然大部分代码都是IDE自动生成的，但是看起来仍然特别臃肿。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">PersonWithoutLombok&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="nd">@Override&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">toString&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;PersonWithoutLombok{&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span>
&lt;span class="s">&amp;#34;name=&amp;#39;&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">name&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="sc">&amp;#39;\&amp;#39;&amp;#39;&lt;/span> &lt;span class="o">+&lt;/span>
&lt;span class="s">&amp;#34;, age=&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">age&lt;/span> &lt;span class="o">+&lt;/span>
&lt;span class="sc">&amp;#39;}&amp;#39;&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="nd">@Override&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">hashCode&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kd">super&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">hashCode&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="nd">@Override&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">boolean&lt;/span> &lt;span class="nf">equals&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">Object&lt;/span> &lt;span class="n">obj&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kd">super&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">equals&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">obj&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">getName&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">setName&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">getAge&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">setAge&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">age&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="nf">PersonWithoutLombok&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用&lt;code>Lombok&lt;/code>之后，让我们来看看&lt;code>PersonWithLombok.java&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.Data&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="nd">@Data&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">PersonWithLombok&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>看看类结构&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/1568769332.png" alt="看看类结构">&lt;/p>
&lt;p>一样的效果，使用&lt;code>Lombok&lt;/code>之后，整个代码看起来是不是更加清爽了呢?&lt;/p>
&lt;p>除了&lt;code>Data&lt;/code>之外。&lt;code>Lombok&lt;/code>还提供了很多其它很多实用的注解，可以参考&lt;a href="https://projectlombok.org/features/all">官方文档&lt;/a>，每个注解的使用都配有使用示例，以及不使用注解的情况下，原始的Java代码该如何写，一对比非常容易理解。&lt;/p>
&lt;h3 id="安装配置">安装配置&lt;/h3>
&lt;p>&lt;code>Lombok&lt;/code>的使用也非常方便，可以直接在&lt;code>命令行&lt;/code>，&lt;code>Eclipse&lt;/code>, &lt;code>IntelliJ&lt;/code>中使用。也方便和&lt;code>Maven&lt;/code>, &lt;code>Gradle&lt;/code>集成，&lt;code>Android&lt;/code>开发中同样适用。具体支持如下：&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/1568769867.png" alt="Setup">&lt;/p>
&lt;p>下面主要介绍下在命令行中和&lt;code>IntelliJ&lt;/code>中的使用方式，其它的可以直接参考&lt;a href="https://projectlombok.org/">官方文档&lt;/a>，都有非常详细的介绍&lt;/p>
&lt;h4 id="命令行中使用">命令行中使用&lt;/h4>
&lt;ol>
&lt;li>
&lt;p>下载最新版本的&lt;a href="https://projectlombok.org/downloads/lombok.jar">lombock.jar&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>创建&lt;code>PersonWithLombok.java&lt;/code>类文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat PersonWithLombok.java
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.Data&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="nd">@Data&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">PersonWithLombok&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>编译&lt;code>PersonWithLombok.java&lt;/code>类文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ javac -cp /path/to/lombok.jar PersonWithLombok.java
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>查看生成的&lt;code>class&lt;/code>文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ javap PersonWithLombok.class
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="n">Compiled&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="s">&amp;#34;PersonWithLombok.java&amp;#34;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">PersonWithLombok&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="nf">PersonWithLombok&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">lang&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">String&lt;/span> &lt;span class="nf">getName&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">getAge&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">setName&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">lang&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">String&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">setAge&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">boolean&lt;/span> &lt;span class="nf">equals&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">lang&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">Object&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="kd">protected&lt;/span> &lt;span class="kt">boolean&lt;/span> &lt;span class="nf">canEqual&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">lang&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">Object&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">hashCode&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">lang&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">String&lt;/span> &lt;span class="nf">toString&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看到自动生成了相关代码&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="intellij中使用httpsgithubcommplushnikovlombok-intellij-plugin">&lt;a href="https://github.com/mplushnikov/lombok-intellij-plugin">IntelliJ中使用&lt;/a>&lt;/h4>
&lt;ol>
&lt;li>
&lt;p>安装插件&lt;/p>
&lt;p>&lt;code>Preferences&lt;/code> &amp;gt; &lt;code>Settings&lt;/code> &amp;gt; &lt;code>Plugins&lt;/code> &amp;gt; &lt;code>Browse repositories...&lt;/code> &amp;gt; &lt;code>Search for &amp;quot;lombok&amp;quot;&lt;/code> &amp;gt; &lt;code>Install Plugin&lt;/code>&lt;/p>
&lt;p>然后重启IDE&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/1568770578.png" alt="安装插件">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>配置IDE的编译器，开启&lt;/p>
&lt;p>&lt;code>Preferences&lt;/code> -&amp;gt; &lt;code>Build, Execution, Deployment&lt;/code> -&amp;gt; &lt;code>Compiler, Annotation Processors&lt;/code>. 点击&lt;code>Enable Annotation Processing&lt;/code>，并勾选&lt;code>Obtain processors from project classpath&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/1568770670.png" alt="配置IDE，启用Annotation Processing">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>添加&lt;code>Lombok&lt;/code>到项目依赖。这里根据使用的构建工具不同，操作也不同。&lt;/p>
&lt;ul>
&lt;li>
&lt;p>如果使用的是&lt;code>Gradle&lt;/code>, 在&lt;code>build.gradle&lt;/code>中添加如下内容&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="c1">// &amp;#39;compile&amp;#39; can be changed to &amp;#39;compileOnly&amp;#39; for Gradle 2.12+
&lt;/span>&lt;span class="c1">// or &amp;#39;provided&amp;#39; if using &amp;#39;propdeps&amp;#39; plugin from SpringSource
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="n">compile&lt;/span> &lt;span class="s2">&amp;#34;org.projectlombok:lombok:1.18.8&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>如果使用的是&lt;code>Maven&lt;/code>，直接在&lt;code>pom.xml&lt;/code>中添加如下内容&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="nt">&amp;lt;dependencies&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;dependency&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;groupId&amp;gt;&lt;/span>org.projectlombok&lt;span class="nt">&amp;lt;/groupId&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;artifactId&amp;gt;&lt;/span>lombok&lt;span class="nt">&amp;lt;/artifactId&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;version&amp;gt;&lt;/span>1.18.8&lt;span class="nt">&amp;lt;/version&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;scope&amp;gt;&lt;/span>provided&lt;span class="nt">&amp;lt;/scope&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;/dependency&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;/dependencies&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>如果使用的是&lt;code>Ivy&lt;/code>, 在&lt;code>ivy.xml&lt;/code>中添加如下内容&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="nt">&amp;lt;dependency&lt;/span> &lt;span class="na">org=&lt;/span>&lt;span class="s">&amp;#34;org.projectlombok&amp;#34;&lt;/span> &lt;span class="na">name=&lt;/span>&lt;span class="s">&amp;#34;lombok&amp;#34;&lt;/span> &lt;span class="na">rev=&lt;/span>&lt;span class="s">&amp;#34;1.18.8&amp;#34;&lt;/span> &lt;span class="na">conf=&lt;/span>&lt;span class="s">&amp;#34;build&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>如果没有使用任何构建工具，那需要手动下载&lt;a href="https://projectlombok.org/downloads/lombok.jar">lombock.jar&lt;/a>, 然后在&lt;code>项目结构&lt;/code>中，把下载的&lt;code>lombok.jar&lt;/code>添加到项目依赖的&lt;code>Libraries&lt;/code>中&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/1568771143.png" alt="添加lombok.jar到项目的classpath中">&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>创建一个类&lt;code>PersonWithLombok.java&lt;/code>，测试效果,如下图，从类结构中可以看到，IDE已经自动识别出使用&lt;code>Lombok&lt;/code>后生成的代码&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/1568771270.png" alt="效果图">&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="常用注解介绍">常用注解介绍&lt;/h3>
&lt;h4 id="val">&lt;code>val&lt;/code>&lt;/h4>
&lt;p>作用在局部变量，用于定义一个局部变量，并将它声明为&lt;code>final&lt;/code>, 不用声明变量类型，它会根据初始赋值自动推动变量类型。&lt;strong>只能用于局部变量或loop循环中，不能用于类的属性&lt;/strong>。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">java.util.ArrayList&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">java.util.HashMap&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.val&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">ValExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">example&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">val&lt;/span> &lt;span class="n">example&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ArrayList&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;();&lt;/span>
&lt;span class="n">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">add&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Hello, World!&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="n">val&lt;/span> &lt;span class="n">foo&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">get&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">0&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">foo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">toLowerCase&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">example2&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">val&lt;/span> &lt;span class="n">map&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">HashMap&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">Integer&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;();&lt;/span>
&lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">put&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">0&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;zero&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">put&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">5&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;five&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">val&lt;/span> &lt;span class="n">entry&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">entrySet&lt;/span>&lt;span class="o">())&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">System&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">out&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">printf&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;%d: %s\n&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getKey&lt;/span>&lt;span class="o">(),&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getValue&lt;/span>&lt;span class="o">());&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>等效于&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">java.util.ArrayList&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">java.util.HashMap&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">java.util.Map&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">ValExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">example&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">final&lt;/span> &lt;span class="n">ArrayList&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">example&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ArrayList&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;();&lt;/span>
&lt;span class="n">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">add&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Hello, World!&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="kd">final&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">foo&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">get&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">0&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">foo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">toLowerCase&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">example2&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">final&lt;/span> &lt;span class="n">HashMap&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">Integer&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">map&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">HashMap&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">Integer&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;();&lt;/span>
&lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">put&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">0&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;zero&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">put&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">5&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s">&amp;#34;five&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="kd">final&lt;/span> &lt;span class="n">Map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">Entry&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">Integer&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">entry&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">entrySet&lt;/span>&lt;span class="o">())&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">System&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">out&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">printf&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;%d: %s\n&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getKey&lt;/span>&lt;span class="o">(),&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getValue&lt;/span>&lt;span class="o">());&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="var">&lt;code>var&lt;/code>&lt;/h4>
&lt;p>与&lt;code>val&lt;/code>功能类似，除了变量不会标记为&lt;code>final&lt;/code>&lt;/p>
&lt;h4 id="nonnull">&lt;code>@NonNull&lt;/code>&lt;/h4>
&lt;p>非空检查&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.NonNull&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">NonNullExample&lt;/span> &lt;span class="kd">extends&lt;/span> &lt;span class="n">Something&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="nf">NonNullExample&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nd">@NonNull&lt;/span> &lt;span class="n">Person&lt;/span> &lt;span class="n">person&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">super&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Hello&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">person&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getName&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>等效于&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">
&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.NonNull&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">NonNullExample&lt;/span> &lt;span class="kd">extends&lt;/span> &lt;span class="n">Something&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="nf">NonNullExample&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nd">@NonNull&lt;/span> &lt;span class="n">Person&lt;/span> &lt;span class="n">person&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">super&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Hello&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">person&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">throw&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">NullPointerException&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;person is marked @NonNull but is null&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">person&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getName&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="cleanup">&lt;code>@Cleanup&lt;/code>&lt;/h4>
&lt;p>资源管理，自动调用&lt;code>close()&lt;/code>方法&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.Cleanup&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">java.io.*&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">CleanupExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">[]&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="kd">throws&lt;/span> &lt;span class="n">IOException&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="nd">@Cleanup&lt;/span> &lt;span class="n">InputStream&lt;/span> &lt;span class="n">in&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">FileInputStream&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">0&lt;/span>&lt;span class="o">]);&lt;/span>
&lt;span class="nd">@Cleanup&lt;/span> &lt;span class="n">OutputStream&lt;/span> &lt;span class="n">out&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">FileOutputStream&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">1&lt;/span>&lt;span class="o">]);&lt;/span>
&lt;span class="kt">byte&lt;/span>&lt;span class="o">[]&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="kt">byte&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">10000&lt;/span>&lt;span class="o">];&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kt">int&lt;/span> &lt;span class="n">r&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">in&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">read&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">r&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">1&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="k">break&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="n">out&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">write&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">0&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">r&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>等价于&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">java.io.*&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">CleanupExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">[]&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="kd">throws&lt;/span> &lt;span class="n">IOException&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">InputStream&lt;/span> &lt;span class="n">in&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">FileInputStream&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">0&lt;/span>&lt;span class="o">]);&lt;/span>
&lt;span class="k">try&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">OutputStream&lt;/span> &lt;span class="n">out&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">FileOutputStream&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">1&lt;/span>&lt;span class="o">]);&lt;/span>
&lt;span class="k">try&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kt">byte&lt;/span>&lt;span class="o">[]&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="kt">byte&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">10000&lt;/span>&lt;span class="o">];&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kt">int&lt;/span> &lt;span class="n">r&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">in&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">read&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">r&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">1&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="k">break&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="n">out&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">write&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">0&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">r&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span> &lt;span class="k">finally&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">out&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">out&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">close&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span> &lt;span class="k">finally&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="n">in&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">in&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">close&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="getter-setter">&lt;code>@Getter @Setter&lt;/code>&lt;/h4>
&lt;p>自动生成&lt;code>Getter&lt;/code>和&lt;code>Setter&lt;/code>代码&lt;/p>
&lt;ul>
&lt;li>
&lt;p>默认情况下，生成的getter/setter方法被标记为&lt;code>public&lt;/code>,除非指定了&lt;code>AccessLevel&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>同样可以加&lt;code>@Getter&lt;/code>和&lt;code>@Setter&lt;/code>注解作用到类上， 那样类中所有的非静态属性都会自动生成getter/setter代码&lt;/p>
&lt;/li>
&lt;li>
&lt;p>如果不想给某个属性自动生成getter/setter代码，可以标记类属性为&lt;code>AccessLevel.NONE&lt;/code>。这样可以覆盖给类添加&lt;code>@Getter&lt;/code>, &lt;code>@Setter&lt;/code> &lt;code>@Data&lt;/code>产生的行为。&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.AccessLevel&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.Getter&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.Setter&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">GetterSetterExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="cm">/**
&lt;/span>&lt;span class="cm"> * Age of the person. Water is wet.
&lt;/span>&lt;span class="cm"> *
&lt;/span>&lt;span class="cm"> * @param age New value for this person&amp;#39;s age. Sky is blue.
&lt;/span>&lt;span class="cm"> * @return The current value of this person&amp;#39;s age. Circles are round.
&lt;/span>&lt;span class="cm"> */&lt;/span>
&lt;span class="nd">@Getter&lt;/span> &lt;span class="nd">@Setter&lt;/span> &lt;span class="kd">private&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">age&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">10&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="cm">/**
&lt;/span>&lt;span class="cm"> * Name of the person.
&lt;/span>&lt;span class="cm"> * -- SETTER --
&lt;/span>&lt;span class="cm"> * Changes the name of this person.
&lt;/span>&lt;span class="cm"> *
&lt;/span>&lt;span class="cm"> * @param name The new value.
&lt;/span>&lt;span class="cm"> */&lt;/span>
&lt;span class="nd">@Setter&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">AccessLevel&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">PROTECTED&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="nd">@Override&lt;/span> &lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">toString&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">format&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;%s (age: %d)&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>等价于&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">GetterSetterExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="cm">/**
&lt;/span>&lt;span class="cm"> * Age of the person. Water is wet.
&lt;/span>&lt;span class="cm"> */&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">age&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">10&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="cm">/**
&lt;/span>&lt;span class="cm"> * Name of the person.
&lt;/span>&lt;span class="cm"> */&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="nd">@Override&lt;/span> &lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">toString&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">format&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;%s (age: %d)&amp;#34;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="cm">/**
&lt;/span>&lt;span class="cm"> * Age of the person. Water is wet.
&lt;/span>&lt;span class="cm"> *
&lt;/span>&lt;span class="cm"> * @return The current value of this person&amp;#39;s age. Circles are round.
&lt;/span>&lt;span class="cm"> */&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">getAge&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="cm">/**
&lt;/span>&lt;span class="cm"> * Age of the person. Water is wet.
&lt;/span>&lt;span class="cm"> *
&lt;/span>&lt;span class="cm"> * @param age New value for this person&amp;#39;s age. Sky is blue.
&lt;/span>&lt;span class="cm"> */&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">setAge&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">age&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="cm">/**
&lt;/span>&lt;span class="cm"> * Changes the name of this person.
&lt;/span>&lt;span class="cm"> *
&lt;/span>&lt;span class="cm"> * @param name The new value.
&lt;/span>&lt;span class="cm"> */&lt;/span>
&lt;span class="kd">protected&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">setName&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="tostring">&lt;code>@ToString&lt;/code>&lt;/h4>
&lt;p>自动添加&lt;code>toSting()&lt;/code>方法，默认使用类名 + 所有的非静态属性值。&lt;/p>
&lt;p>可以通过&lt;code>@ToString.Exclude&lt;/code>来排除一些不想添加到toString()中的属性&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.ToString&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="nd">@ToString&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">ToStringExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">STATIC_VAR&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">10&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">Shape&lt;/span> &lt;span class="n">shape&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Square&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">5&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">10&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">[]&lt;/span> &lt;span class="n">tags&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="nd">@ToString.Exclude&lt;/span> &lt;span class="kd">private&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">id&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">getName&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="nd">@ToString&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">callSuper&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">includeFieldNames&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="o">)&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">Square&lt;/span> &lt;span class="kd">extends&lt;/span> &lt;span class="n">Shape&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="nf">Square&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">width&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">height&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>等价于&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">java.util.Arrays&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">ToStringExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">STATIC_VAR&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">10&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">Shape&lt;/span> &lt;span class="n">shape&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Square&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">5&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">10&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="n">String&lt;/span>&lt;span class="o">[]&lt;/span> &lt;span class="n">tags&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">id&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">getName&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getName&lt;/span>&lt;span class="o">();&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">Square&lt;/span> &lt;span class="kd">extends&lt;/span> &lt;span class="n">Shape&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="nf">Square&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">width&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">height&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="nd">@Override&lt;/span> &lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">toString&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;Square(super=&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="kd">super&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">toString&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;, width=&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">width&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;, height=&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">height&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;)&amp;#34;&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="nd">@Override&lt;/span> &lt;span class="kd">public&lt;/span> &lt;span class="n">String&lt;/span> &lt;span class="nf">toString&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;ToStringExample(&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getName&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;, &amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">shape&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;, &amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">Arrays&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">deepToString&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="k">this&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">tags&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;)&amp;#34;&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="data">&lt;code>@Data&lt;/code>&lt;/h4>
&lt;p>相当于&lt;code>@ToString&lt;/code>, &lt;code>@EqualsAndHashCode&lt;/code>, &lt;code>@Getter&lt;/code>,&lt;code>@Setter&lt;/code>,&lt;code>@RequiredArgsConstructor&lt;/code>的组合&lt;/p>
&lt;h4 id="log">&lt;code>@Log&lt;/code>&lt;/h4>
&lt;p>自动为类添加&lt;code>log&lt;/code>属性，方便直接使用log&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.extern.java.Log&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">lombok.extern.slf4j.Slf4j&lt;/span>&lt;span class="o">;&lt;/span>
&lt;span class="nd">@Log&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">LogExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">severe&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Something&amp;#39;s wrong here&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="nd">@Slf4j&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">LogExampleOther&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">error&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Something else is wrong here&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="nd">@CommonsLog&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">topic&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;CounterLog&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">LogExampleCategory&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">error&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Calling the &amp;#39;CounterLog&amp;#39; with a message&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>等价于&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">LogExample&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">util&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">Logger&lt;/span> &lt;span class="n">log&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">util&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">Logger&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getLogger&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">LogExample&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">class&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getName&lt;/span>&lt;span class="o">());&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">severe&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Something&amp;#39;s wrong here&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">LogExampleOther&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="n">org&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">slf4j&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">Logger&lt;/span> &lt;span class="n">log&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">org&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">slf4j&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">LoggerFactory&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getLogger&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">LogExampleOther&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">class&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">error&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Something else is wrong here&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">class&lt;/span> &lt;span class="nc">LogExampleCategory&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="kd">private&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kd">final&lt;/span> &lt;span class="n">org&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">apache&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">commons&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">Log&lt;/span> &lt;span class="n">log&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">org&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">apache&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">commons&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">LogFactory&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getLog&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;CounterLog&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">error&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#34;Calling the &amp;#39;CounterLog&amp;#39; with a message&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>下面注解的使用，可以&lt;a href="https://projectlombok.org/features/all">参考官方文档&lt;/a>&lt;/p>
&lt;h4 id="value">&lt;code>@Value&lt;/code>&lt;/h4>
&lt;h4 id="builder">&lt;code>@Builder&lt;/code>&lt;/h4>
&lt;h4 id="synchronized">&lt;code>@Synchronized&lt;/code>&lt;/h4>
&lt;h4 id="sneakythrows">&lt;code>@SneakyThrows&lt;/code>&lt;/h4>
&lt;h4 id="with">&lt;code>@With&lt;/code>&lt;/h4>
&lt;h4 id="equalsandhashcode">&lt;code>@EqualsAndHashCode&lt;/code>&lt;/h4>
&lt;h4 id="noargsconstructor-requiredargsconstructor-allargsconstructor">&lt;code>@NoArgsConstructor @RequiredArgsConstructor @AllArgsConstructor&lt;/code>&lt;/h4>
&lt;h4 id="getterlazytrue">&lt;code>@Getter(lazy=true)&lt;/code>&lt;/h4>
&lt;p>赶紧拿起你的电脑试试吧！&lt;/p></description></item><item><title>流程控制和函数</title><link>https://crazygit.wiseturtles.com/2019/01/07/control-flow-and-functions/</link><pubDate>Mon, 07 Jan 2019 15:19:54 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2019/01/07/control-flow-and-functions/</guid><description>&lt;h2 id="流程控制">流程控制&lt;/h2>
&lt;p>流程控制的关键字&lt;/p>
&lt;ul>
&lt;li>&lt;code>while&lt;/code>&lt;/li>
&lt;li>&lt;code>if&lt;/code>&lt;/li>
&lt;li>&lt;code>guard&lt;/code>&lt;/li>
&lt;li>&lt;code>switch&lt;/code>&lt;/li>
&lt;li>&lt;code>for-in&lt;/code>&lt;/li>
&lt;li>&lt;code>continue&lt;/code>&lt;/li>
&lt;li>&lt;code>break&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="for-in">For-In&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">minutes&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">60&lt;/span>
&lt;span class="c1">// 半开区间&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">tickMark&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mf">0.&lt;/span>&lt;span class="p">.&amp;lt;&lt;/span>&lt;span class="n">minutes&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tickMark&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 打印从0到59&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用&lt;code>stride(from:to:by)&lt;/code>实现设置步长的效果，半开区间&lt;/p>
&lt;p>使用&lt;code>stride(from:through:by)&lt;/code>实现设置步长的效果，全闭区别&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">minutesInterval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">5&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">tickMark&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="bp">stride&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">from&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">to&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">minutes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">by&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">minutesInterval&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tickMark&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//打印0,5,10...55&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">tickMark&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="bp">stride&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">from&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">through&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">minutes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">by&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">minutesInterval&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tickMark&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//打印0,5,10...55,60&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="while">While&lt;/h3>
&lt;p>white循环有两种形式&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 可能不会执行循环&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="n">condition&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">statements&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// 至少执行一次循环&lt;/span>
&lt;span class="k">repeat&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">statements&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="n">condition&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="switch">switch&lt;/h3>
&lt;p>switch语法如下图所示:&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-12-26-swift-switch-syntax.png" alt="swich synatx">&lt;/p>
&lt;p>&lt;code>switch&lt;/code>中条件的判断必须是详细的，必须考虑到每一种可能存在的情况，不然&lt;code>default&lt;/code>语句是不能省略的。如下面的语句加入去掉&lt;code>default&lt;/code>语句，在运行的时候会报错。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="k">switch&lt;/span> &lt;span class="n">someCharacter&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;The first letter of the alphabet&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;z&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;The last letter of the alphabet&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">//default:&lt;/span>
&lt;span class="c1">// print(&amp;#34;Some other charater&amp;#34;)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>默认情况下, &lt;code>swicth&lt;/code>语句的&lt;code>case&lt;/code>部分不再需要明确指定&lt;code>break&lt;/code>, 当多个case语句需要同样的逻辑时，可以使用逗号将&lt;code>case&lt;/code>语句区分&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">caseInSensitiveCharacter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;a&amp;#34;&lt;/span>
&lt;span class="k">switch&lt;/span> &lt;span class="n">caseInSensitiveCharacter&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;A&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;The first letter of alphabet&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// break&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;z&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Z&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;The last letter of the alphabet&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// break&lt;/span>
&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Some other charater&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>case&lt;/code>语句同样可以检查是否满足一个区间的匹配&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">approximateCount&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">62&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">countedThings&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;moons orbiting Saturn&amp;#34;&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">naturalCount&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span>
&lt;span class="k">switch&lt;/span> &lt;span class="n">approximateCount&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">naturalCount&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;no&amp;#34;&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="mf">1.&lt;/span>&lt;span class="p">.&amp;lt;&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">naturalCount&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;a few&amp;#34;&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="mf">5.&lt;/span>&lt;span class="p">.&amp;lt;&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">naturalCount&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;several&amp;#34;&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="mf">12.&lt;/span>&lt;span class="p">.&amp;lt;&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">naturalCount&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;dozens of&amp;#34;&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="mf">100.&lt;/span>&lt;span class="p">.&amp;lt;&lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">naturalCount&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;hundreds of&amp;#34;&lt;/span>
&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">naturalCount&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;many&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;There are &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">naturalCount&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">countedThings&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用元组，可以在&lt;code>switch&lt;/code>语句的&lt;code>case&lt;/code>条件中同时比较多个值，下划线&lt;code>_&lt;/code>表示匹配任意值&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">somePoint&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">switch&lt;/span> &lt;span class="n">somePoint&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">somePoint&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> is at the origin&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">somePoint&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> is on the x-axis&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">_&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">somePoint&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> is on the y-axis&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">2.&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">somePoint&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> is inside the box&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">somePoint&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> is outside the box&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>当条件匹配多个case语句时，只有第一个匹配的case语句会被执行，上面的例子中, &lt;code>(0, 0)&lt;/code>是满足每个条件的，但是只有第一个case语句会执行，后面的都直接被忽略了。&lt;/p>
&lt;p>&lt;code>switch&lt;/code>语句可以将匹配的&lt;code>case&lt;/code>语句赋值到一个临时变量，方便在&lt;code>case&lt;/code>语句的代码部分使用.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">anotherPoint&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">switch&lt;/span> &lt;span class="n">anotherPoint&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">let&lt;/span> &lt;span class="nv">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;on the x-axis with an x value &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">y&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;on the y-axis with an y value &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;somewhere else at (&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">, &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">)&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>switch&lt;/code>语句还可以拥有&lt;code>where&lt;/code>语句检查额外的条件。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">yetAnotherPoint&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">switch&lt;/span> &lt;span class="n">yetAnotherPoint&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="kd">let&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">where&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;(&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">, &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">) is on the line x=y&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="kd">let&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">where&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;(&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">, &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">) is on the line x=-y&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="kd">let&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;(&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">, &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">) is just some arbitray&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>switch语句中，每个满足条件的case语句执行后，就结束了，不像有些语言必须在每个case后面跟上break语句，否则接下来的case语句同样会执行，如果想在switch中实现这种效果，可以使用fallthrough&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">integerToDescribe&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">5&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">description&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;The number &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">integerToDescribe&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> is&amp;#34;&lt;/span>
&lt;span class="k">switch&lt;/span> &lt;span class="n">integerToDescribe&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">17&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">19&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">description&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="s">&amp;#34; a prime number, and also&amp;#34;&lt;/span>
&lt;span class="k">fallthrough&lt;/span>
&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">description&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="s">&amp;#34; an integer.&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">description&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// The number 5 is a prime number, and also an integer.&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>PS&lt;/strong>&lt;/p>
&lt;p>&lt;code>fallthrough&lt;/code>不会检查后面的case语句条件是否满足，会直接执行&lt;/p>
&lt;p>带标签的语句语法如下， 在循环语句前设置标签即可&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-12-28-swift-lable-statement.png" alt="Labeled Statements">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">outter_loop&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mf">1.&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="mi">5&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">inner_loop&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mf">6.&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="mi">6&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">continue&lt;/span> &lt;span class="n">outter_loop&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">break&lt;/span> &lt;span class="n">outter_loop&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">, &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// 输出&lt;/span>
&lt;span class="c1">// 1, 6&lt;/span>
&lt;span class="c1">// 1, 7&lt;/span>
&lt;span class="c1">// 1, 8&lt;/span>
&lt;span class="c1">// 1, 9&lt;/span>
&lt;span class="c1">// 1, 10&lt;/span>
&lt;span class="c1">// 3, 6&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="guard">guard&lt;/h3>
&lt;p>&lt;code>guard&lt;/code>语句和&lt;code>if&lt;/code>语句类型，根据条件的真假执行语句，与&lt;code>if&lt;/code>不同的是，&lt;code>guard&lt;/code>后必须跟&lt;code>else&lt;/code>条件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">person&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">guard&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">person&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Hello &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">guard&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">location&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">person&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;location&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;I hope the weather is nice near you.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;I hope the weather is nice in &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">location&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">person&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;John&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="c1">//Hello John&lt;/span>
&lt;span class="c1">//I hope the weather is nice near you.&lt;/span>
&lt;span class="n">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">person&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Jane&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;location&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Cupertino&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="c1">//Hello Jane&lt;/span>
&lt;span class="c1">//I hope the weather is nice in Cupertino.&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="函数">函数&lt;/h2>
&lt;p>swift中，函数既可以作为函数的参数，也可以作为返回值存在，函数也可以嵌套函数&lt;/p>
&lt;h3 id="默认参数">默认参数&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">someFunction&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">parameterWithoutDefault&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">parameterWithDefault&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// If you omit the second argument when calling this function, then&lt;/span>
&lt;span class="c1">// the value of parameterWithDefault is 12 inside the function body.&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="不定参数">不定参数&lt;/h3>
&lt;p>在参数类型后面跟&lt;code>...&lt;/code>表示这个参数是不定的，它可以结束0个或者多个参数， 一个函数最多一个不定参数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">arithmeticMean&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">numbers&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span>&lt;span class="p">...)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Double&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">total&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">number&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">numbers&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">total&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">number&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">total&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="nb">Double&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">numbers&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">count&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">arithmeticMean&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// returns 3.0, which is the arithmetic mean of these five numbers&lt;/span>
&lt;span class="n">arithmeticMean&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">8.25&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">18.75&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// returns 10.0, which is the arithmetic mean of these three numbers&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="输入输出参数in-out参数">输入输出参数(In-Out参数)&lt;/h3>
&lt;p>默认情况下，函数的参数都是常量类型，当尝试从函数体内修改参数时，都会报编译错误。如果想修改参数的值，就必须使用In-Out参数，通过在参数名前使用关键字&lt;code>inout&lt;/code>。我们只能使用变量作为in-out参数，不能使用常量作为参数，因为常量是不能被修改的。在参数去使用&lt;code>&amp;amp;&lt;/code>符号，当传递in-out参数时，in-out参数不能有默认值，可变参数不能被标记为in-out参数。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">someInt&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">anotherInt&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">107&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">tesetSwapTwoInts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">_&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">temporaryA&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">a&lt;/span>
&lt;span class="n">a&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">b&lt;/span>
&lt;span class="n">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">temporaryA&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">swapTwoInts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">someInt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">anotherInt&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 会报编译错误&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">swapTwoInts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kr">inout&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">_&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kr">inout&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">temporaryA&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">a&lt;/span>
&lt;span class="n">a&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">b&lt;/span>
&lt;span class="n">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">temporaryA&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">swapTwoInts&lt;/span>&lt;span class="p">(&amp;amp;&lt;/span>&lt;span class="n">someInt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>&lt;span class="n">anotherInt&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;someInt is now &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">someInt&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">, and another is now &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">anotherInt&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// someInt is now 107, and another is now 3&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="函数类型">函数类型&lt;/h3>
&lt;p>每个函数都有函数类型，它是由函数参数类型和函数返回值类型构成的&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">addTwoInts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">_&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">b&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">multiplyTwoInts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">_&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">b&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面两个函数类型都是&lt;code>(Int, Int) -&amp;gt; Int&lt;/code>&lt;/p>
&lt;p>没有参数和返回值的函数类型&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">printHelloWorld&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello, world&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面的函数类型是&lt;code>() -&amp;gt; Void&lt;/code>&lt;/p>
&lt;h3 id="使用函数类型">使用函数类型&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>我们可以像使用普通类型的变量一样使用函数类型。例如，将一个函数赋值为变量&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">mathFunction&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">addTwoInts&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>将函数作为参数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">printMathResult&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">mathFunction&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">_&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">_&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Result: &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">mathFunction&lt;/span>&lt;span class="si">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="si">))&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">printMathResult&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addTwoInts&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>将函数作为返回值&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">stepForward&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">input&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">input&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">stepBackward&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">input&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">input&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">chooseStepFunction&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">backward&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Bool&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">backward&lt;/span> &lt;span class="p">?&lt;/span> &lt;span class="n">stepBackward&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">stepForward&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">currentValue&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">moveNearerToZero&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">chooseStepFunction&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">backward&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">currentValue&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Counting to zero:&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// Counting to zero:&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="n">currentValue&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">currentValue&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">... &amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">currentValue&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">moveNearerToZero&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">currentValue&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;zero!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h3 id="函数嵌套">函数嵌套&lt;/h3>
&lt;p>一个函数可以包含另一个函数的定义，或者将嵌套的函数作为返回值返回&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">chooseStepFunction&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">backward&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Bool&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">stepForward&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">input&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">input&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">stepBackward&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">input&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">input&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">backward&lt;/span> &lt;span class="p">?&lt;/span> &lt;span class="n">stepBackward&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">stepForward&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">currentValue&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">4&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">moveNearerToZero&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">chooseStepFunction&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">backward&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">currentValue&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Counting to zero:&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// Counting to zero:&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="n">currentValue&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">currentValue&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">... &amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">currentValue&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">moveNearerToZero&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">currentValue&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;zero!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>集合类型</title><link>https://crazygit.wiseturtles.com/2018/12/26/collection-types/</link><pubDate>Wed, 26 Dec 2018 23:11:51 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/12/26/collection-types/</guid><description>&lt;p>Swift有三种主要的集合类型，分别是:&lt;/p>
&lt;ul>
&lt;li>Arrays&lt;/li>
&lt;li>Sets&lt;/li>
&lt;li>dictionaries&lt;/li>
&lt;/ul>
&lt;h2 id="数组arrays">数组（Arrays）&lt;/h2>
&lt;p>数组是包含&lt;strong>相同数据类型&lt;/strong>的&lt;strong>有序&lt;/strong>数据集合，&lt;strong>允许相同的数据&lt;/strong>出现在不同的位置。&lt;/p>
&lt;h3 id="创建一个空数组">创建一个空数组&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 两种不同的写法&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">someInts&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">]()&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">anotherInts&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">someInts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">count&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 0&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">anotherInts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">count&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 0&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;!-- raw HTML omitted -->
&lt;h3 id="创建有值的数组">创建有值的数组&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">shoppingList&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Eggs&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Milk&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="创建含有默认值的数组">创建含有默认值的数组&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">threeDoubles&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Array&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">repeating&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">count&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">threeDoubles&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// [0.0, 0.0, 0.0]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="通过相加数组创建新的数组">通过相加数组创建新的数组&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">threeDoubles&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Array&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">repeating&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">count&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">threeDoubles&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">anotherTrheeDoubles&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Array&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">repeating&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">2.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">count&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">sixDoubles&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">threeDoubles&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">anotherTrheeDoubles&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sixDoubles&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// [0.0, 0.0, 0.0, 2.5, 2.5, 2.5]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="数组常用的属性和方法">数组常用的属性和方法&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>跟字符串类型类似，使用&lt;code>count&lt;/code>属性获取数组元素的个数， 使用&lt;code>isEmpty&lt;/code>属性可以检查数组是否为空。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>使用&lt;code>append&lt;/code>方法可以添加一个元素到数组&lt;/p>
&lt;/li>
&lt;li>
&lt;p>使用&lt;code>+=&lt;/code>可以添加一个数组到另一个数组&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">shoppingList&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Eggs&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Milk&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="n">shoppingList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Flour&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">shoppingList&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Baking&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Powder&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>使用下标可以修改数组元素&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">shoppingList&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Six Eggs&amp;#34;&lt;/span>
&lt;span class="c1">// 下标指定的元素个数和赋值的元素个数不一定要相同&lt;/span>
&lt;span class="n">shoppingList&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mf">1.&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Bananas&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Apples&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>插入/删除一个元素&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">shoppingList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">insert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Maple Syrup&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">at&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 删除指定位置的元素&lt;/span>
&lt;span class="n">shoppingList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">remove&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">at&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 删除最后一个元素&lt;/span>
&lt;span class="n">shoppingList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">removeLast&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>遍历数组&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="k">for&lt;/span> &lt;span class="n">item&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">shoppingList&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="集合sets">集合(Sets)&lt;/h2>
&lt;p>集合就是&lt;strong>无序&lt;/strong>， &lt;strong>唯一&lt;/strong>， &lt;strong>相同数据类型&lt;/strong>的集合&lt;/p>
&lt;h3 id="集合的中的数据类型必须是hashble">集合的中的数据类型必须是&lt;code>hashble&lt;/code>&lt;/h3>
&lt;p>为了实现唯一性，集合中的元素必须是&lt;code>hashble&lt;/code>的，比较两个元素是否相同时，比较的其实就是hash值，比如&lt;code>a&lt;/code> == &lt;code>b&lt;/code> 就是比较&lt;code>a.hashValue&lt;/code> == &lt;code>b.hashValue&lt;/code>。&lt;/p>
&lt;p>所有的Swift基础类型(&lt;code>String&lt;/code>, &lt;code>Int&lt;/code>, &lt;code>Double&lt;/code>和&lt;code>Bool&lt;/code>)默认都是&lt;code>hashble&lt;/code>的。当自定义类型需要加入到Sets时，需要自己实现&lt;code>Hashable&lt;/code>协议。&lt;/p>
&lt;h3 id="创建集合">创建集合&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 创建一个空集合&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">letters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Set&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">Character&lt;/span>&lt;span class="p">&amp;gt;()&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">anohterletters&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Set&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">Character&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;span class="c1">// 创建初始有值的集合&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">favoriteGenres&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Set&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Rock&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Classical&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Hip hop&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="c1">// 简写形式&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">favoriteGenres&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Set&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Rock&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Classical&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Hip hop&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="集合常用的属性和方法">集合常用的属性和方法&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>跟字符串类型类似，使用&lt;code>count&lt;/code>属性获取集合元素的个数， 使用&lt;code>isEmpty&lt;/code>属性可以检查集合是否为空。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>往集合添加元素可以使用&lt;code>insert(_:)&lt;/code>方法， 删除元素使用&lt;code>remove(_:)&lt;/code> 方法, 检查是否包含某个元素可以使用&lt;code>contains(_:)&lt;/code>方法&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">fruits&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Set&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Apple&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Pear&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Orange&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="n">fruits&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">insert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Banana&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">fruits&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">remove&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Apple&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">fruits&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Pear&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 遍及集合&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">fruit&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">fruits&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fruit&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="集合操作">集合操作&lt;/h3>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-12-03-swift_set_operations.png" alt="Set Opearations">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">oddDigits&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Set&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">evenDigits&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Set&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">singleDigitPrimerNumbers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">Set&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="c1">// 两个集合的交集&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">oddDigits&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">intersection&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">evenDigits&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="bp">sorted&lt;/span>&lt;span class="p">())&lt;/span> &lt;span class="c1">// []&lt;/span>
&lt;span class="c1">// 两个集合交集以外的集合&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">oddDigits&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">symmetricDifference&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">singleDigitPrimerNumbers&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="bp">sorted&lt;/span>&lt;span class="p">())&lt;/span> &lt;span class="c1">// [1, 2, 9]&lt;/span>
&lt;span class="c1">// 两个集合的并集&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">oddDigits&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">union&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">evenDigits&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="bp">sorted&lt;/span>&lt;span class="p">())&lt;/span> &lt;span class="c1">// [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]&lt;/span>
&lt;span class="c1">// 属于集合a, 但是不属于集合b&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">oddDigits&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">subtracting&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">singleDigitPrimerNumbers&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="bp">sorted&lt;/span>&lt;span class="p">())&lt;/span> &lt;span class="c1">// [1, 9]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="集合关系">集合关系&lt;/h3>
&lt;p>假如有三个集合&lt;code>a&lt;/code>, &lt;code>b&lt;/code>, &lt;code>c&lt;/code>的关系如下图所示:&lt;/p>
&lt;ul>
&lt;li>&lt;code>a&lt;/code>是&lt;code>b&lt;/code>的父集，&lt;code>a&lt;/code>包含所有&lt;code>b&lt;/code>中的元素&lt;/li>
&lt;li>&lt;code>b&lt;/code>是&lt;code>a&lt;/code>的自己，&lt;code>b&lt;/code>中的元素&lt;code>a&lt;/code>中都有&lt;/li>
&lt;li>&lt;code>b&lt;/code>和&lt;code>c&lt;/code>没有相交，它们之间没有相同的元素&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-12-03-swift_set_membership.png" alt="set membership">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">houseAnimals&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Set&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;🐶&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;🐱&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">farmAnimals&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Set&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;🐮&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;🐔&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;🐑&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;🐶&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;🐱&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">cityAnimals&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Set&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;🐦&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;🐭&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="c1">// 用&amp;#34;==&amp;#34;判断两个集合是否相同&lt;/span>
&lt;span class="n">houseAnimals&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="n">cityAnimals&lt;/span> &lt;span class="c1">// false&lt;/span>
&lt;span class="c1">// 是否是子集(两个集合可能相等)&lt;/span>
&lt;span class="n">houseAnimals&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">isSubset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">of&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">farmAnimals&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true&lt;/span>
&lt;span class="c1">// 是否是父集&lt;/span>
&lt;span class="n">farmAnimals&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">isSuperset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">of&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">houseAnimals&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true&lt;/span>
&lt;span class="c1">// 是否不相交&lt;/span>
&lt;span class="n">farmAnimals&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">isDisjoint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">with&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cityAnimals&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true&lt;/span>
&lt;span class="c1">// 判断是否是子集或父集(两个集合不相等)&lt;/span>
&lt;span class="n">houseAnimals&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">isStrictSubset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">of&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">farmAnimals&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true&lt;/span>
&lt;span class="n">farmAnimals&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">isStrictSuperset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">of&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">houseAnimals&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true&lt;/span>
&lt;span class="n">houseAnimals&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">isSubset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">of&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">houseAnimals&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true&lt;/span>
&lt;span class="n">houseAnimals&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">isStrictSubset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">of&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">houseAnimals&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// false&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="字典dictionaries">字典(Dictionaries)&lt;/h2>
&lt;p>字典就是键值对的集合，跟Set类型一样，字典的键也必须是&lt;code>hashble&lt;/code>的，字段中的元素都是无序的&lt;/p>
&lt;h3 id="创建一个空字典">创建一个空字典&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">namesOfIntegers&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">]()&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="使用字典语法创建字典">使用字典语法创建字典&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">airports&lt;/span>&lt;span class="p">:[&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;XYZ&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Toronto Pearson&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;DUB&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Dublin&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="数组常用的属性和方法-1">数组常用的属性和方法&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>跟数组一样，可以使用&lt;em>只读&lt;/em>属性&lt;code>count&lt;/code>获取字典中的元素个数&lt;/p>
&lt;/li>
&lt;li>
&lt;p>使用&lt;code>isEmpty&lt;/code>属性检查字典元素格式是否为0&lt;/p>
&lt;/li>
&lt;li>
&lt;p>可以直接使用下标访问字典&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">airports&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;LHR&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;London&amp;#34;&lt;/span>
&lt;span class="n">airports&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;LHR&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;London Heathrow&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>除了上面通过下标的方式修改元素的值之外，也可以使用&lt;code>updateValue(_:forKey:)&lt;/code>来修改元素的值，与使用下标方式不同的值，如果指定的key存在的话，它除了改变key的值之外，还会返回key之前的值&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">airports&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Name&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;John&amp;#34;&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">oldValue&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">airports&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">updateValue&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Crazygit&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">forKey&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Name&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">oldValue&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// print &amp;#34;John&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>通过下标访问字段的时候，返回的值也是可选值类型, 当key不存在时，直接返回&lt;code>nil&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="k">if&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">airports&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Name&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;No Name&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>删除元素有两种方式，一种是使用下标的方式，将元素赋值为&lt;code>nil&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">airports&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Name&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">airports&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// Name键已经从字典中移除&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>另一种方式是使用&lt;code>removeValue(forkey:)&lt;/code>方法，与通过下标访问的不同的是，它会返回被移除的值&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="k">if&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">removedValue&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">airports&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">removeValue&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">forKey&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;DUB&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Remove key DUB from airports dict&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;airport dict dose not contain a value for DUB&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>遍历字典&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 遍历键和值&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">airports&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> =&amp;gt; &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// 遍历键&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">airports&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">keys&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// 遍历值&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">value&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">airports&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">values&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Swift基本运算符</title><link>https://crazygit.wiseturtles.com/2018/12/03/basic-operators/</link><pubDate>Mon, 03 Dec 2018 12:01:55 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/12/03/basic-operators/</guid><description>&lt;h3 id="比较运算符">比较运算符&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Swift中提供了检查两个对象是否同引用同一个示例的操作符&lt;code>===&lt;/code>和&lt;code>!==&lt;/code>。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>当两个元祖有相同的元素类型和个数时，可以直接比较两个元祖。从左到右，直到找到不相等的。&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;zebra&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;apple&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true because 1 is less than 2; &amp;#34;zebra&amp;#34; and &amp;#34;apple&amp;#34; are not compared&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;apple&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;bird&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true because 3 is equal to 3, and &amp;#34;apple&amp;#34; is less than &amp;#34;bird&amp;#34;&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;dog&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;dog&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true because 4 is equal to 4, and &amp;#34;dog&amp;#34; is equal to &amp;#34;dog”&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="nil-coalescing">Nil-Coalescing&lt;/h3>
&lt;p>用法&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">a&lt;/span> &lt;span class="p">??&lt;/span> &lt;span class="n">b&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>当可选值&lt;code>a&lt;/code>包含值的时候，上面的表达式返回&lt;code>a&lt;/code>的值，当&lt;code>a&lt;/code>为&lt;code>nil&lt;/code>时，否则返回&lt;code>b&lt;/code>，&lt;/p>
&lt;p>等价于三目运算符&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">a&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">?&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">!:&lt;/span> &lt;span class="n">b&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用这个运算符的好处就是在处理可选值时，不用强制拆包&lt;/p>
&lt;p>例如&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">defaultColorName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;red&amp;#34;&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">userDefinedColorName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">?&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">colorNameToUse&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">userDefinedColorName&lt;/span> &lt;span class="p">??&lt;/span> &lt;span class="n">defaultColorName&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">colorNameToUse&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// red&lt;/span>
&lt;span class="n">userDefinedColorName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;green&amp;#34;&lt;/span>
&lt;span class="n">colorNameToUse&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">userDefinedColorName&lt;/span> &lt;span class="p">??&lt;/span> &lt;span class="n">defaultColorName&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">colorNameToUse&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// green&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="范围运算符">范围运算符&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// Closed Range Operator&lt;/span>
&lt;span class="c1">// 全闭包，包含`a`和`b`, 必须满足`a`&amp;lt;=`b`&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// Half-Open Range Operator&lt;/span>
&lt;span class="c1">//半闭包，包含`a`, 但是不包含`b`&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">..&amp;lt;&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">//one-sided range&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// Closed Range Operator&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">index&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mf">1.&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="mi">5&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">terminator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 1,2,3,4,5,&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">names&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Anna&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Alex&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Brian&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Jack&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">count&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">names&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">count&lt;/span>
&lt;span class="c1">// Half-Open Range Operator&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">index&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mf">0.&lt;/span>&lt;span class="p">.&amp;lt;&lt;/span>&lt;span class="bp">count&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">names&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">terminator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// Anna,Alex,Brian,Jack,&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// one-sided range&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">name&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">names&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mf">2.&lt;/span>&lt;span class="p">..]&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">terminator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// Brian,Jack,&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">name&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">names&lt;/span>&lt;span class="p">[..&amp;lt;&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">terminator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// Anna,Alex,&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// 检查是否包含特定的值&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">range&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">...&lt;/span>&lt;span class="mi">5&lt;/span>
&lt;span class="n">range&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="逻辑运算符">逻辑运算符&lt;/h3>
&lt;ul>
&lt;li>&lt;code>&amp;amp;&amp;amp;&lt;/code> 逻辑与，短路运算，钱一个值为&lt;code>false&lt;/code>时，直接返回&lt;code>false&lt;/code>, 不会计算后面的表达式&lt;/li>
&lt;li>&lt;code>||&lt;/code> 逻辑或&lt;/li>
&lt;li>&lt;code>!a&lt;/code> 非运算&lt;/li>
&lt;/ul>
&lt;p>当有多个&lt;code>&amp;amp;&amp;amp;&lt;/code>和&lt;code>||&lt;/code>运算时，他们的优先级是从左到右的。这种情况下最好使用括号来明确优先级顺序&lt;/p>
&lt;h3 id="字符characters和字符串string">字符(Characters)和字符串(String)&lt;/h3>
&lt;ul>
&lt;li>字符串只能使用双引号&lt;code>&amp;quot;&amp;quot;&lt;/code>&lt;/li>
&lt;li>多行字符串可以用三引号&lt;code>&amp;quot;&amp;quot;&amp;quot;&lt;/code>&lt;/li>
&lt;li>多行字符串缩进效果如下图所示&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-11-30-string_indent.png" alt="">&lt;/p>
&lt;ul>
&lt;li>&lt;code>isEmpty&lt;/code>属性可以判断一个字符串是否为空&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 注意是属性，不是方法&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">emptyString&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">emptyString&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">isEmpty&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Nothing to see here&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>声明字符&lt;/li>
&lt;/ul>
&lt;p>通过&lt;code>Character&lt;/code>类型声明字符&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">character&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Character&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;a&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>字符串也可以由字符串数组来声明&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">catCharacter&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">Character&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;C&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;t&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;!&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">catString&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">catCharacter&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">catString&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// &amp;#34;Cat!&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>字符和字符串拼接&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 用 + 号拼接字符串&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">string1&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Hello &amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">string2&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;World&amp;#34;&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">welcome&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">string1&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">string2&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">welcome&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// &amp;#34;Hello World&amp;#34;&lt;/span>
&lt;span class="c1">// 用append方法添加字符到字符串&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">exclamationMark&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">Character&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;!&amp;#34;&lt;/span>
&lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">exclamationMark&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">welcome&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// &amp;#34;Hello World!&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>统计字符的个数&lt;/li>
&lt;/ul>
&lt;p>使用&lt;code>count&lt;/code>属性，可以求一个字符串中的字符个数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">foo&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;ABCDEFG&amp;#34;&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">count&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 7&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>字符串索引&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">foo&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;ABCDEFGHIJKLMN&amp;#34;&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">startIndex&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="c1">// A&lt;/span>
&lt;span class="c1">// 从这里看出swift是否支持函数重载，两个函数只是参数名字不一样&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">before&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">foo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">endIndex&lt;/span>&lt;span class="p">)])&lt;/span> &lt;span class="c1">// N&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">after&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">foo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">startIndex&lt;/span>&lt;span class="p">)])&lt;/span> &lt;span class="c1">// B&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">index&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">foo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">startIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">offsetBy&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="c1">// H&lt;/span>
&lt;span class="c1">// 通过indices属性可以遍历每个字符&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">index&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">foo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">indices&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">foo&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">terminator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// ABCDEFGHIJKLMN&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>字符串插入和删除操作&lt;/li>
&lt;/ul>
&lt;p>使用&lt;code>insert(_:at:)&lt;/code>和&lt;code>insert(contentsOf:at:)&lt;/code>插入字符和字符串
使用&lt;code>remove(at:)&lt;/code>和&lt;code>removeSubrange(_:)&lt;/code>删除字符和字符串&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">welcome&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>
&lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">insert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;!&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">at&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">endIndex&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// welcome变成 &amp;#34;hello!&amp;#34;&lt;/span>
&lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">insert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">contentsOf&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34; there&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">at&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">before&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">endIndex&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// welcome变成&amp;#34;hello there!&amp;#34;&lt;/span>
&lt;span class="c1">// remove方法会返回被移除的字符&lt;/span>
&lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">remove&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">at&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">before&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">endIndex&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// 返回值是&amp;#34;!&amp;#34;，welcome变成 &amp;#34;hello there&amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">range&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">endIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">offsetBy&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">)..&amp;lt;&lt;/span>&lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">endIndex&lt;/span>
&lt;span class="n">welcome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">removeSubrange&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// welcome变成 &amp;#34;hello&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>子字符串&lt;/li>
&lt;/ul>
&lt;p>在Swift中，当从一个字符串中获取字符串时，得到的是一个&lt;code>Substring&lt;/code>类型，并不是一个新的字符串，&lt;code>Substring&lt;/code>和字符串类型的方法完全相同，唯一的区别就是子字符串只会在操作字符串时短暂保存，当需要长期使用子字符串时，应该将它转换为字符串类型&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">greeting&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Hello, world!&amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">index&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">greeting&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">firstIndex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">of&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">??&lt;/span> &lt;span class="n">greeting&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">endIndex&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">beginning&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">greeting&lt;/span>&lt;span class="p">[..&amp;lt;&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="c1">// beginning is &amp;#34;Hello&amp;#34;&lt;/span>
&lt;span class="c1">// convert the result to string for long-term storage.&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">newString&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">beginning&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>因此子字符中类型并不适合长期保存。&lt;/p>
&lt;ul>
&lt;li>字符串前缀和后缀&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">msg&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Hello World&amp;#34;&lt;/span>
&lt;span class="n">msg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">hasPrefix&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Hello&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true&lt;/span>
&lt;span class="n">msg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">hasSuffix&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;World&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// true&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Swift基本语法</title><link>https://crazygit.wiseturtles.com/2018/10/30/swfit-the-basics/</link><pubDate>Tue, 30 Oct 2018 11:58:55 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/10/30/swfit-the-basics/</guid><description>&lt;h3 id="常量和变量">常量和变量&lt;/h3>
&lt;p>一次声明多个变量&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">x&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">z&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">0.0&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">red&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">green&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">blue&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="变量名">变量名&lt;/h3>
&lt;p>Swift的变量名&lt;strong>可以是&lt;/strong>任何的Unicode字符, 如: 中文, Emoji表情等都可以是变量名。&lt;/p>
&lt;p>常量与变量名不能包含空格符,数学符号,箭头,保留的(或者非法的)Unicode 码位,连线与制表符。也不能以数字开头, 但是可以在常量与变量名的其他地方包含数字。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="err">π&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">3.14159&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="err">你好&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;你好世界&amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="err">🐶🐮&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;dogcow”
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="print函数">print函数&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">x&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="p">,&lt;/span>&lt;span class="n">y&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">z&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">3&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;John&amp;#34;&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">z&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 可以一次传入多个参数&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">z&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">separator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;:&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 指定分隔符&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">z&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">separator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">terminator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;;&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//指定行尾截止符号，默认是回车&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;My name is &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 变量替换&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="注释">注释&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 单行注释&lt;/span>
&lt;span class="cm">/*
&lt;/span>&lt;span class="cm">多行注释
&lt;/span>&lt;span class="cm">*/&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="分号">分号&lt;/h3>
&lt;p>swift语法中，每行代码结尾的分号是可以省略的，但是如果一行包含多个语句时，分号则不能省略&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">cat&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="n">cat&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cat&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="整型">整型&lt;/h3>
&lt;p>一些整型常量&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 有符号数最大值和最小值&lt;/span>
&lt;span class="nb">Int&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">max&lt;/span>
&lt;span class="nb">Int&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">min&lt;/span>
&lt;span class="c1">// 无符号数最大值和最小值&lt;/span>
&lt;span class="nb">UInt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">max&lt;/span>
&lt;span class="n">Uint&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">min&lt;/span>
&lt;span class="c1">// 指定机器位数&lt;/span>
&lt;span class="nb">Int8&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">max&lt;/span>
&lt;span class="nb">Int8&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">min&lt;/span>
&lt;span class="c1">// 二级制表示17&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">binaryInt&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mb">0b10001&lt;/span>
&lt;span class="c1">// 八进制表示17&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">octalInt&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mo">0o21&lt;/span>
&lt;span class="c1">// 十六进制表示17&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">hexInt&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mh">0x11&lt;/span>
&lt;span class="c1">// 小技巧: 整型赋值时的小技巧，可以用下划线分隔，方便阅读&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">a&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">1_000_1000&lt;/span> &lt;span class="c1">// 一百万&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">decimalInteger&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">17&lt;/span>
&lt;span class="c1">// 二进制的17 “0b”&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">binaryInteger&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mb">0b10001&lt;/span>
&lt;span class="c1">// 八进制的17 &amp;#34;0o&amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">octalInteger&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mo">0o21&lt;/span>
&lt;span class="c1">// 十六进制的17 &amp;#34;0x&amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">hexadecimalInteger&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mh">0x11&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>一般建议直接使用&lt;code>Int&lt;/code>类型，它的位数默认与当前使用的操作平台相关:&lt;/p>
&lt;ul>
&lt;li>在32位的平台上，等效于&lt;code>Int32&lt;/code>&lt;/li>
&lt;li>在64位的平台上，等效于&lt;code>Int64&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="浮点型">浮点型&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 单精度和双精度浮点数&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Float&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">3.1415926&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">b&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">3.1415926&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="类型别名">类型别名&lt;/h3>
&lt;p>可以使用 &lt;code>typealias&lt;/code> 关键字来定义类型别名&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">typealias&lt;/span> &lt;span class="n">AudioSample&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">UInt16&lt;/span>
&lt;span class="c1">//AudioSample.min 实际上是 UInt16.min ,所以会给 maxAmplitudeFound 赋一个初值 0&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">maxAmplitudeFound&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">AudioSample&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">min&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="布尔类型和if语句">布尔类型和if语句&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// bool值都是小写&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">imTrue&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Bool&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">imFalse&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Bool&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">imTrue&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;I am True&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;3+4 == 7&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;I am false&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// 不能用非0值作为为真的条件，如下面的语句会报语法错误&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;I am true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="元组">元组&lt;/h3>
&lt;ul>
&lt;li>将多个不同的值集合成一个数据&lt;/li>
&lt;li>可以有任意多个值&lt;/li>
&lt;li>不同的值可以是不同的类型&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">point&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">httpResponse&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">404&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Not Found&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">point2&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 元组赋值&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">point&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 与pythn中不一样，赋值时等号左右的圆括号不能省略&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">point&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">status_code&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">status_message&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">http404Error&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 通过下标访问元组元素, 与python中使用下标的方式不太一样&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">point&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">point&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 通过元素名称访问，有点python字典的感觉&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">point3&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">point3&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">x&lt;/span>
&lt;span class="n">point3&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">y&lt;/span>
&lt;span class="c1">// 声明时指定元素名称&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">point4&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">point4&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">x&lt;/span>
&lt;span class="n">point4&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">y&lt;/span>
&lt;span class="c1">// 使用&amp;#34;_&amp;#34;忽略一些元素&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">logingResult&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;xxxxx&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">isLoginSuccess&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">_&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">logingResult&lt;/span>
&lt;span class="n">isLoginSuccess&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="可选值">可选值&lt;/h3>
&lt;p>当可以确定一个可选值包含有值时，可以使用&lt;code>!&lt;/code>来强制使用值&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">possibleNumber&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;123&amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">convertedNumber&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">possibleNumber&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">convertedNumber&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;convertedNumber contains some integer value.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">convertedNumber&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;convertedNumber has an integer value of &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">convertedNumber&lt;/span>&lt;span class="p">!&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>if&lt;/code>语句中可以同时绑定多个可选值（用&lt;code>,&lt;/code>分隔）。只有当所有的值都真实有值时，&lt;code>if&lt;/code>条件才成立。&lt;/p>
&lt;p>下面两个if语句是等效的&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="k">if&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">firstNumber&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;4&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">secondNumber&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;42&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">firstNumber&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">secondNumber&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">secondNumber&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">firstNumber&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> &amp;lt; &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">secondNumber&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> &amp;lt; 100&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">//等效&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">firstNumber&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;4&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">secondNumber&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;42&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">firstNumber&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">secondNumber&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">secondNumber&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">firstNumber&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> &amp;lt; &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">secondNumber&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> &amp;lt; 100&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>if语句绑定的可选值有效范围仅在if语句内部&lt;/p>
&lt;h3 id="断言assertions和先决条件preconditons">断言(Assertions)和先决条件(Preconditons)&lt;/h3>
&lt;p>Assertions和Preconditions的区别在于Assertions只在debug build中生效，
而Precondtions在debug build和production build中都生效。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">
&lt;span class="kd">let&lt;/span> &lt;span class="nv">age&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>
&lt;span class="bp">assert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">age&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;A person&amp;#39;s age can&amp;#39;t be less than zero.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">//省略断言消息&lt;/span>
&lt;span class="bp">assert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">age&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">//使用assertionFailure直接抛出断言异常&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">age&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">10&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;You can ride the rollercoaster or the ferris wheel.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">age&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;You can ride the ferris wheel.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">assertionFailure&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;A person&amp;#39;s age can&amp;#39;t be less than zero.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">index&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="bp">precondition&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">index&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Index must greater than zero.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">//使用preconditionFailure直接抛出异常&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">age&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">age&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">10&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;You can ride the rollercoaster or the ferris wheel.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">age&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;You can ride the ferris wheel.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">preconditionFailure&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;A person&amp;#39;s age can&amp;#39;t be less than zero.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>PS&lt;/strong>:&lt;/p>
&lt;p>当在编译的时候用的是&lt;code>unchecked mode&lt;/code>(&lt;code>-Ounckecked&lt;/code>), precondition是不会被执行的，默认它们的条件都是成立的，返回&lt;code>true&lt;/code>。但是，使&lt;code>fatalError(_:file:line:)&lt;/code>是会生效的，无论编译参数是什么。&lt;/p></description></item><item><title>Developing iOS 11 Apps with Swift视频下载</title><link>https://crazygit.wiseturtles.com/2018/10/29/developing_ios11_apps_with_swift/</link><pubDate>Mon, 29 Oct 2018 16:15:15 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/10/29/developing_ios11_apps_with_swift/</guid><description>&lt;p>从Mac版的iTunes里找到课程，通过分享链接，获取下面的地址，
其实就是一个xml文件&lt;/p>
&lt;p>&lt;a href="http://podcasts.apple.com/stanford/developing_ios11_apps.xml">iTunes podcasts 视频解析地址&lt;/a>&lt;/p>
&lt;p>解析出所有的下载地址&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="kn">import&lt;/span> &lt;span class="nn">xml.etree.ElementTree&lt;/span> &lt;span class="kn">as&lt;/span> &lt;span class="nn">ET&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">requests&lt;/span>
&lt;span class="n">root&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ET&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fromstring&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">requests&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;http://podcasts.apple.com/stanford/developing_ios11_apps.xml&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">enclosure&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">findall&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.//enclosure&amp;#39;&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">enclosure&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;url&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="解析结果">解析结果&lt;/h2>
&lt;h3 id="视频下载地址视频里内置了英文字幕要播放器支持才能看到也可以用字幕提取工具ccextractorhttpswwwccextractororg提取字幕">视频下载地址(视频里内置了英文字幕，要播放器支持才能看到。也可以用字幕提取工具&lt;a href="https://www.ccextractor.org/">CCExtractor&lt;/a>提取字幕)&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/1_Introduction_to_iOS_11_Xcode_9_and_Swift_4_311-6554896743492737986-01_9_25_17_1080p_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/1_Introduction_to_iOS_11_Xcode_9_and_Swift_4_311-6554896743492737986-01_9_25_17_1080p_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/2_MVC_309-2503760600607007728-02_9_27_17_CS193p_720p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/2_MVC_309-2503760600607007728-02_9_27_17_CS193p_720p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/504-8815564797834236275-Friday_01_9_29_17_WIP02_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/504-8815564797834236275-Friday_01_9_29_17_WIP02_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/3_Swift_Programming_Language_319-2557083044702627203-03_10_02_17_prores_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/3_Swift_Programming_Language_319-2557083044702627203-03_10_02_17_prores_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/4_More_Swift_336-3848977901446740876-04_10_04_17_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/4_More_Swift_336-3848977901446740876-04_10_04_17_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/5_Drawing_317-8878116075149346380-05_10_09_17_prores_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/5_Drawing_317-8878116075149346380-05_10_09_17_prores_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/6_Multitouch_321-6728107643679048758-06_10_11_17_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/6_Multitouch_321-6728107643679048758-06_10_11_17_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/309-96054835436878188-07_10_16_17_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/309-96054835436878188-07_10_16_17_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/327-7793456677118526749-08_10_18_17_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/327-7793456677118526749-08_10_18_17_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/533-6252825471341223932-Friday_02_WIP02_1080p_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/533-6252825471341223932-Friday_02_WIP02_1080p_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/335-8360806109958293556-09_10_23_17_prores_CS193p_1080p_3mb_cc2.m4v">http://podcasts.apple.com/stanford/media/335-8360806109958293556-09_10_23_17_prores_CS193p_1080p_3mb_cc2.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/311-695518005627000002-10_10_25_17_prores_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/311-695518005627000002-10_10_25_17_prores_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/531-9139141023410630962-Friday_03_10_27_17_WIP02_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/531-9139141023410630962-Friday_03_10_27_17_WIP02_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/335-5035465745252410791-11_10_30_17_prores_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/335-5035465745252410791-11_10_30_17_prores_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/303-5025198319972677062-12_11_01_17_prores_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/303-5025198319972677062-12_11_01_17_prores_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/312-9097236878835223246-13_11_06_17_prores_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/312-9097236878835223246-13_11_06_17_prores_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/305-1366423083051400424-14_11_08_17_prores_1_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/305-1366423083051400424-14_11_08_17_prores_1_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/532-3346936006580998385-15_11_13_17_prores_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/532-3346936006580998385-15_11_13_17_prores_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/511-8983128522622077657-16_11_15_17_prores_CS193p_1080p_3mb.m4v">http://podcasts.apple.com/stanford/media/511-8983128522622077657-16_11_15_17_prores_CS193p_1080p_3mb.m4v&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/506-4176003801724267012-17_11_29_17_WIP02_CS193p_1080p_3mb_cc.m4v">http://podcasts.apple.com/stanford/media/506-4176003801724267012-17_11_29_17_WIP02_CS193p_1080p_3mb_cc.m4v&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="pdf课件下载地址">PDF课件下载地址&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/Lecture_1_Slides.pdf">http://podcasts.apple.com/stanford/media/Lecture_1_Slides.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/Reading_1_Intro_to_Swift.pdf">http://podcasts.apple.com/stanford/media/Reading_1_Intro_to_Swift.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/Lecture_2_Slides.pdf">http://podcasts.apple.com/stanford/media/Lecture_2_Slides.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/Programming_Project_1_Concentration.pdf">http://podcasts.apple.com/stanford/Programming_Project_1_Concentration.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/Lecture_3_Slides.pdf">http://podcasts.apple.com/stanford/media/Lecture_3_Slides.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/Reading_2_Intro_to_Swift.pdf">http://podcasts.apple.com/stanford/media/Reading_2_Intro_to_Swift.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/Lecture_4_Slides.pdf">http://podcasts.apple.com/stanford/media/Lecture_4_Slides.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/Programming_Project%202_Set.pdf">http://podcasts.apple.com/stanford/Programming_Project%202_Set.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/Lecture_5_Slides.pdf">http://podcasts.apple.com/stanford/media/Lecture_5_Slides.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/336-3367719085568248138-CS193P_F17_Reading_3.pdf">http://podcasts.apple.com/stanford/media/336-3367719085568248138-CS193P_F17_Reading_3.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/Lecture_6_Slides.pdf">http://podcasts.apple.com/stanford/media/Lecture_6_Slides.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/309-1475895300459033080-CS193P_F17_Assignment_3.pdf">http://podcasts.apple.com/stanford/media/309-1475895300459033080-CS193P_F17_Assignment_3.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/320-5503734535583450465-CS193P_F17_Lecture_7.pdf">http://podcasts.apple.com/stanford/media/320-5503734535583450465-CS193P_F17_Lecture_7.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/335-3416648937156657194-CS193P_F17_Lecture_8.pdf">http://podcasts.apple.com/stanford/media/335-3416648937156657194-CS193P_F17_Lecture_8.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/309-2441628197055099936-CS193P_F17_Assignment_4.pdf">http://podcasts.apple.com/stanford/media/309-2441628197055099936-CS193P_F17_Assignment_4.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/332-3154341613995510587-CS193P_F17_Lecture_9.pdf">http://podcasts.apple.com/stanford/media/332-3154341613995510587-CS193P_F17_Lecture_9.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/322-6515997048783028736-CS193P_F17_Lecture_10.pdf">http://podcasts.apple.com/stanford/media/322-6515997048783028736-CS193P_F17_Lecture_10.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/317-8823617114003497609-CS193P_F17_Lecture_11.pdf">http://podcasts.apple.com/stanford/media/317-8823617114003497609-CS193P_F17_Lecture_11.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/306-4082649130340532415-CS193P_F17_Lecture_12.pdf">http://podcasts.apple.com/stanford/media/306-4082649130340532415-CS193P_F17_Lecture_12.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/308-8518403617003934463-CS193P_F17_Assignment_5.pdf">http://podcasts.apple.com/stanford/media/308-8518403617003934463-CS193P_F17_Assignment_5.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/323-4247208383177102782-CS193P_F17_Lecture_13.pdf">http://podcasts.apple.com/stanford/media/323-4247208383177102782-CS193P_F17_Lecture_13.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/322-5794459892624250293-CS193P_F17_Lecture_14.pdf">http://podcasts.apple.com/stanford/media/322-5794459892624250293-CS193P_F17_Lecture_14.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/307-9138746427331321981-CS193P_F17_Assignment_6.pdf">http://podcasts.apple.com/stanford/media/307-9138746427331321981-CS193P_F17_Assignment_6.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/522-830176750758320683-CS193P_F17_Lecture_15.pdf">http://podcasts.apple.com/stanford/media/522-830176750758320683-CS193P_F17_Lecture_15.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/512-802352814004650525-CS193P_F17_Lecture_16.pdf">http://podcasts.apple.com/stanford/media/512-802352814004650525-CS193P_F17_Lecture_16.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://podcasts.apple.com/stanford/media/520-5280642336803569160-CS193P_F17_Lecture_17_Slides.pdf">http://podcasts.apple.com/stanford/media/520-5280642336803569160-CS193P_F17_Lecture_17_Slides.pdf&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="中文字幕">中文字幕&lt;/h2>
&lt;p>网上找到的中文字幕&lt;/p>
&lt;p>&lt;a href="https://github.com/ApolloZhu/Developing-iOS-11-Apps-with-Swift">https://github.com/ApolloZhu/Developing-iOS-11-Apps-with-Swift&lt;/a>&lt;/p></description></item><item><title>Swift入门指南二</title><link>https://crazygit.wiseturtles.com/2018/10/27/swift-tour-002/</link><pubDate>Sat, 27 Oct 2018 22:55:22 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/10/27/swift-tour-002/</guid><description>&lt;h2 id="对象和类">对象和类&lt;/h2>
&lt;p>创建类&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">class&lt;/span> &lt;span class="nc">Shape&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">numberOfSides&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">simpleDescription&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;A shape with &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">numberOfSides&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> sides.&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">shape&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Shape&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">shape&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">numberOfSides&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">7&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">shapeDescription&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">shape&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>init&lt;/code>构造函数，&lt;code>deinit&lt;/code>析构函数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">class&lt;/span> &lt;span class="nc">NamedShape&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">numberOfSides&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>
&lt;span class="kd">init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kc">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">name&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">simpleDescription&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;A shape whit &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">numberOfSides&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> sides&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>类属性必须要设置一个值，要么在声明属性的时候指定，要么在&lt;code>init&lt;/code>函数中指定。&lt;/p>
&lt;p>继承类, 使用&lt;code>:&lt;/code>， 覆写父类的方法&lt;strong>必须&lt;/strong>使用&lt;code>override&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">class&lt;/span> &lt;span class="nc">Square&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">NamedShape&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">sideLength&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span>
&lt;span class="kd">init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="kc">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sideLength&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">sideLength&lt;/span>
&lt;span class="c1">// 调用父类的方法&lt;/span>
&lt;span class="kc">super&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="kd">init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">numberOfSides&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">4&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">area&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Double&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">sideLength&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">sideLength&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// 覆写父类的方法&lt;/span>
&lt;span class="kr">override&lt;/span> &lt;span class="kd">func&lt;/span> &lt;span class="nf">simpleDescription&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;A square with sides of length &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">.&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>属性的&lt;code>getter&lt;/code>和&lt;code>setter&lt;/code>方法，&lt;code>set&lt;/code>没有指定参数名时，默认用&lt;code>newValue&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">
&lt;span class="kd">class&lt;/span> &lt;span class="nc">EquilateralTriangle&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">NamedShape&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">sideLength&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">0.0&lt;/span>
&lt;span class="kd">init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="kc">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sideLength&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">sideLength&lt;/span>
&lt;span class="kc">super&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="kd">init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">numberOfSides&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">perimeter&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kr">get&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="mf">3.0&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">sideLength&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kr">set&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">sideLength&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">newValue&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="mf">3.0&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">//var perimeter: Double {&lt;/span>
&lt;span class="c1">// get {&lt;/span>
&lt;span class="c1">// return 3.0 * sideLength&lt;/span>
&lt;span class="c1">// }&lt;/span>
&lt;span class="c1">// set(newPerimeter) {&lt;/span>
&lt;span class="c1">// sideLength = newPerimeter / 3.0&lt;/span>
&lt;span class="c1">// }&lt;/span>
&lt;span class="c1">//}&lt;/span>
&lt;span class="kr">override&lt;/span> &lt;span class="kd">func&lt;/span> &lt;span class="nf">simpleDescription&lt;/span> &lt;span class="p">()-&amp;gt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;An equilateral triangle with sides of length &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>willSet&lt;/code>和&lt;code>didSet&lt;/code>实现属性观察&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">class&lt;/span> &lt;span class="nc">TriangleAndSquare&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">triangle&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">EquilateralTriangle&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kr">willSet&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">square&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sideLength&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">newValue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sideLength&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">square&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Square&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kr">willSet&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">triangle&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sideLength&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">newValue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sideLength&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="n">square&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Square&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">triangle&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">EquilateralTriangle&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">triganleAndSquare&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">TriangleAndSquare&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;another test shape&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 10.0&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">triganleAndSquare&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">square&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 10.0&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">triganleAndSquare&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">triangle&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">triganleAndSquare&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">square&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Square&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Larger square&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 50.0&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">triganleAndSquare&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">triangle&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>当使用可选值时，可以写个&lt;code>?&lt;/code>在运行符前面，如果&lt;code>?&lt;/code>前面的值是&lt;code>nil&lt;/code>, 所有在&lt;code>?&lt;/code>后面的值都是&lt;code>nil&lt;/code>,&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">optionalSquare&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Square&lt;/span>&lt;span class="p">?&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Square&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sideLength&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">2.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;optional square&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">sideLength&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">optionalSquare&lt;/span>&lt;span class="p">?.&lt;/span>&lt;span class="n">sideLength&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="枚举enum">枚举&lt;code>enum&lt;/code>&lt;/h2>
&lt;p>枚举&lt;code>enum&lt;/code>类型跟类&lt;code>class&lt;/code>一样也可以有方法&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">enum&lt;/span> &lt;span class="nc">Rank&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">ace&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">two&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">three&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">four&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">five&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sixe&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">seven&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">eight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">nine&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ten&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">jack&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">queen&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">king&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">simpleDescription&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">switch&lt;/span> &lt;span class="kc">self&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">ace&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;ace&amp;#34;&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">jack&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;jack&amp;#34;&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">queen&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;queen&amp;#34;&lt;/span>
&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">rawValue&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">ace&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Rank&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ace&lt;/span>
&lt;span class="c1">// 1&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">aceRawValue&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">ace&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">rawValue&lt;/span>
&lt;span class="c1">// 2&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Rank&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">two&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">rawValue&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ace&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>默认情况下，枚举类型的原始值是从0开始的，然后依次加1，但是可以通过明确赋值，可以改变这个行为。
比如上面的例子，&lt;code>ace&lt;/code>就是从1开始，后面的值也依次加1，同时，也可以给枚举类型赋值为字符串或浮点数。&lt;/p>
&lt;p>使用&lt;code>init?(rawValue:)&lt;/code>初始化一个枚举类型，当这个值是enum类型的值时，就返回枚举类型，否则返回&lt;code>nil&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">
&lt;span class="c1">// 13刚好对应king&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">convertedRank&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Rank&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rawValue&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">13&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">threeDescription&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">convertedRank&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1">// 13&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// convertedRank 为nil, if语句不会执行&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">convertedRank&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Rank&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rawValue&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">threeDescription&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">convertedRank&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1">// 1&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>如果结构体有原始值的话，可以在初始化时决定它的类型&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">enum&lt;/span> &lt;span class="nc">ServerResponse&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">failure&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">success&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">ServerResponse&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;6:00 am&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;8:09 pm&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">failure&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">ServerResponse&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">failure&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Out of cheese.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">success&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">switch&lt;/span> &lt;span class="n">success&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sunrise&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sunset&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Sun rise at &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">sunrise&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">, Sun set at &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">sunset&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">failure&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failure &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="结构体struct">结构体&lt;code>struct&lt;/code>&lt;/h2>
&lt;p>&lt;code>struct&lt;/code>和类一样，支持初始化和方法，不同之处在于:&lt;/p>
&lt;p>struct在代码里总是复制一份(值传参)，而类是被引用的(引用传参)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">struct&lt;/span> &lt;span class="nc">Card&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">rank&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Rank&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">suit&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Suit&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">simpleDescription&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;The &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">rank&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="si">())&lt;/span>&lt;span class="s"> of &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">suit&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="si">())&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">//枚举传参数&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">threeOfSpades&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Card&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rank&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">three&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">suit&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">spades&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">threeOfSpades&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="protocols和extensions">Protocols和Extensions&lt;/h2>
&lt;p>有点类似&lt;code>java&lt;/code>的&lt;code>interface&lt;/code>，但是也有&lt;a href="https://stackoverflow.com/questions/30859334/compare-protocol-in-swift-vs-interface-in-java">不同之处&lt;/a>.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">protocol&lt;/span> &lt;span class="nc">ExampleProtocol&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">simpleDescription&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="kr">get&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="c1">// 注意关键字mutating&lt;/span>
&lt;span class="kr">mutating&lt;/span> &lt;span class="kd">func&lt;/span> &lt;span class="nf">adjust&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>类，枚举和结构体都可以适配协议&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">class&lt;/span> &lt;span class="nc">SimpleClass&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">ExampleProtocol&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">simpleDescription&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;A very simple class.&amp;#34;&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">anotherProperty&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">69105&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">adjust&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;span class="n">simpleDescription&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="s">&amp;#34; Now 100% adjusted.&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">a&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">SimpleClass&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">adjust&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">struct&lt;/span> &lt;span class="nc">SimpleStruct&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">ExampleProtocol&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">simpleDescription&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;A very simple struct.&amp;#34;&lt;/span>
&lt;span class="c1">//注意 mutating 关键字&lt;/span>
&lt;span class="kr">mutating&lt;/span> &lt;span class="kd">func&lt;/span> &lt;span class="nf">adjust&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;span class="n">simpleDescription&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="s">&amp;#34; (adjusted)&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">SimpleStruct&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">adjust&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>注意上面在结构体中声明&lt;code>adjust()&lt;/code>方法时，使用了关键字&lt;code>mutating&lt;/code>,而在类中并没有使用， 是因为在类中，方法是可以直接修改的。&lt;/p>
&lt;p>使用&lt;code>extension&lt;/code>可以往已经存在的类型添加方法和计算属性，哪怕是Swift内置的类&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">extension&lt;/span> &lt;span class="nc">Int&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">ExampleProtocol&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">simpleDescription&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;The number &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="kc">self&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kr">mutating&lt;/span> &lt;span class="kd">func&lt;/span> &lt;span class="nf">adjust&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;span class="kc">self&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">42&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// 修改内置Int类的行为&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">7.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>我们也可以使用protocol名字来访问实现了这个&lt;code>protocol&lt;/code>的方法，但是不在&lt;code>protocol&lt;/code>里定义的就不能访问。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">protocolValue&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">ExampleProtocol&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">SimpleClass&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">protocolValue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">simpleDescription&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">//anotherProperty属性虽然在SimpleClass里有，但是它不属于ExampleProtocol, protocolValue访问依然会报错&lt;/span>
&lt;span class="c1">//print(protocolValue.anotherProperty)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="异常处理">异常处理&lt;/h2>
&lt;p>可以通过适配&lt;code>Error&lt;/code>的protocol来定义错误， 通过&lt;code>throw&lt;/code>抛出异常，通过&lt;code>throws&lt;/code>标记可能产生异常的方法。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">enum&lt;/span> &lt;span class="nc">PrinterError&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Error&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">outOfPaper&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">noToner&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">onFire&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">unKown&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">job&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">toPrinter&lt;/span> &lt;span class="n">printerName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kr">throws&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">printerName&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;Never Has Toner&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">throw&lt;/span> &lt;span class="n">PrinterError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">noToner&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">printerName&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;outOfPaper&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">throw&lt;/span> &lt;span class="n">PrinterError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">outOfPaper&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">printerName&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;OnFire&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">throw&lt;/span> &lt;span class="n">PrinterError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">onFire&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">printerName&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;UnKown&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">throw&lt;/span> &lt;span class="n">PrinterError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">unKown&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;job sent&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>有几种方式处理异常，一种是使用&lt;code>do-catch&lt;/code>, &lt;code>try&lt;/code>写在可能产生异常的代码前面，&lt;code>catch&lt;/code>代码块里，如果不指定名字的话，默认用&lt;code>error&lt;/code>代表错误。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="k">do&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">printerResponse&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">try&lt;/span> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">job&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1040&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">toPrinter&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Never Has Toner&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">printerResponse&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">catch&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">error&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">do&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">printerResponse&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">try&lt;/span> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">job&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1440&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">toPrinter&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;UnKown&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">printerResponse&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">catch&lt;/span> &lt;span class="n">PrinterError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">onFire&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;I&amp;#39;ll just put this over here, with the rest of the fire.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">catch&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">printerError&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">PrinterError&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Printer error: &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">printerError&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">catch&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">error&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>另一种处理异常的方式是使用&lt;code>try?&lt;/code>。把结果转变为可选值，当有异常出现的时候，异常会被直接忽略，并把结果赋值为&lt;code>nil&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">printerSuccess&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">try&lt;/span>&lt;span class="p">?&lt;/span> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">job&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1884&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">toPrinter&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Mergenthaler&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">printerFailure&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">try&lt;/span>&lt;span class="p">?&lt;/span> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">job&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1885&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">toPrinter&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Never Has Toner&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用&lt;code>defer&lt;/code>，可以在函数返回前，执行一段代码，无论函数是正常执行或抛出异常，可以在多个函数之间使用&lt;code>defer&lt;/code>写一些初始化或清理工作的代码。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">fridgeIsOpen&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">fridgeContent&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;milk&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;eggs&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;leftovers&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">fridgeContains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">food&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Bool&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">fridgeIsOpen&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="k">defer&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;call defer&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">fridgeIsOpen&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">fridgeContent&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">food&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">result&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">fridgeContains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;banana&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fridgeIsOpen&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="泛型">泛型&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">makeArray&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">Item&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">repeating&lt;/span> &lt;span class="n">item&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Item&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">numberOfTimes&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Item&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Item&lt;/span>&lt;span class="p">]()&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="kc">_&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mf">0.&lt;/span>&lt;span class="p">.&amp;lt;&lt;/span>&lt;span class="n">numberOfTimes&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">result&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">result&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">makeArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">repeating&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;knock&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">numberOfTimes&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>泛型不光可以用于函数和方法，还可以用在类，枚举，结构体上面，下面是利用泛型实现Swift标准库里的可选类型&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">enum&lt;/span> &lt;span class="nc">OptionalValue&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">Wrapped&lt;/span>&lt;span class="p">&amp;gt;{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="kr">none&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="n">some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Wrapped&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">possibleInteger&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">OptionalValue&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="kr">none&lt;/span>
&lt;span class="n">possibleInteger&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用&lt;code>where&lt;/code>关键字在语句前可以限定一些条件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">anyCommonElements&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Sequence&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">U&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Sequence&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">lhs&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">T&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">_&lt;/span> &lt;span class="n">rhs&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">U&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Bool&lt;/span>
&lt;span class="k">where&lt;/span> &lt;span class="n">T&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Element&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Equatable&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">T&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Element&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="n">U&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Element&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">lhsItem&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">lhs&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">thsItem&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">rhs&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">lhsItem&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="n">thsItem&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">anyCommonElements&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Swift入门指南一</title><link>https://crazygit.wiseturtles.com/2018/10/27/swift-tour-001/</link><pubDate>Sat, 27 Oct 2018 09:34:03 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/10/27/swift-tour-001/</guid><description>&lt;h2 id="hello-world">Hello World&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Hello, world!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>“Hello world”的写法与&lt;code>python&lt;/code>的语法, 不需要分号结尾&lt;/p>
&lt;h2 id="常量和变量">常量和变量&lt;/h2>
&lt;p>使用&lt;code>let&lt;/code>声明常量，使用&lt;code>var&lt;/code>声明变量。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 常量let&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">maxNum&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;span class="c1">// 变量var&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">index&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">str&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Hello, playground&amp;#34;&lt;/span>
&lt;span class="c1">// 一次定义多个变量&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">x&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">3&lt;/span>
&lt;span class="c1">// 常量在编译的时候才确定它的值，但是只能赋值一次，不允许再修改&lt;/span>
&lt;span class="c1">// 如下面的常量c&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">a&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">1000&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">50&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">c&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">b&lt;/span>
&lt;span class="c1">// 指定常量类型&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">b&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;xxx&amp;#34;&lt;/span>
&lt;span class="c1">// 批量指定变量类型&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">j&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">k&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">l&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Double&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">label&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;The width is &amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">width&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">94&lt;/span>
&lt;span class="c1">// 类型转换&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">widthLabel&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">label&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 字符串格式化&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">apples&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">oranges&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">5&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">appSumary&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;I have &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">apples&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> apples.&amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">fruitSummary&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;I have &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">apples&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">oranges&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s"> pieces of fruit&amp;#34;&lt;/span>
&lt;span class="c1">// 使用三引号（&amp;#34;&amp;#34;&amp;#34;）可以起到一次使用跨行声明变量&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">a&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;span class="s">line one
&lt;/span>&lt;span class="s">line two
&lt;/span>&lt;span class="s">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="字符串">字符串&lt;/h3>
&lt;p>Swift中字符串只能使用双引号&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">str&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Hello world&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="数组和字典">数组和字典&lt;/h2>
&lt;p>与&lt;code>python&lt;/code>不同，Swift数组和字典都是用方括号表示&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 数组&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">a&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;b&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;c&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="c1">// 字典&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>
&lt;span class="s">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;crazygit&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s">&amp;#34;age&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">28&lt;/span>
&lt;span class="p">]&lt;/span>
&lt;span class="c1">// 创建元素类型为String类型的空数组&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">emptyArray&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">]()&lt;/span>
&lt;span class="c1">// 创建key为String，Value为Float类型的空字典&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">emptyDictionary&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Float&lt;/span>&lt;span class="p">]()&lt;/span>
&lt;span class="c1">// 不明确类型的&lt;/span>
&lt;span class="n">shoppingList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;span class="n">occupations&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[:]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="流程控制">流程控制&lt;/h2>
&lt;p>关键字有:&lt;/p>
&lt;p>&lt;code>if&lt;/code>, &lt;code>switch&lt;/code>, &lt;code>for-in&lt;/code>,&lt;code>while&lt;/code>, &lt;code>repeat-while&lt;/code>&lt;/p>
&lt;p>判断条件和循环变量外层的圆括号是可选的。
但是循环体外层的花括号是必须的。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">individualScore&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">43&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">103&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">87&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">teamScore&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">score&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">individualScore&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">score&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">50&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">teamScore&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">teamScore&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">teamScore&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>if&lt;/code>语句后面必须是&lt;code>Boolean&lt;/code>表达式, &lt;code>if score {}&lt;/code> 会直接报语法错误，不是像&lt;code>python&lt;/code>中暗含把&lt;code>score&lt;/code>和&lt;code>0&lt;/code>相比较。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">swift&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">error&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="k">is&lt;/span> &lt;span class="n">not&lt;/span> &lt;span class="n">convertible&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nb">Bool&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">score&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="o">^~~~~&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>变量类型后面如果有&lt;code>?&lt;/code>号， 表示变量是个可选值&lt;/p>
&lt;h3 id="if-语句">if 语句&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 可选值&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">optionalString&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">?&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Hello&amp;#34;&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">optionalString&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">optionalName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">?&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;xx&amp;#34;&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">greeting&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>
&lt;span class="c1">// 如果变量的可选值是nil，条件会判断为false，大括号中的代码会被跳过。&lt;/span>
&lt;span class="c1">// 如果不是nil，会将值赋给let后面的常量，这样代码块中就可以使用这个值了。&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">optionalName&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">greeting&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Hello, &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;else&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// 使用??可以提供一个默认值，当nickName为nil时，使用fullName&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">nickName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">?&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">fullName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;John Appleseed&amp;#34;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">informalGreeting&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Hi &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">nickName&lt;/span> &lt;span class="p">??&lt;/span> &lt;span class="n">fullName&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="switch">switch&lt;/h3>
&lt;p>switch支持&lt;strong>任意类型&lt;/strong>的数据比较操作。&lt;/p>
&lt;p>运行switch中匹配到的子句之后，程序会退出switch语句，并不会继续向下运行，所以&lt;strong>不需要&lt;/strong>在每个子句结尾写break。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">vegetable&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;red pepper&amp;#34;&lt;/span>
&lt;span class="k">switch&lt;/span> &lt;span class="n">vegetable&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;celery&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Add som raisins and make ants on a log.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;cucumber&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;watercress&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;That would make a good tea sandwich.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">x&lt;/span> &lt;span class="k">where&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">hasSuffix&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;pepper&amp;#34;&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Is is a spicy &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">?&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Everything tastes good in soup.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>注意上面&lt;code>let&lt;/code>的用法&lt;/p>
&lt;h3 id="for-in">for-in&lt;/h3>
&lt;p>在遍历字典字典数据时，遍历结果是无序的&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">let&lt;/span> &lt;span class="nv">interestingNumbers&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>
&lt;span class="s">&amp;#34;Price&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">13&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="s">&amp;#34;Fibonacci&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="s">&amp;#34;Square&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">25&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="p">]&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">largest&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">numbers&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">interestingNumbers&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">number&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">numbers&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">number&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">largest&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">largest&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">number&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">largest&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>for (_, numbers) &lt;/code>的括号不能省略&lt;/p>
&lt;h3 id="while">while&lt;/h3>
&lt;p>两种写法，一种先判断条件再执行，一种先执行再判断条件(保证至少运行一次)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 先判断再执行（不一定会执行）&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">n&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">n&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 先执行再判断（至少执行一次）&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">m&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;span class="k">repeat&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">m&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">m&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="n">m&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="for-循环">for 循环&lt;/h3>
&lt;p>&lt;code>..&amp;lt;&lt;/code>表示循环索引，不包含最大值&lt;/p>
&lt;p>&lt;code>...&lt;/code>表示循环索引，包含最大值&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">var&lt;/span> &lt;span class="nv">firstForLoop&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="c1">// 等价于for i=0; i&amp;lt;4; i++&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mf">0.&lt;/span>&lt;span class="p">.&amp;lt;&lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">firstForLoop&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">i&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">firstForLoop&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">secondForLoop&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="c1">// 等价于for i=0; i&amp;lt;=4; i++&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mf">0.&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">secondForLoop&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">i&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">secondForLoop&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="函数和闭包">函数和闭包&lt;/h3>
&lt;p>使用 &lt;code>func&lt;/code> 来声明一个函数, 使用名字和参数来调用函数。使用 &lt;code>-&amp;gt;&lt;/code> 来指定函数返回值的类型。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">// 定义一个函数&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">person&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">day&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;Hello &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">person&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">, today is &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">day&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">.&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">//调用函数&lt;/span>
&lt;span class="n">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">person&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Bob&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">day&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Tuesday&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 传入第二个参数的day标签不能省略&lt;/span>
&lt;span class="n">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Bob&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">day&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s">&amp;#34;Tuesday&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>默认情况下，函数使用参数名作为参数标签，可以在参数名前写个自定义的标签，或者使用&lt;code>_&lt;/code>来表示没有标签&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">_&lt;/span> &lt;span class="n">person&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">day&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;Hello &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">person&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">, today is &lt;/span>&lt;span class="si">\(&lt;/span>&lt;span class="n">day&lt;/span>&lt;span class="si">)&lt;/span>&lt;span class="s">.&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Bob&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">on&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Tuesday&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面&lt;code>person&lt;/code>参数没有设置参数标签， &lt;code>day&lt;/code>的参数标签是&lt;code>on&lt;/code>&lt;/p>
&lt;p>使用元祖可以返回多个值&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">caculateStatistics&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">scores&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="bp">min&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">max&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sum&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">min&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">scores&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">max&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">scores&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">sum&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">score&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">scores&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">score&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="bp">max&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">max&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">score&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">score&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="bp">min&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="bp">min&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">score&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">sum&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">score&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="bp">min&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">max&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sum&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">statistics&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">caculateStatistics&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">scores&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="c1">// 使用名称获取返回的sum&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">statistics&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sum&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// 使用下标获取返回的sum&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">statistics&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>函数可以嵌套，内部的函数可以访问外部函数定义的变量&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">returnFifteen&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">y&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">10&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">add&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;span class="n">y&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">5&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">add&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">y&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="n">returnFifteen&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>函数的返回值也可以是一个函数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="c1">//返回值是函数，注意返回值的写法&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">makeIncrementer&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">addOne&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">number&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">number&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">addOne&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">increment&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">makeIncrementer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">increment&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>函数的参数也可以是一个函数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">hasAnyMatch&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">condtion&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Bool&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Bool&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">item&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">condtion&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">lessThanTen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">number&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Bool&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">number&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">10&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">numbers&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">19&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="n">hasAnyMatch&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">numbers&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">condtion&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">lessThanTen&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>闭包的写法，闭包时可以省略掉函数名，用&lt;code>{}&lt;/code>表示，在函数体内用&lt;code>in&lt;/code>来区分参数，返回值和函数体&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="n">numbers&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">map&lt;/span>&lt;span class="p">({(&lt;/span>&lt;span class="n">number&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="k">in&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">number&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">result&lt;/span>
&lt;span class="p">})&lt;/span>
&lt;span class="c1">// 省略参数类型，返回值类型的写法&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nv">mappedNumbers&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">numbers&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="bp">map&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="n">number&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">number&lt;/span>&lt;span class="p">})&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mappedNumbers&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可变参数&lt;code>...&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="kd">func&lt;/span> &lt;span class="nf">sumOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">numbers&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">...)&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="nb">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nv">sum&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">number&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">numbers&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="n">sum&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">number&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">sum&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sumOf&lt;/span>&lt;span class="p">())&lt;/span>
&lt;span class="bp">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sumOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">numbers&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">42&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">597&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>iOS学习目标制定及开发环境搭建</title><link>https://crazygit.wiseturtles.com/2018/10/26/ios-learn-001/</link><pubDate>Fri, 26 Oct 2018 23:13:46 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/10/26/ios-learn-001/</guid><description>&lt;p>本系列是从零开始学习iOS开发的学习日记的第一篇，主要用于记录和整理学习笔记和心得，由于也是第一次学习，内容中不免有错误的地方，如有发现，欢迎指出。&lt;/p>
&lt;h2 id="学习目标">学习目标&lt;/h2>
&lt;ul>
&lt;li>经过学习，能开发出一个让自己认可的APP并发布到App Store&lt;/li>
&lt;li>习惯养成: 保证每天投入至少1个小时学习新知识&lt;/li>
&lt;/ul>
&lt;h2 id="学习资源">学习资源&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://swift.org">官网&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/swift/resources/">Swift学习官方学习资源(含文档，视频，示例代码等)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/numbbbbb/the-swift-programming-language-in-chinese">Swift官方文档中文版&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/ipader/SwiftGuide">GitHub上别人整理的Swift语言主流学习资源&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.hackingwithswift.com/">Hacking With Swift&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.imooc.com/learn/635">慕课网视频教程&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="建议学习顺序">建议学习顺序&lt;/h2>
&lt;ol>
&lt;li>阅读文档&lt;a href="https://docs.swift.org/swift-book/index.html">the swift programming language&lt;/a>，了解Swift语法&lt;/li>
&lt;li>斯坦福大学视频教程: Developing iOS 10 Apps with Swift &lt;a href="http://www.swift51.com/video/1057.html">中文字幕版&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.v2ex.com/t/457681">Developing iOS 11 Apps with Swift&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="swift安装">Swift安装&lt;/h2>
&lt;p>要学习iOS开发，前提就是要学习&lt;code>Swift&lt;/code>或&lt;code>Object-C&lt;/code>语言。就像如果要学习Android开发的话，必须先掌握 &lt;del>&lt;code>Java&lt;/code>&lt;/del> &lt;code>Kotlin&lt;/code>语言一样。&lt;/p>
&lt;p>由于现在苹果公司主推&lt;code>Swift&lt;/code>语言，所以我也选择了&lt;code>Swift&lt;/code>语言下手。&lt;code>Object-C&lt;/code>有需要的话，以后再学习了。&lt;/p>
&lt;p>Swift语言被开源后，单独放了一个&lt;a href="https://swift.org/">网站&lt;/a>上面，现在Swift不仅可以在Mac系统上运行，也可以在Linux上运行。&lt;/p>
&lt;p>根据自己的操作系统，在&lt;a href="https://swift.org/download/#releases">下载页面&lt;/a>选择合适的安装包安装即可。&lt;/p>
&lt;p>以&lt;code>macOS 10.14&lt;/code>为例，只需要在App Store商店里安装Xcode即可。&lt;/p>
&lt;h3 id="检查是否安装成功">检查是否安装成功&lt;/h3>
&lt;p>安装好以后，在终端下执行如下命令即可检查是否安装成功。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ swift -version
Apple Swift version 4.2 &lt;span class="o">(&lt;/span>swiftlang-1000.11.37.1 clang-1000.11.45.1&lt;span class="o">)&lt;/span>
Target: x86_64-apple-darwin18.0.0
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>当前学习是Swift 4.1版本，后面所有的例子也会基于这个版本。&lt;/p>
&lt;h3 id="交互模式">交互模式&lt;/h3>
&lt;p>在终端直接输入&lt;code>swift&lt;/code>，即可进入交互模式，类似在终端输入&lt;code>python&lt;/code>一样&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ swift
Welcome to Apple Swift version 4.2 &lt;span class="o">(&lt;/span>swiftlang-1000.11.37.1 clang-1000.11.45.1&lt;span class="o">)&lt;/span>. Type :help &lt;span class="k">for&lt;/span> assistance.
1&amp;gt; print&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Hello World&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
Hello World
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="swift代码格式化工具">Swift代码格式化工具&lt;/h3>
&lt;p>&lt;a href="https://github.com/Jintin/Swimat">Swimat&lt;/a>&lt;/p>
&lt;p>安装&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ brew cask install swimat
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>设置，依次打开&lt;code>系统偏好设置&lt;/code>-&amp;gt;&lt;code>扩展&lt;/code>-&amp;gt;&lt;code>Xcode&lt;/code>里勾选上&lt;code>swimat&lt;/code>,如下图所示&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/1550673424.png" alt="启动swimat">&lt;/p>
&lt;p>最后在Xcode里设置使用的&lt;code>Swimat&lt;/code>快捷键,打开&lt;code>Xcode&lt;/code>,依次找到&lt;code>Preference&lt;/code> -&amp;gt; &lt;code>Key Bindings&lt;/code> -&amp;gt; &lt;code>搜索“swimat”&lt;/code> 设置快捷键为自己喜欢的快捷键 如: &lt;code>Option + F&lt;/code>, 如下图所示:&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-10-24-Swimat-shortcut.png" alt="Swimat-shortcut">&lt;/p>
&lt;p>&lt;strong>PS&lt;/strong>:&lt;/p>
&lt;p>设置快捷键时注意当前设置框最下面的文字提示信息，如果存在快捷键冲突，它会有提示&lt;/p>
&lt;h3 id="xcode包管理工具">Xcode包管理工具&lt;/h3>
&lt;p>&lt;a href="http://alcatraz.io/">alcatraz&lt;/a>&lt;/p>
&lt;p>安装&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -fsSL https://raw.githubusercontent.com/supermarin/Alcatraz/deploy/Scripts/install.sh &lt;span class="p">|&lt;/span> sh
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Elasticsearch快速入门</title><link>https://crazygit.wiseturtles.com/2018/04/11/elasticsearch-getting-started/</link><pubDate>Wed, 11 Apr 2018 18:15:39 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/04/11/elasticsearch-getting-started/</guid><description>&lt;h1 id="elasticsearch快速入门httpswwwelasticcoguideenelasticsearchreferencecurrentgetting-startedhtml">&lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started.html">Elasticsearch快速入门&lt;/a>&lt;/h1>
&lt;p>当前使用版本: 6.2&lt;/p>
&lt;h2 id="基本概念httpswwwelasticcoguideenelasticsearchreferencecurrent_basic_conceptshtml">&lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/_basic_concepts.html">基本概念&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Near Realtime (NRT)&lt;/p>
&lt;p>实时搜索，创建文档的索引后无需等待，立刻就可以开始搜索&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Cluster&lt;/p>
&lt;p>集群，一个集群可以包含多个节点。需要注意的是集群名字很重要，在同一个网络环境中，节点会自动加入相同集群名的集群。&lt;/p>
&lt;/li>
&lt;/ul>
&lt;ul>
&lt;li>
&lt;p>Node&lt;/p>
&lt;p>节点，每个节点都有自己的名字，它作为集群的一个单元，拥有数据存储和提供搜索能力等功能。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Index&lt;/p>
&lt;p>索引(Index)是一系列文档(Document)的集合, 索引名全部必须小写，一个集群里可以有任意多个索引。类似关系型数据库中的DB。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Type&lt;/p>
&lt;p>类似关系型数据库中的Table， 从Elasticsearch 6.0.0, 一个Index里只允许创建一个Type。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Document&lt;/p>
&lt;p>文档，存储的最小单元,类似关系型数据库中的Row。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Shards &amp;amp; Replicas&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="安装">安装&lt;/h2>
&lt;p>本文主要介绍使用docker的安装的方式，主要有三种格式的镜像&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 基本版本(默认版本)，包含X-pack的基本特性和免费证书&lt;/span>
$ docker pull docker.elastic.co/elasticsearch/elasticsearch:6.2.3
&lt;span class="c1"># platinum版本，包含X-pack的全部特性和30天试用证书&lt;/span>
$ docker pull docker.elastic.co/elasticsearch/elasticsearch-platinum:6.2.3
&lt;span class="c1"># oss版本，不包含X-pack，只有开源的Elasticsearch&lt;/span>
$ docker pull docker.elastic.co/elasticsearch/elasticsearch-oss:6.2.3
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>选择使用oss版本&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 安装&lt;/span>
$ docker pull docker.elastic.co/elasticsearch/elasticsearch-oss:6.2.3
&lt;span class="c1"># 启动服务&lt;/span>
$ docker run -p 9200:9200 -p 9300:9300 -e &lt;span class="s2">&amp;#34;cluster.name=mycluster&amp;#34;&lt;/span> -e &lt;span class="s2">&amp;#34;node.name=my_node&amp;#34;&lt;/span> docker.elastic.co/elasticsearch/elasticsearch-oss:6.2.3
&lt;span class="c1"># 检查启动的服务&lt;/span>
$ curl localhost:9200
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;my_node&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cluster_name&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;mycluster&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cluster_uuid&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;e4xwigyJQp-Er6ZJeIg1wg&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;version&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;number&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;6.2.3&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;build_hash&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;c59ff00&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;build_date&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;2018-03-13T10:06:29.741383Z&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;build_snapshot&amp;#34;&lt;/span> : false,
&lt;span class="s2">&amp;#34;lucene_version&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;7.2.1&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;minimum_wire_compatibility_version&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;5.6.0&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;minimum_index_compatibility_version&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;5.0.0&amp;#34;&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;tagline&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;You Know, for Search&amp;#34;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="探索集群">探索集群&lt;/h2>
&lt;p>集群健康状态检查&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl &lt;span class="s2">&amp;#34;localhost:9200/_cat/health?v&amp;#34;&lt;/span>
epoch timestamp cluster status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent
&lt;span class="m">1523427762&lt;/span> 06:22:42 mycluster green &lt;span class="m">1&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> - 100.0%
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>节点信息检查&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl &lt;span class="s2">&amp;#34;localhost:9200/_cat/nodes?v&amp;#34;&lt;/span>
ip heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name
172.17.0.2 &lt;span class="m">11&lt;/span> &lt;span class="m">91&lt;/span> &lt;span class="m">2&lt;/span> 0.00 0.03 0.04 mdi * my_node
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="列出所有索引信息">列出所有索引信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl &lt;span class="s2">&amp;#34;localhost:9200/_cat/indices?v&amp;#34;&lt;/span>
health status index uuid pri rep docs.count docs.deleted store.size pri.store.size
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="创建索引">创建索引&lt;/h3>
&lt;p>创建名为&lt;code>customer&lt;/code>的索引&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -X PUT &lt;span class="s2">&amp;#34;localhost:9200/customer?pretty&amp;#34;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;acknowledged&amp;#34;&lt;/span> : true,
&lt;span class="s2">&amp;#34;shards_acknowledged&amp;#34;&lt;/span> : true,
&lt;span class="s2">&amp;#34;index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>
&lt;span class="o">}&lt;/span>
$ curl &lt;span class="s2">&amp;#34;localhost:9200/_cat/indices?v&amp;#34;&lt;/span>
health status index uuid pri rep docs.count docs.deleted store.size pri.store.size
yellow open customer ltwryTbDSUy2mKATPJ2adA &lt;span class="m">5&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> 1.1kb 1.1kb
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="创建文档">创建文档&lt;/h3>
&lt;p>在&lt;code>customer&lt;/code>索引里，创建ID为1的文档。
注意: 加入索引不存在，elasticearch会自动创建索引。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XPUT &lt;span class="s1">&amp;#39;localhost:9200/customer/_doc/1?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;name&amp;#34;: &amp;#34;John Doe&amp;#34;
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;created&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 0,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : &lt;span class="m">1&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="c1"># 查看创建的结果&lt;/span>
$ curl &lt;span class="s1">&amp;#39;localhost:9200/customer/_doc/1?pretty&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;found&amp;#34;&lt;/span> : true,
&lt;span class="s2">&amp;#34;_source&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;John Doe&amp;#34;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="删除索引">删除索引&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -X DELETE &lt;span class="s1">&amp;#39;localhost:9200/customer?pretty&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;acknowledged&amp;#34;&lt;/span> : &lt;span class="nb">true&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="修改数据">修改数据&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># 创建一个文档&lt;/span>
$ curl -XPUT &lt;span class="s1">&amp;#39;localhost:9200/customer/_doc/1?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;name&amp;#34;: &amp;#34;John Doe&amp;#34;
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;created&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 0,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : &lt;span class="m">1&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="c1"># 修改文档&lt;/span>
$ curl -XPUT &lt;span class="s1">&amp;#39;localhost:9200/customer/_doc/1?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;name&amp;#34;: &amp;#34;xxxxx&amp;#34;
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;updated&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : &lt;span class="m">1&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="c1">## 通过POST方法，在创建文档时可以不用指定文档的id， elasticsearch会自动生成一个&lt;/span>
$ curl -XPOST &lt;span class="s1">&amp;#39;localhost:9200/customer/_doc?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;name&amp;#34;: &amp;#34;Jane Doe&amp;#34;
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;Umx0s2IBV3QZ-G3Zdj0c&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;created&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 0,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : &lt;span class="m">1&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="更新文档">更新文档&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XPOST &lt;span class="s1">&amp;#39;localhost:9200/customer/_doc/1/_update?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;doc&amp;#34;: { &amp;#34;name&amp;#34;: &amp;#34;Jane Doe&amp;#34; }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 3,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;updated&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : &lt;span class="m">1&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="删除文档">删除文档&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XDELETE &lt;span class="s1">&amp;#39;localhost:9200/customer/_doc/2?pretty&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;2&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;not_found&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 0,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : &lt;span class="m">1&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="批量处理">批量处理&lt;/h3>
&lt;p>同时创建两个文档&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XPOST &lt;span class="s1">&amp;#39;localhost:9200/customer/_doc/_bulk?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{&amp;#34;index&amp;#34;:{&amp;#34;_id&amp;#34;:&amp;#34;1&amp;#34;}}
&lt;/span>&lt;span class="s1">{&amp;#34;name&amp;#34;: &amp;#34;John Doe&amp;#34; }
&lt;/span>&lt;span class="s1">{&amp;#34;index&amp;#34;:{&amp;#34;_id&amp;#34;:&amp;#34;2&amp;#34;}}
&lt;/span>&lt;span class="s1">{&amp;#34;name&amp;#34;: &amp;#34;Jane Doe&amp;#34; }
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;took&amp;#34;&lt;/span> : 14,
&lt;span class="s2">&amp;#34;errors&amp;#34;&lt;/span> : false,
&lt;span class="s2">&amp;#34;items&amp;#34;&lt;/span> : &lt;span class="o">[&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;index&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 4,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;updated&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 3,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;status&amp;#34;&lt;/span> : &lt;span class="m">200&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;index&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;2&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;created&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;status&amp;#34;&lt;/span> : &lt;span class="m">201&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">]&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>更新和删除文档&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XPOST &lt;span class="s1">&amp;#39;localhost:9200/customer/_doc/_bulk?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{&amp;#34;update&amp;#34;:{&amp;#34;_id&amp;#34;:&amp;#34;1&amp;#34;}}
&lt;/span>&lt;span class="s1">{&amp;#34;doc&amp;#34;: { &amp;#34;name&amp;#34;: &amp;#34;John Doe becomes Jane Doe&amp;#34; } }
&lt;/span>&lt;span class="s1">{&amp;#34;delete&amp;#34;:{&amp;#34;_id&amp;#34;:&amp;#34;2&amp;#34;}}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;took&amp;#34;&lt;/span> : 20,
&lt;span class="s2">&amp;#34;errors&amp;#34;&lt;/span> : false,
&lt;span class="s2">&amp;#34;items&amp;#34;&lt;/span> : &lt;span class="o">[&lt;/span>
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;update&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 5,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;updated&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 4,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;status&amp;#34;&lt;/span> : &lt;span class="m">200&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;delete&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;_index&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;customer&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_type&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;_doc&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_id&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;2&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_version&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;result&amp;#34;&lt;/span> : &lt;span class="s2">&amp;#34;deleted&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;_shards&amp;#34;&lt;/span> : &lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;total&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;successful&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span> : &lt;span class="m">0&lt;/span>
&lt;span class="o">}&lt;/span>,
&lt;span class="s2">&amp;#34;_seq_no&amp;#34;&lt;/span> : 2,
&lt;span class="s2">&amp;#34;_primary_term&amp;#34;&lt;/span> : 1,
&lt;span class="s2">&amp;#34;status&amp;#34;&lt;/span> : &lt;span class="m">200&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="o">]&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>当批量操作时，如果某个操作失败，后面的操作仍然会继续执行，并且根据执行顺序，依次返回每个操作的执行状态。&lt;/p>
&lt;h2 id="探索数据">探索数据&lt;/h2>
&lt;p>在了解了基本操作之后，让我们来多添加一些数据，做一些数据分析的工作。&lt;/p>
&lt;p>下载测试用的数据集&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ wget &lt;span class="s2">&amp;#34;https://github.com/elastic/elasticsearch/blob/master/docs/src/test/resources/accounts.json?raw=true&amp;#34;&lt;/span> -O accounts.json
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>导入数据&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -H &lt;span class="s2">&amp;#34;Content-Type: application/json&amp;#34;&lt;/span> -XPOST &lt;span class="s2">&amp;#34;localhost:9200/bank/_doc/_bulk?pretty&amp;amp;refresh&amp;#34;&lt;/span> --data-binary &lt;span class="s2">&amp;#34;@accounts.json&amp;#34;&lt;/span>
$ curl &lt;span class="s2">&amp;#34;localhost:9200/_cat/indices?v&amp;#34;&lt;/span>
health status index uuid pri rep docs.count docs.deleted store.size pri.store.size
yellow open bank EnHJEWvLRv2tZLoI7Z_lXw &lt;span class="m">5&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="m">1000&lt;/span> &lt;span class="m">0&lt;/span> 474.7kb 474.7kb
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="查询数据">查询数据&lt;/h3>
&lt;p>查询数据，主要有两种方式：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.2/search-uri-request.html">REST request URI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.2/search-request-body.html">REST request body&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>后者跟前者比，可以执行更复杂的操作，查询体也是json格式，便于阅读。前者主要是使用起来更加方便。&lt;/p>
&lt;p>比如:&lt;/p>
&lt;p>使用&lt;code>request URI&lt;/code>的格式&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl &lt;span class="s2">&amp;#34;http://localhost:9200/bank/_search?q=*&amp;amp;sort=account_number:asc&amp;amp;pretty&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用&lt;code>request body&lt;/code>的格式&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match_all&amp;#34;: {} },
&lt;/span>&lt;span class="s1"> &amp;#34;sort&amp;#34;: [
&lt;/span>&lt;span class="s1"> { &amp;#34;account_number&amp;#34;: &amp;#34;asc&amp;#34; }
&lt;/span>&lt;span class="s1"> ]
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="查询语法">查询语法&lt;/h3>
&lt;p>Elasticsearch提供了一个类似json格式的查询语法，叫做&lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.2/query-dsl.html">Query DSL&lt;/a>。&lt;/p>
&lt;p>限定返回查询结果的个数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match_all&amp;#34;: {} },
&lt;/span>&lt;span class="s1"> &amp;#34;size&amp;#34;: 1
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>分页效果&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match_all&amp;#34;: {} },
&lt;/span>&lt;span class="s1"> &amp;#34;from&amp;#34;: 10,
&lt;/span>&lt;span class="s1"> &amp;#34;size&amp;#34;: 10
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>排序&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match_all&amp;#34;: {} },
&lt;/span>&lt;span class="s1"> &amp;#34;sort&amp;#34;: { &amp;#34;balance&amp;#34;: { &amp;#34;order&amp;#34;: &amp;#34;desc&amp;#34; } }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="执行查询">执行查询&lt;/h3>
&lt;p>默认情况下，查询返回的&lt;code>_source&lt;/code>会包含所有的字段，我们也可以限制返回某些我们关心的字段&lt;/p>
&lt;p>只返回&lt;code>account_number&lt;/code>和&lt;code>balance&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match_all&amp;#34;: {} },
&lt;/span>&lt;span class="s1"> &amp;#34;_source&amp;#34;: [&amp;#34;account_number&amp;#34;, &amp;#34;balance&amp;#34;]
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="match_all">match_all&lt;/h4>
&lt;p>返回所有结果，没有查询条件限制&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match_all&amp;#34;: {} },
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="match">match&lt;/h4>
&lt;p>限定查询条件，返回&lt;code>account_number&lt;/code>为20的结果&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match&amp;#34;: { &amp;#34;account_number&amp;#34;: 20 } }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查询&lt;code>address&lt;/code>里包含&lt;code>mill&lt;/code>的结果（不区分大小写）&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;mill&amp;#34; } }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查询&lt;code>address&lt;/code>里包含&lt;code>mill&lt;/code>或&lt;code>lane&lt;/code>的记录（不区分大小写)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;mill lane&amp;#34; } }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="match_phrase">match_phrase&lt;/h4>
&lt;p>查询&lt;code>address&lt;/code>里包含&lt;code>mill&lt;/code>和&lt;code>lane&lt;/code>的记录（不区分大小写)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: { &amp;#34;match_phrase&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;mill lane&amp;#34; } }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="bool-must">bool must&lt;/h4>
&lt;p>返回&lt;code>address&lt;/code>包含&lt;code>mill&lt;/code>和&lt;code>lane&lt;/code>的结果，与上面的&lt;code>match_phrase&lt;/code>效果一样&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;bool&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;must&amp;#34;: [
&lt;/span>&lt;span class="s1"> { &amp;#34;match&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;mill&amp;#34; } },
&lt;/span>&lt;span class="s1"> { &amp;#34;match&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;lane&amp;#34; } }
&lt;/span>&lt;span class="s1"> ]
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="bool-should">bool should&lt;/h4>
&lt;p>返回&lt;code>address&lt;/code>包含&lt;code>mill&lt;/code>或&lt;code>lane&lt;/code>的结果，与&lt;code>{&amp;quot;match&amp;quot;: { &amp;quot;address&amp;quot;: &amp;quot;mill lane&amp;quot;}&lt;/code>效果一样&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;bool&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;should&amp;#34;: [
&lt;/span>&lt;span class="s1"> { &amp;#34;match&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;mill&amp;#34; } },
&lt;/span>&lt;span class="s1"> { &amp;#34;match&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;lane&amp;#34; } }
&lt;/span>&lt;span class="s1"> ]
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="bool-must_not">bool must_not&lt;/h4>
&lt;p>返回&lt;code>address&lt;/code>包即不包含&lt;code>mill&lt;/code>，也不包含&lt;code>lane&lt;/code>的结果&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;bool&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;must_not&amp;#34;: [
&lt;/span>&lt;span class="s1"> { &amp;#34;match&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;mill&amp;#34; } },
&lt;/span>&lt;span class="s1"> { &amp;#34;match&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;lane&amp;#34; } }
&lt;/span>&lt;span class="s1"> ]
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="组合">组合&lt;/h4>
&lt;p>bool的多个条件还可以相互组合&lt;/p>
&lt;p>返回&lt;code>age=40&lt;/code>并且&lt;code>state!=ID&lt;/code>的结果&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;bool&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;must&amp;#34;: [
&lt;/span>&lt;span class="s1"> { &amp;#34;match&amp;#34;: { &amp;#34;age&amp;#34;: &amp;#34;40&amp;#34; } }
&lt;/span>&lt;span class="s1"> ],
&lt;/span>&lt;span class="s1"> &amp;#34;must_not&amp;#34;: [
&lt;/span>&lt;span class="s1"> { &amp;#34;match&amp;#34;: { &amp;#34;state&amp;#34;: &amp;#34;ID&amp;#34; } }
&lt;/span>&lt;span class="s1"> ]
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="过滤filter">过滤(Filter)&lt;/h3>
&lt;p>过滤出&lt;code>20000&amp;lt;balance&amp;lt;30000&lt;/code>的结果&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;query&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;bool&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;must&amp;#34;: { &amp;#34;match_all&amp;#34;: {} },
&lt;/span>&lt;span class="s1"> &amp;#34;filter&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;range&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;balance&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;gte&amp;#34;: 20000,
&lt;/span>&lt;span class="s1"> &amp;#34;lte&amp;#34;: 30000
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="聚合aggregations">聚合(Aggregations)&lt;/h3>
&lt;p>设置&lt;code>size=0&lt;/code>是因为我们只关心聚合后的结果&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;size&amp;#34;: 0,
&lt;/span>&lt;span class="s1"> &amp;#34;aggs&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;group_by_state&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;terms&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;field&amp;#34;: &amp;#34;state.keyword&amp;#34;
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面的语句等价于&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="k">SELECT&lt;/span> &lt;span class="k">state&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">COUNT&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">FROM&lt;/span> &lt;span class="n">bank&lt;/span> &lt;span class="k">GROUP&lt;/span> &lt;span class="k">BY&lt;/span> &lt;span class="k">state&lt;/span> &lt;span class="k">ORDER&lt;/span> &lt;span class="k">BY&lt;/span> &lt;span class="k">COUNT&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">DESC&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>聚合嵌套&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ curl -XGET &lt;span class="s1">&amp;#39;localhost:9200/bank/_search?pretty&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;Content-Type: application/json&amp;#39;&lt;/span> -d&lt;span class="s1">&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;size&amp;#34;: 0,
&lt;/span>&lt;span class="s1"> &amp;#34;aggs&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;group_by_state&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;terms&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;field&amp;#34;: &amp;#34;state.keyword&amp;#34;
&lt;/span>&lt;span class="s1"> },
&lt;/span>&lt;span class="s1"> &amp;#34;aggs&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;average_balance&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;avg&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;field&amp;#34;: &amp;#34;balance&amp;#34;
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="eleasticsearch安装及配置httpswwwelasticcoguideenelasticsearchreferencecurrentsetuphtml">&lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/setup.html">Eleasticsearch安装及配置&lt;/a>&lt;/h2>
&lt;p>&lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/setup.html">官方文档&lt;/a>详细介绍了各种安装Elasticsearch的方法，以及如何配置Elasticsearch。另外，
还介绍了将Elasticsearch迁移到生产环境时，需要关注的配置项等。&lt;/p>
&lt;h2 id="docker-composeyml">docker-compose.yml&lt;/h2>
&lt;p>使用&lt;code>docker compose&lt;/code>, 可以很方便的在本机创建一个关于elastic stack小集群， 对于开发和测试非常方便。
使用下面的&lt;code>docker-compose.yml&lt;/code>文件，通过&lt;code>docker compose&lt;/code>命令，可以在本地直接运行&lt;code>elasticsearch&lt;/code>和&lt;code>kibana&lt;/code>服务，&lt;code>kibana&lt;/code>里开发工具的&lt;code>Console&lt;/code>可以很方便的和&lt;code>elasticsearch&lt;/code>交互。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;3&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">elasticsearch&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">docker.elastic.co/elasticsearch/elasticsearch-oss:6.2.3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">elasticsearch&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;9200:9200&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;9300:9300&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">cluster.name=docker-cluster&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">bootstrap.memory_lock=true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">http.host=0.0.0.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">transport.host=127.0.0.1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;ES_JAVA_OPTS=-Xms512m -Xmx512m&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ulimits&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">memlock&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">soft&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>-&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hard&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>-&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">es_data:/usr/share/elasticsearch/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">esnet&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">kibana&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">docker.elastic.co/kibana/kibana-oss:6.2.3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kibana&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">SERVER_NAME&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kibana-server&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ELASTICSEARCH_URL&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">http://elasticsearch:9200&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">esnet&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">depends_on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">elasticsearch&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;5601:5601&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">es_data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">driver&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">local&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">esnet&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>关于集成更多elastic stack服务，可以参考:
&lt;a href="https://github.com/elastic/stack-docker/blob/master/docker-compose.yml">https://github.com/elastic/stack-docker/blob/master/docker-compose.yml&lt;/a>&lt;/p>
&lt;p>kibana Console运行效果如下：&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-04-12-kibana-devtool.png" alt="kibana console">&lt;/p></description></item><item><title>工银亚洲开户攻略</title><link>https://crazygit.wiseturtles.com/2018/03/09/icbcasia/</link><pubDate>Fri, 09 Mar 2018 22:21:02 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/03/09/icbcasia/</guid><description>&lt;h2 id="开户必读">开户必读&lt;/h2>
&lt;p>申请之前，建议阅读&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.icbc.com.cn/ICBC/%E4%B8%AA%E4%BA%BA%E9%87%91%E8%9E%8D/%E4%B8%AA%E4%BA%BA%E6%9C%8D%E5%8A%A1/%E8%B7%A8%E5%A2%83%E9%87%91%E8%9E%8D/%E5%A2%83%E5%A4%96%E9%87%91%E8%9E%8D%E6%9C%8D%E5%8A%A1/%E5%B7%A5%E9%93%B6%E4%BA%9A%E6%B4%B2/">见证开立工银亚洲账户常见问题&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.icbcasia.com/ICBC/%E6%B5%B7%E5%A4%96%E5%88%86%E8%A1%8C/%E5%B7%A5%E9%93%B6%E4%BA%9A%E6%B4%B2/CN/%E4%B8%AA%E4%BA%BA%E9%87%91%E8%9E%8D/%E4%BA%BA%E6%B0%91%E5%B8%81%E5%8F%8A%E8%B7%A8%E5%A2%83%E7%90%86%E8%B4%A2/%E5%86%85%E5%9C%B0%E5%AE%A2%E6%88%B7%E6%9C%8D%E5%8A%A1%E4%B8%93%E5%8C%BA/retailfaq.htm">开立工银亚洲账户常见问题&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>工银亚洲账户分综合账户和理财账户的两种，它们之间的区别，以及支持的币种，费用等问题，里面都有答案了。&lt;/p>
&lt;h2 id="准备工作">准备工作&lt;/h2>
&lt;p>下面内容摘录自上面的文件&lt;/p>
&lt;h3 id="国内开户">国内开户&lt;/h3>
&lt;p>您无须前往香港，即可通过指定的境内工行网点，见证签署相关文件，代理开立工银亚洲的「理财金账户」或「综合账户」。在所有资料齐全有效的情况下，最快将于一周内完成代理开户手续。&lt;/p>
&lt;p>适用对象：年满18周岁的境内居民&lt;/p>
&lt;p>办理开户见证所需文件:&lt;/p>
&lt;ol>
&lt;li>境内居民本人有效身份证件&lt;/li>
&lt;li>港澳通行证或护照（有效签注三个月以上）&lt;/li>
&lt;li>住址证明：最近三个月内由政府机构或公共事务机构发出的列有客户姓名及地址资料的账单或者信函。如有效身份证上地址可显示客户当前的居住地址，则居住住址证明文件可不用提供。&lt;/li>
&lt;/ol>
&lt;p>另外，在前往境内工行网点办理正式见证手续之前，您可以预先登录工银亚洲门户网站，通过网上在线填单预先填写申请表格。&lt;/p>
&lt;p>网上在线开户请点击：&lt;a href="https://myebankasia.icbc.com.cn/icbc/abroadperbank/apply/MHApplyForward.jsp?areaCode=0110&amp;amp;dse_locale=zh-CN">在线申请及查询&lt;/a>&lt;/p>
&lt;p>有关工银亚洲开户见证服务详情及常见问题请进入&lt;strong>工行网站首页 &amp;gt; 个人业务 &amp;gt; 个人金融 &amp;gt; 个人服务 &amp;gt; 跨境金融 &amp;gt; 代理开户见证业务 &amp;gt; 工银亚洲（香港）开户见证服务&lt;/strong>，即可查询。&lt;/p>
&lt;p>境内代理工银亚洲开户见证服务网点名单: &lt;a href="http://www.icbc.com.cn/SiteCollectionDocuments/ICBC/Resources/ICBC/grjr/download/2014/khjzslwd20140520.xls?bcsi_scan_DDA438331875F113=0&amp;amp;bcsi_scan_filename=khjzslwd20140520.xls">工银亚洲开户见证业务受理网点&lt;/a>。&lt;/p>
&lt;h3 id="香港柜面开户">香港柜面开户&lt;/h3>
&lt;p>您也可以选择亲临工银亚洲位于香港的分行柜面办理开户手续。开户所需文件同开户见证服务。&lt;/p>
&lt;p>工银亚洲网点地址查询：请登录工银亚洲网站&lt;a href="http://www.icbcasia.com">http://www.icbcasia.com&lt;/a>, 在网页最底部“联系我们”，点击“分行网络”，即可查询到工银亚洲的所有网点信息。&lt;/p>
&lt;h2 id="我的申请过程">我的申请过程&lt;/h2>
&lt;h3 id="开户网点选择">开户网点选择&lt;/h3>
&lt;p>首先需要说明的是: 并不是所有的工商银行网点都可以办理工银亚洲开户业务。可以下载表格&lt;a href="http://www.icbc.com.cn/SiteCollectionDocuments/ICBC/Resources/ICBC/grjr/download/2014/khjzslwd20140520.xls?bcsi_scan_DDA438331875F113=0&amp;amp;bcsi_scan_filename=khjzslwd20140520.xls">工银亚洲开户见证业务受理网点&lt;/a>,
从中选择一个自己比较方便去的网点办理。&lt;/p>
&lt;h3 id="线上申请">线上申请&lt;/h3>
&lt;p>首先&lt;a href="https://myebankasia.icbc.com.cn/icbc/abroadperbank/apply/MHApplyForward.jsp?areaCode=0110&amp;amp;dse_locale=zh-CN">在线申请&lt;/a>, 提交表格后。便可以去开户网点进行办理。&lt;/p>
&lt;p>&lt;strong>PS&lt;/strong>: 我线上申请后，到了开户网点发现在线申请的表格根本不能用，必须按照网点提供的模板来填写。所以如果可以的话，最好去开户网点先问一下。&lt;/p>
&lt;h3 id="网点办理">网点办理&lt;/h3>
&lt;p>准备好如下证件:&lt;/p>
&lt;ul>
&lt;li>境内居民本人有效身份证件&lt;/li>
&lt;li>港澳通行证或护照（有效签注三个月以上）&lt;/li>
&lt;li>住址证明：最近三个月内由政府机构或公共事务机构发出的列有客户姓名及地址资料的账单或者信函。如有效身份证上地址可显示客户当前的居住地址，则居住住址证明文件可不用提供。(&lt;strong>注意&lt;/strong>: 后面审核通过后，工行亚洲银行卡的银行卡就会邮寄到这个地址，所以最好确保填写的地址可以收到信件)&lt;/li>
&lt;/ul>
&lt;p>去网点填写申请表后，会拿到一个密码器和三个密码函，密码函里分别是网上银行，电话理财，借记卡的初始密码。&lt;/p>
&lt;h3 id="等待资料审核">等待资料审核&lt;/h3>
&lt;p>审核的过程还是比较严格的，我的申请表格被打回来一次，原因就是因为填写的住址地址和身份证上写的有一点小区别。导致我又重新去网点重新提交了一次申请表。&lt;/p>
&lt;h3 id="电话确认">电话确认&lt;/h3>
&lt;p>提交申请表，大概过了一周的样子，就收到工行打来的电话确认，会问一些开户时提交的资料问题: 如证件号，手机号，地址等。电话确认过后，又是等待资料审核。&lt;/p>
&lt;h3 id="密码器激活">密码器激活&lt;/h3>
&lt;p>电话确认过后，又过了一周多的时间。手机收到了工银亚洲提示开户成功的短信，并有一个激活码, 这激活码是用于激活之前领到的密码器的。&lt;/p>
&lt;h3 id="账户激活">账户激活&lt;/h3>
&lt;p>需要从国内同名的工行卡汇款至工银亚洲账户，才能激活账号。激活主要分两步骤：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>购汇&lt;/p>
&lt;p>使用工商银行APP，搜索“结售汇”功能。可以根据当前的汇率，选择购买美元或港币。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>境外汇款&lt;/p>
&lt;p>通过境外转账业务，将购买的美元或港币，转至工银亚洲账户。&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>激活步骤完成。&lt;/p>
&lt;h3 id="借记卡激活">借记卡激活&lt;/h3>
&lt;p>借记卡是在收到短信激活码后才寄出的，查询借记卡寄送进度:&lt;/p>
&lt;p>可拨打95588 转7-7-2-1查询借记卡寄件编号，再按以下任一种方式查询:&lt;/p>
&lt;ol>
&lt;li>中国邮政邮件查询网址：&lt;a href="http://yjcx.chinapost.com.cn/">http://yjcx.chinapost.com.cn/&lt;/a>&lt;/li>
&lt;li>中国邮政查询电话：11185 按8 选2 进入人工查询&lt;/li>
&lt;li>短信查询：编辑短信内容“YTCX+约投挂号信函邮件号码（含字母‘NE’）”发送到11185，11185会以短信的形式告知客户当前的邮寄状态。&lt;/li>
&lt;/ol>
&lt;p>收到借记卡后，根据在网点拿到的密码函里的初始密码，在境内工行ATM机办理一笔查询/取款交易即可启用卡片。&lt;/p>
&lt;p>最后，祝大家顺利办到工银亚洲卡。&lt;/p></description></item><item><title>docker常用命令</title><link>https://crazygit.wiseturtles.com/2018/02/12/docker-commands/</link><pubDate>Mon, 12 Feb 2018 22:21:02 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/02/12/docker-commands/</guid><description>&lt;h3 id="install-docker-on-mac">Install docker on mac&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ brew cask install docker
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="get-docker-info">Get docker info&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker --version
Docker version 17.12.0-ce, build c97c6d6
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker-compose --version
docker-compose version 1.18.0, build 8dd22a9
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker-machine --version
docker-machine version 0.13.0, build 9ba6da9
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker version
Client:
Version: 17.12.0-ce
API version: 1.35
Go version: go1.9.2
Git commit: c97c6d6
Built: Wed Dec &lt;span class="m">27&lt;/span> 20:03:51 &lt;span class="m">2017&lt;/span>
OS/Arch: darwin/amd64
Server:
Engine:
Version: 17.12.0-ce
API version: 1.35 &lt;span class="o">(&lt;/span>minimum version 1.12&lt;span class="o">)&lt;/span>
Go version: go1.9.2
Git commit: c97c6d6
Built: Wed Dec &lt;span class="m">27&lt;/span> 20:12:29 &lt;span class="m">2017&lt;/span>
OS/Arch: linux/amd64
Experimental: &lt;span class="nb">true&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="basic-commands">Basic commands&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># List Docker CLI commands&lt;/span>
docker
docker container --help
&lt;span class="c1"># Display Docker version and info&lt;/span>
docker --version
docker version
docker info
&lt;span class="c1"># Excecute Docker image&lt;/span>
docker run hello-world
&lt;span class="c1"># List Docker images&lt;/span>
docker image ls
&lt;span class="c1"># List Docker containers (running, all, all in quiet mode)&lt;/span>
docker container ls
docker container ls -all
docker container ls -a -q
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="docker-image-and-container-command">Docker image and container command&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker build -t friendlyhello . &lt;span class="c1"># Create image using this directory&amp;#39;s Dockerfile&lt;/span>
docker run -p 4000:80 friendlyhello &lt;span class="c1"># Run &amp;#34;friendlyname&amp;#34; mapping port 4000 to 80&lt;/span>
docker run -d -p 4000:80 friendlyhello &lt;span class="c1"># Same thing, but in detached mode&lt;/span>
docker container ls &lt;span class="c1"># List all running containers&lt;/span>
docker container ls -a &lt;span class="c1"># List all containers, even those not running&lt;/span>
docker container stop &amp;lt;hash&amp;gt; &lt;span class="c1"># Gracefully stop the specified container&lt;/span>
docker container &lt;span class="nb">kill&lt;/span> &amp;lt;hash&amp;gt; &lt;span class="c1"># Force shutdown of the specified container&lt;/span>
docker container rm &amp;lt;hash&amp;gt; &lt;span class="c1"># Remove specified container from this machine&lt;/span>
docker container rm &lt;span class="k">$(&lt;/span>docker container ls -a -q&lt;span class="k">)&lt;/span> &lt;span class="c1"># Remove all containers&lt;/span>
docker image ls -a &lt;span class="c1"># List all images on this machine&lt;/span>
docker image rm &amp;lt;image id&amp;gt; &lt;span class="c1"># Remove specified image from this machine&lt;/span>
docker image rm &lt;span class="k">$(&lt;/span>docker image ls -a -q&lt;span class="k">)&lt;/span> &lt;span class="c1"># Remove all images from this machine&lt;/span>
docker login &lt;span class="c1"># Log in this CLI session using your Docker credentials&lt;/span>
docker tag &amp;lt;image&amp;gt; username/repository:tag &lt;span class="c1"># Tag &amp;lt;image&amp;gt; for upload to registry&lt;/span>
docker push username/repository:tag &lt;span class="c1"># Upload tagged image to registry&lt;/span>
docker run username/repository:tag &lt;span class="c1"># Run image from a registry&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="docker-stack-commands">Docker stack commands&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker stack ls &lt;span class="c1"># List stacks or apps&lt;/span>
docker stack deploy -c &amp;lt;composefile&amp;gt; &amp;lt;appname&amp;gt; &lt;span class="c1"># Run the specified Compose file&lt;/span>
docker service ls &lt;span class="c1"># List running services associated with an app&lt;/span>
docker service ps &amp;lt;service&amp;gt; &lt;span class="c1"># List tasks associated with an app&lt;/span>
docker inspect &amp;lt;task or container&amp;gt; &lt;span class="c1"># Inspect task or container&lt;/span>
docker container ls -q &lt;span class="c1"># List container IDs&lt;/span>
docker stack rm &amp;lt;appname&amp;gt; &lt;span class="c1"># Tear down an application&lt;/span>
docker swarm leave --force &lt;span class="c1"># Take down a single node swarm from the manager&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="docker-machine-commands">Docker-machine commands&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker-machine create --driver virtualbox myvm1 &lt;span class="c1"># Create a VM (Mac, Win7, Linux)&lt;/span>
docker-machine create -d hyperv --hyperv-virtual-switch &lt;span class="s2">&amp;#34;myswitch&amp;#34;&lt;/span> myvm1 &lt;span class="c1"># Win10&lt;/span>
docker-machine env myvm1 &lt;span class="c1"># View basic information about your node&lt;/span>
docker-machine ssh myvm1 &lt;span class="s2">&amp;#34;docker node ls&amp;#34;&lt;/span> &lt;span class="c1"># List the nodes in your swarm&lt;/span>
docker-machine ssh myvm1 &lt;span class="s2">&amp;#34;docker node inspect &amp;lt;node ID&amp;gt;&amp;#34;&lt;/span> &lt;span class="c1"># Inspect a node&lt;/span>
docker-machine ssh myvm1 &lt;span class="s2">&amp;#34;docker swarm join-token -q worker&amp;#34;&lt;/span> &lt;span class="c1"># View join token&lt;/span>
docker-machine ssh myvm1 &lt;span class="c1"># Open an SSH session with the VM; type &amp;#34;exit&amp;#34; to end&lt;/span>
docker node ls &lt;span class="c1"># View nodes in swarm (while logged on to manager)&lt;/span>
docker-machine ssh myvm2 &lt;span class="s2">&amp;#34;docker swarm leave&amp;#34;&lt;/span> &lt;span class="c1"># Make the worker leave the swarm&lt;/span>
docker-machine ssh myvm1 &lt;span class="s2">&amp;#34;docker swarm leave -f&amp;#34;&lt;/span> &lt;span class="c1"># Make master leave, kill swarm&lt;/span>
docker-machine ls &lt;span class="c1"># list VMs, asterisk shows which VM this shell is talking to&lt;/span>
docker-machine start myvm1 &lt;span class="c1"># Start a VM that is currently not running&lt;/span>
docker-machine env myvm1 &lt;span class="c1"># show environment variables and command for myvm1&lt;/span>
&lt;span class="nb">eval&lt;/span> &lt;span class="k">$(&lt;/span>docker-machine env myvm1&lt;span class="k">)&lt;/span> &lt;span class="c1"># Mac command to connect shell to myvm1&lt;/span>
&lt;span class="p">&amp;amp;&lt;/span> &lt;span class="s2">&amp;#34;C:\Program Files\Docker\Docker\Resources\bin\docker-machine.exe&amp;#34;&lt;/span> env myvm1 &lt;span class="p">|&lt;/span> Invoke-Expression &lt;span class="c1"># Windows command to connect shell to myvm1&lt;/span>
docker stack deploy -c &amp;lt;file&amp;gt; &amp;lt;app&amp;gt; &lt;span class="c1"># Deploy an app; command shell must be set to talk to manager (myvm1), uses local Compose file&lt;/span>
docker-machine scp docker-compose.yml myvm1:~ &lt;span class="c1"># Copy file to node&amp;#39;s home dir (only required if you use ssh to connect to manager and deploy the app)&lt;/span>
docker-machine ssh myvm1 &lt;span class="s2">&amp;#34;docker stack deploy -c &amp;lt;file&amp;gt; &amp;lt;app&amp;gt;&amp;#34;&lt;/span> &lt;span class="c1"># Deploy an app using ssh (you must have first copied the Compose file to myvm1)&lt;/span>
&lt;span class="nb">eval&lt;/span> &lt;span class="k">$(&lt;/span>docker-machine env -u&lt;span class="k">)&lt;/span> &lt;span class="c1"># Disconnect shell from VMs, use native docker&lt;/span>
docker-machine stop &lt;span class="k">$(&lt;/span>docker-machine ls -q&lt;span class="k">)&lt;/span> &lt;span class="c1"># Stop all running VMs&lt;/span>
docker-machine rm &lt;span class="k">$(&lt;/span>docker-machine ls -q&lt;span class="k">)&lt;/span> &lt;span class="c1"># Delete all VMs and their disk images&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="清理命令">清理命令&lt;/h3>
&lt;h4 id="to-clear-containers">To clear containers:&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker rm -f &lt;span class="k">$(&lt;/span>docker ps -a -q&lt;span class="k">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="to-clear-images">To clear images:&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker rmi -f &lt;span class="k">$(&lt;/span>docker images -a -q&lt;span class="k">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="to-clear-dangling-images">To clear dangling images:&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker rmi -f &lt;span class="k">$(&lt;/span>docker images -f &lt;span class="s2">&amp;#34;dangling=true&amp;#34;&lt;/span> -q&lt;span class="k">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="to-clear-volumes">To clear volumes:&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker volume rm &lt;span class="k">$(&lt;/span>docker volume ls -q&lt;span class="k">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="to-clear-networks">To clear networks:&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker network rm &lt;span class="k">$(&lt;/span>docker network ls &lt;span class="p">|&lt;/span> tail -n+2 &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{if($2 !~ /bridge|none|host/){ print $1 }}&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="查看启动失败的服务信息">查看启动失败的服务信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker service ps --no-trunc &lt;span class="o">{&lt;/span>serviceName&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>docker简单入门</title><link>https://crazygit.wiseturtles.com/2018/02/12/docker-get-started/</link><pubDate>Mon, 12 Feb 2018 21:15:29 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/02/12/docker-get-started/</guid><description>&lt;h2 id="docker安装">Docker安装&lt;/h2>
&lt;p>根据自己的操作系统，参考&lt;a href="https://docs.docker.com/install/">官方文档&lt;/a>完成安装&lt;/p>
&lt;h2 id="测试是否安装成功运行第一个容器">测试是否安装成功，运行第一个容器&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ docker run hello-world
Unable to find image &lt;span class="s1">&amp;#39;hello-world:latest&amp;#39;&lt;/span> locally
latest: Pulling from library/hello-world
ca4f61b1923c: Pull &lt;span class="nb">complete&lt;/span>
Digest: sha256:66ef312bbac49c39a89aa9bcc3cb4f3c9e7de3788c944158df3ee0176d32b751
Status: Downloaded newer image &lt;span class="k">for&lt;/span> hello-world:latest
Hello from Docker!
...
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="创建镜像">创建镜像&lt;/h2>
&lt;h3 id="准备创建镜像需要的文件">准备创建镜像需要的文件&lt;/h3>
&lt;p>创建一个空的目录&lt;code>docker-demo&lt;/code>，在里面放入三个文件&lt;/p>
&lt;p>&lt;code>Dockerfile&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback"># Use an official Python runtime as a parent image
FROM python:2.7-slim
# Set the working directory to /app
WORKDIR /app
# Copy the current directory contents into the container at /app
ADD . /app
# Install any needed packages specified in requirements.txt
RUN pip install --trusted-host pypi.python.org -r requirements.txt
# Make port 80 available to the world outside this container
EXPOSE 80
# Define environment variable
ENV NAME World
# Run app.py when the container launches
CMD [&amp;#34;python&amp;#34;, &amp;#34;app.py&amp;#34;]
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>app.py&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="kn">from&lt;/span> &lt;span class="nn">flask&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Flask&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">redis&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Redis&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RedisError&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">socket&lt;/span>
&lt;span class="c1"># Connect to Redis&lt;/span>
&lt;span class="n">redis&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Redis&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;redis&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">db&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">socket_connect_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">socket_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">app&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Flask&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="vm">__name__&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nd">@app.route&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">hello&lt;/span>&lt;span class="p">():&lt;/span>
&lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">visits&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">redis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">incr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;counter&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">except&lt;/span> &lt;span class="n">RedisError&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">visits&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;i&amp;gt;cannot connect to Redis, counter disabled&amp;lt;/i&amp;gt;&amp;#34;&lt;/span>
&lt;span class="n">html&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;h3&amp;gt;Hello {name}!&amp;lt;/h3&amp;gt;&amp;#34;&lt;/span> \
&lt;span class="s2">&amp;#34;&amp;lt;b&amp;gt;Hostname:&amp;lt;/b&amp;gt; {hostname}&amp;lt;br/&amp;gt;&amp;#34;&lt;/span> \
&lt;span class="s2">&amp;#34;&amp;lt;b&amp;gt;Visits:&amp;lt;/b&amp;gt; {visits}&amp;#34;&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">html&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;NAME&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;world&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">hostname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gethostname&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="n">visits&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">visits&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">80&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>requirements.txt&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">Flask
Redis
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>创建好的效果如下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ ls
Dockerfile app.py requirements.txt
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="创建镜像-1">创建镜像&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">$ docker build -t friendlyhello .
$ docker images
REPOSITORY TAG IMAGE ID
friendlyhello latest 326387cea398
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="运行容器">运行容器&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">$ docker run -p 4000:80 friendlyhello
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>访问&lt;a href="localhost:4000">localhost:4000&lt;/a>查看效果&lt;/p>
&lt;h2 id="分享镜像">分享镜像&lt;/h2>
&lt;p>由于Dockerhub国内访问速度特别慢，这里用阿里云代替&lt;/p>
&lt;h3 id="阿里云docker">阿里云Docker&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://cr.console.aliyun.com/">web控制台&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dev.aliyun.com/search.html">容器Hub&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="登录">登录&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">$ docker login registry.cn-hangzhou.aliyuncs.com
Username: your_username
Password: your_password
Login Succeeded
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="给镜像打标签">给镜像打标签&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">$ docker tag friendlyhello registry.cn-hangzhou.aliyuncs.com/crazygit/get-started:part2
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="发布镜像">发布镜像&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">$ docker push registry.cn-hangzhou.aliyuncs.com/crazygit/get-started:part2
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="镜像加速">镜像加速&lt;/h2>
&lt;p>默认从docker hub上面下载镜像实在太慢了，可以选择使用国内的镜像，比如下面两家:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://cr.console.aliyun.com/">阿里云&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://get.daocloud.io/">DaoCloud&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.docker-cn.com/registry-mirror">Docker 中国官方镜像加速&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>以使用阿里云为例，创建开发者账号，获取加速器链接，我的加速器链接链接是&lt;/p>
&lt;p>&lt;a href="https://b06kc77a.mirror.aliyuncs.com">https://b06kc77a.mirror.aliyuncs.com&lt;/a>&lt;/p>
&lt;p>中国官方镜像加速方法:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">docker pull registry.docker-cn.com/myname/myrepo:mytag
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>《Fast Data Processing with Spark 2（Third Edition)》读书笔记目录</title><link>https://crazygit.wiseturtles.com/2018/01/26/fast-data-processing-with-spark2-note-index/</link><pubDate>Fri, 26 Jan 2018 11:14:35 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/01/26/fast-data-processing-with-spark2-note-index/</guid><description>&lt;h2 id="目录">目录&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://crazygit.wiseturtles.com/2018/01/11/fast-data-processing-with-spark2-note-one/">《FastDataProcessingwithSpark2读书笔记一》&lt;/a>
快速了解Spark的安装，Spark Shell使用和SparkSession对象&lt;/li>
&lt;li>&lt;a href="https://crazygit.wiseturtles.com/2018/01/15/fast-data-processing-with-spark2-note-two/">《FastDataProcessingwithSpark2读书笔记二》&lt;/a>
Spark中加载和保存数据, 以及Spark的一些概念和Spark SQL查询&lt;/li>
&lt;li>&lt;a href="https://crazygit.wiseturtles.com/2018/01/16/fast-data-processing-with-spark2-note-three/">《FastDataProcessingwithSpark2读书笔记三》&lt;/a>
DataSets/DataFrame的常用接口和函数&lt;/li>
&lt;li>&lt;a href="https://crazygit.wiseturtles.com/2018/01/17/fast-data-processing-with-spark2-note-four/">《FastDataProcessingwithSpark2读书笔记四》&lt;/a>
机器学习相关和GraphX（&lt;strong>待完善&lt;/strong>）&lt;/li>
&lt;/ul></description></item><item><title>《高效的秘密》读书文摘</title><link>https://crazygit.wiseturtles.com/2018/01/26/smarter-faster-better/</link><pubDate>Fri, 26 Jan 2018 09:01:52 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/01/26/smarter-faster-better/</guid><description>&lt;h2 id="激发动力">激发动力&lt;/h2>
&lt;ul>
&lt;li>和周围环境的人打好基础，他们会在合适的时机给予帮助，适当地运用小聪明。&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>罗伯特总爱说，为了做生意，他跑遍了墨西哥湾沿岸，任何一条小路和陋巷都留下过他的车辙。公司逐渐发展起来，罗伯特的豪爽也出了名，他总是邀请新奥尔良、亚特兰大等大城市的客户到各色酒吧，尽兴方归。到了次日早晨，罗伯特会趁那些人还处于宿醉状态，让他们心甘情愿地签下几百万美元的订单。酒吧里，调酒师总是不失默契地往罗伯特的杯子里倒苏打水，而给他的大客户们奉上鸡尾酒。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>生活没有动力时，还是要学会给自己灌鸡汤。&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>懂得自我激励的人比同辈人的收入更高，幸福感更强，对自己的家庭、工作和生活的满意度也更高。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>
&lt;ul>
&lt;li>自己感觉能掌握一切时，能减少忧虑。&lt;/li>
&lt;li>生活中有时也是这样，当我们以为掌控了一切的时候，其实有可能在“绕路”。&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>当我们有能力掌控局面时，大脑会变得兴奋。就像你在高速公路上绕远，但仍然感觉不错，因为一切皆在你的掌控之中。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>自己平时给自己定制目标，很多时候都坚持不下来，原因是忘了制定目标的根本意义，最终却把完成目标当成目标了。&lt;/p>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>把任务转化成有意义的决定，动力就会随之产生。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>要么做出决定，证明自己仍然掌控人生，要么抱着等待死亡的心态，两者的区别就在于此。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>能够让人产生动力的方法有两个：一是确信局面在自己的掌控中；二是给自己的行动赋予更大的意义。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;h2 id="团队合作">团队合作&lt;/h2>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>为团队成员带来归属感，并鼓励他们抓住机会。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>善于观察，提高社交敏感性&lt;/p>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>迈克尔斯对自己的社交敏感性颇感骄傲，以此作为炫耀的资本，他还期待演员和编剧效仿他。在《周六夜现场》开播早期，当看到疲惫不堪的编剧在办公室哭泣时，他会走过去安慰几句。他经常在演员排练和对台词时，悄悄地把演员拉到一边，询问他们的个人生活状况&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>
&lt;p>两个悲哀的事情:&lt;/p>
&lt;ul>
&lt;li>现在工作上开会我们好像都成了吉姆，不知道说什么。&lt;/li>
&lt;li>许多领导也习惯了我们变成了吉姆。&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>‘吉姆，你一直没有说话，这个问题你怎么看？’，这看似细枝末节，但能对团队产生巨大的影响。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>团队怎样合作要比团队由哪些人组成重要得多&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>优秀团队的成功具有普遍性。团队合作的关键在于，让每一个成员都拥有发言权，而是否参与投票或者做决定其实并不重要，工作量的多少或者是否在一起办公也不会对团队表现产生影响，团队成员是否拥有发言权和社交敏感性才是最重要的&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>以下5项团队规范是最关键的:&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>团队成员认为他们的工作是重要的。&lt;/li>
&lt;li>团队成员感觉他们的工作对自己是有意义的。&lt;/li>
&lt;li>团队有明确的目标和分工。&lt;/li>
&lt;li>团队成员知道他们可以彼此信赖。&lt;/li>
&lt;li>最重要的是，团队要有心理安全感。&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="保持专注">保持专注&lt;/h2>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>认知隧道”（cognitive tunneling）的精神障碍。当自动化系统突然关闭时，我们被迫启动自己的注意力，大脑从放松状态进入惊慌状态，就有可能产生这种障碍。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>懂得如何分配自己的注意力，习惯性地构建有力的心智模型的人往往能获得更高的收入和取得更好的成绩&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>要想成为真正高效的人，我们必须懂得掌控自己的注意力；必须构建心智模型，从而获得主动权。在开车上班的路上，要求自己想象一整天的工作情况。开会或者用餐的时候，向自己描述所见到的事物及其意义。主动寻找听众，向别人讲述，甚至挑战他们。而且，要让自己习惯于预测接下来会发生什么。如果你是一位家长，请想一想孩子们在晚餐时会说些什么。这样你就能注意到孩子漏说了什么，或者说错了什么，从而给予他们帮助&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;h2 id="设定目标">设定目标&lt;/h2>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>&amp;ldquo;认知闭合需求”（the need for cognitive closure）的动机，心理学家将其定义为：“针对一个问题做出的明确判断——无论什么判断——相对于混乱和不确定而言，任何明确的判断都更好&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>设定目标时必须考虑SMART原则&lt;/p>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>目标必须是&lt;/p>
&lt;ul>
&lt;li>具体的（Specific）&lt;/li>
&lt;li>可衡量的（Measurable）&lt;/li>
&lt;li>可达成的（Achievable）&lt;/li>
&lt;li>现实的（Realistic）&lt;/li>
&lt;li>有完成期限的（Timeline）&lt;/li>
&lt;/ul>
&lt;p>换言之，计划必须切实可行，目标必须能够实现。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>与简单的目标或者模糊、抽象的目标（比如‘做到最好’）相比，具体的高目标更有可能实现。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>在完成目标时，应该避免出现选择简单任务，给虚假的快感这种境况&lt;/p>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>设定SMART目标的人倾向于选择最简单的任务，沉迷于完成项目的快感，并且一旦设定目标，就会考虑优先顺序。“你会形成这样一种思维定式：在每一项待办事项旁边打钩远比思考这项任务是否有意义更重要。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>延展目标&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>从制度上鼓励员工设定大胆的目标。在推进项目时，每个高管和部门除了要设定具体的、可达成的、有完成期限的目标以外，还应该设定一个延展目标（stretch goal）—管理者无法描述（至少在初期）应该如何实现的目标&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>之所以要同时设定延展目标和SMART目标，是因为冒险本身令人恐惧。面对延展目标，我们往往不知从何处着手。那么，为了避免延展目标仅停留在愿望层面，我们需要通过严谨的思考把看似遥不可及的目标转变成一系列现实的短期目标。知道如何设定SMART目标的人往往习惯于把目标细化成一个个可操作的任务。因此，当他们遇到看似超出自己能力范围的目标时，知道应该做些什么。把延展目标和SMART目标结合在一起，能够帮助我们把不太可能实现的目标变为可能。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>自己也经常犯这样的错误&lt;/p>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>有时喜欢写下可立即完成的待办事项，这让我感觉很好’时，这其实是使用待办事项的错误方式，因为他们在用待办事项调节自己的情绪，而不是为了提高效率。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>在完成目标的路上，我们也要时长思考目标的意义，避免走错路&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>有时候，只设定延展目标和SMART目标是不够的。除了树立远大的志向和制订脚踏实地的计划，我们需要跳出日常工作的范畴，想一想我们正在追求的目标是不是有意义。我们始终都需要思考。&lt;/p>
&lt;/blockquote>
&lt;h2 id="掌握力">掌握力&lt;/h2>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>每个人都愿意去寻找做好事带来的成就感，这种感觉有时候甚至高于物质奖励&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>谁都不会为了失败而工作，如果你给他们成功的机会，他们就愿意尝试&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>把决策权交给能解决问题的人&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>如果员工们连犯错的机会都没有，这将是企业最大的损失&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;h2 id="做决定">做决定&lt;/h2>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>如果你无法判断哪一个变量更重要，就用等量加权的方法&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>培养概率思维需要我们质疑自己的假设，并习惯接受事物的不确定性。要想更好地预测未来，更好地做出决定，我们就必须知道自己希望发生之事和有可能或不可能发生之事的区别。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>贝叶斯法则的核心理念是：即使只有少量数据，我们仍然能够通过提出假设并根据对事物的观察来修正这些假设，从而达到预测未来的目的。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>和失败的人在一起时，要思考失败的原因&lt;/p>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>最优秀的企业家能够很清醒地意识到只和成功人士交谈的危险&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>自己在生活中试图把控和掌握一切，常常也因为一些未知和不确定性焦虑，学会接受人生的不确定性！&lt;/p>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>必须接受人生的不确定性，我用这种方法赶走了焦虑。我们能做的就是学会如何做出最好的决定，并相信假以时日好运必然会降临。&lt;/p>
&lt;/blockquote>
&lt;h2 id="创新">创新&lt;/h2>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>如果某种想法已经在头脑中根深蒂固，就会把其他想法彻底排除，也就没有其他可能的选择。所以，有时候激发创造力最好的方式就是加入适当的干扰，留出足够的空间让阳光照射进来。&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>如果你也想成为创意经纪人，提高自己的创新效率，以下三点会对你有所帮助:&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ol>
&lt;li>要学会关注你的个人经历和你对事物的感受，这有助于你分清什么是陈词滥调，什么是真知灼见。&lt;/li>
&lt;li>要明白，在创新过程中，你的压力和恐惧并不意味着一切都完结了。相反，我们要保持头脑的灵活性，从而产生一些新想法。创造性绝望至关重要，焦虑能够推动我们以全新的视角审视过去的想法。摆脱混乱局面的方法是，思考你的所知，重新审视你认为行之有效的惯用手段，用它们解决新的问题。创作过程中经历的痛苦是值得的。&lt;/li>
&lt;li>要记住，创造性突破虽然令人欣慰，但也“屏蔽”了我们更多的选择，所以一定要和已经取得的成果保持适度距离。在没有自我批判也没有压力的情况下，某个想法会迅速排挤掉其他想法。要想实现这个关键的距离，必须重新审视已经取得的成就，从完全不同的角度进行思考，改变团队的内部结构，或者授权给一个新人。在这个过程中，干扰是必不可少的，我们可以大胆推翻之前的成果来保持思维的活跃度，关键是把干扰控制在合理的水平上&lt;/li>
&lt;/ol>
&lt;p>事实上，以上三点可以归结为：创新过程中可以出现差错，也可以推翻重来。这一点很重要，它意味着任何人都具有创造性，都能成为创意经纪人。我们有各自的人生体验，会遭遇各种干扰和压力，这是成为创意经纪人的必经之路，只要我们能够欣然接受创造性绝望和改变，并尝试从不同的角度审视过去的想法。&lt;/p>
&lt;/blockquote>
&lt;h2 id="获取并应用数据">获取并应用数据&lt;/h2>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>数据越来越充足，却无法有效地利用数据，这种现象被称为“信息盲”（information blindness）&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>将数据转变为有效的信息&lt;/li>
&lt;li>分类&lt;/li>
&lt;li>让信息变得有意义&lt;/li>
&lt;/ul>
&lt;h2 id="书中核心观点使用指南">书中核心观点使用指南&lt;/h2>
&lt;ul>
&lt;li>如何激发动力&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>证明选择权掌握在你自己手中。如果你正在回复邮件，先写下一句能够表达你的主要观点和决定的话。如果你要进行一次重要的谈话，请提前决定谈话的地点。拥有掌控权比做出具体的选择更能激发你的动力。&lt;/li>
&lt;li>想清楚这个任务为什么与你在乎的事物息息相关。告诉自己这项任务为什么能让你离那个有意义的目标更近一步。告诉自己为什么这项任务很重要，然后你就会发现迈出第一步变得容易了。&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>需要设定两种目标&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>一种是符合我的远大志向的延展目标。&lt;/li>
&lt;li>一种是有助于我制订具体行动计划的SMART目标。&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>如何设定目标&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>设定一个延展目标，一个能够代表你远大志向的目标。&lt;/li>
&lt;li>把这个目标分解成很多子目标和SMART目标。&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>如何保持专注力&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>想象会发生什么。首先会发生什么？潜在的障碍是什么？你怎样提前扫除障碍？给自己讲一个你期待发生的故事，在你的计划和现实生活发生冲突时，你会很容易决定应该把注意力放在哪里。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>如何更好地做决定&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>想象各种可能出现的结果，鼓励自己想象各种各样的可能性，即使有些可能是自相矛盾的，那么你会做出更明智的选择。&lt;/li>
&lt;li>我们可以培养自己的贝叶斯思维，通过了解不同的经验、视角和其他人的观点，获取信息，并了解信息，你的选择就会更加正确。&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>如何使团队更高效&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>管理是指管理团队的方式，而不是团队里的人。当每一个团队成员感觉自己可以在公平的环境中发表意见，成员之间懂得关注彼此的感受时，心理安全感就会产生。&lt;/li>
&lt;li>如果你正在管理一个团队，想想你传递出的信息是什么。你是鼓励每个成员拥有均等的发言机会，还是奖励发言最多的人？你想通过重复别人的观点、对他人的提问和看法做出回应来表示你在倾听吗？当有人感到沮丧或者不安时，你会表示关注吗？你会带头关注别人的感受，给其他成员做榜样吗？&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>如何有效地管理他人&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>精益和敏捷管理方法告诉我们，如果员工认为自己拥有更多决定权，以及他们的同事都在朝着同一个方向努力，他们的工作就会更具智慧、更优秀。&lt;/li>
&lt;li>让与问题最直接相关的人做决定，领导者可以借此充分利用每个人的专长，激发他们的创新力。&lt;/li>
&lt;li>掌控力可以激发动力，要想激发人们思考和解决问题的动力，就要让人们知道他们的建议不会被忽略，也不会因为犯错而受到责怪。&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>如何鼓励创新&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>创造性源于把旧想法用新方式结合起来，“创意经纪人”是关键。首先，你自己要成为创意经纪人，然后鼓励团队成员也这样做。&lt;/li>
&lt;li>要了解自己的个人经历，学会关注自己对事物的感受。这样做才可以很好地分清什么是陈词滥调，什么是真知灼见，还要研究自己的情感反应。&lt;/li>
&lt;li>要明白，在创新过程中压力并不意味着一切都完了。相反，创造性绝望至关重要，焦虑能促使我们用新视角看待过去的想法。&lt;/li>
&lt;li>最后，要记住，创造性突破虽然令人欣慰，但也会让我们“屏蔽”更多的选择。我们要客观地评价所取得的成绩，从不同的角度思考问题，赋权给某一成员，让她/他去做未做过的工作，使我们的思维保持活跃。&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>如何更好地获取数据&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;ul>
&lt;li>当我们得到新信息后，我们应该对信息进行处理。做笔记解释你刚刚学到的东西，或者想出能够验证观点的办法，或者在纸上把一系列数据点绘制成图表，或者跟朋友分享你的观点。人生中的每一个选择都是一种实验，关键是要看到蕴藏其中的数据，并加以运用，这样我们才能从中学到些什么。&lt;/li>
&lt;/ul>
&lt;/blockquote></description></item><item><title>《A Programmer's Guide to Data Mining》读书笔记一</title><link>https://crazygit.wiseturtles.com/2018/01/22/a-programmers-guid-to-data-mining-note-one/</link><pubDate>Mon, 22 Jan 2018 17:34:52 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/01/22/a-programmers-guid-to-data-mining-note-one/</guid><description>&lt;p>参考:&lt;/p>
&lt;p>&lt;a href="http://guidetodatamining.com/">A Programmer&amp;rsquo;s Guide to Data Mining&lt;/a>&lt;/p>
&lt;p>推荐系统中，最常用的方法就是协同过滤。顾名思义: 这个方法就是利用别人的喜好来推测你的喜好。
假如你喜欢看电影A和B， 另外一个和你&lt;strong>相似的用户&lt;/strong>也喜欢电影A和B，同时他还喜欢看电影C，那么我们就会推测你也喜欢电影C。&lt;/p>
&lt;p>&lt;a href="https://en.wikipedia.org/?title=Collaborative_filtering">如图所示&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-19-Collaborative_filtering.gif" alt="">&lt;/p>
&lt;h2 id="如何找到相似的用户">如何找到相似的用户&lt;/h2>
&lt;p>相似度计算方法有很多，本文将主要介绍以下几种&lt;/p>
&lt;p>距离算法&lt;/p>
&lt;ul>
&lt;li>曼哈顿距离(Manhattan Distance)&lt;/li>
&lt;li>欧几里得距离(Euclidean Distance)&lt;/li>
&lt;li>切比雪夫距离(Chebyshev Distance)&lt;/li>
&lt;li>闵可夫斯基距离(Minkowski Distance)&lt;/li>
&lt;/ul>
&lt;p>相似度系数算法&lt;/p>
&lt;ul>
&lt;li>皮尔逊相关系数(Pearson Correlation Coefficient)&lt;/li>
&lt;li>向量空间余弦相似度(Cosine Similarity)&lt;/li>
&lt;/ul>
&lt;p>对于相同的计算数据，不同的相似度计算方法结果不同，所以需要根据计算样本的特性，选择合适的计算方式。&lt;/p>
&lt;p>更多相似度计算方法可以参考:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.cnblogs.com/arachis/p/Similarity.html">常见的距离算法和相似度(相关系数)计算方法&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.cnblogs.com/heaad/archive/2011/03/08/1977733.html">机器学习中的相似性度量&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://blog.csdn.net/yixianfeng41/article/details/61917158">常用的相似度计算方法原理及实现&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="曼哈顿距离manhattan-distance">曼哈顿距离(Manhattan Distance)&lt;/h3>
&lt;p>参考&lt;a href="https://baike.baidu.com/item/%E6%9B%BC%E5%93%88%E9%A1%BF%E8%B7%9D%E7%A6%BB">百度百科&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>曼哈顿距离，又叫出租车距离（Manhattan Distance）是由十九世纪的赫尔曼·闵可夫斯基所创词汇 ，是种使用在几何度量空间的几何学用语，用以标明两个点在标准坐标系上的绝对轴距总和。&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-22-manhattan.jpg" alt="">&lt;/p>
&lt;blockquote>
&lt;p>图中红线代表曼哈顿距离，绿色代表欧氏距离，也就是直线距离，而蓝色和黄色代表等价的曼哈顿距离。曼哈顿距离——两点在南北方向上的距离加上在东西方向上的距离，即$d(i, j）= |x_i - x_j|+|y_i - y_j|$。对于一个具有正南正北、正东正西方向规则布局的城镇街道，从一点到达另一点的距离正是在南北方向上旅行的距离加上在东西方向上旅行的距离，因此，曼哈顿距离又称为出租车距离。曼哈顿距离不是距离不变量，当坐标轴变动时，点间的距离就会不同。曼哈顿距离示意图在早期的计算机图形学中，屏幕是由像素构成，是整数，点的坐标也一般是整数，原因是浮点运算很昂贵，很慢而且有误差，如果直接使用AB的欧氏距离(欧几里德距离: 在二维和三维空间中的欧氏距离的就是两点之间的距离），则必须要进行浮点运算，如果使用AC和CB，则只要计算加减法即可，这就大大提高了运算速度，而且不管累计运算多少次，都不会有误差。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>二维平面两点a(x1,y1)与b(x2,y2)间的曼哈顿距离&lt;/li>
&lt;/ul>
&lt;p>$$
d_{ab} = |x_1 - x_2| + |y_1 - y_2|
$$&lt;/p>
&lt;ul>
&lt;li>两个n维向量a(x11,x12,…,x1n)与b(x21,x22,…,x2n)间的曼哈顿距离&lt;/li>
&lt;/ul>
&lt;p>{% math %}&lt;/p>
&lt;p>d_{ab} =\sum\limits_{k=1}^n|x_{1k} - x_{2k}|&lt;/p>
&lt;p>{% endmath %}&lt;/p>
&lt;h3 id="欧几里得距离euclidean-distance">欧几里得距离(Euclidean Distance)&lt;/h3>
&lt;p>参考&lt;a href="%E5%9C%A8%E6%95%B0%E5%AD%A6%E4%B8%AD%EF%BC%8C%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E8%B7%9D%E7%A6%BB%E6%88%96%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E5%BA%A6%E9%87%8F%E6%98%AF%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%A9%BA%E9%97%B4%E4%B8%AD%E4%B8%A4%E7%82%B9%E9%97%B4%E2%80%9C%E6%99%AE%E9%80%9A%E2%80%9D%EF%BC%88%E5%8D%B3%E7%9B%B4%E7%BA%BF%EF%BC%89%E8%B7%9D%E7%A6%BB">维基百科&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>在数学中，欧几里得距离或欧几里得度量是欧几里得空间中两点间“普通”（即直线）距离&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>二维平面上两点a(x1,y1)与b(x2,y2)间的欧几里得距离:&lt;/li>
&lt;/ul>
&lt;p>$$
d_{ab} = \sqrt{(x_1-x_2)^2 + (y_1-y_2)^2}
$$&lt;/p>
&lt;ul>
&lt;li>两个n维向量a(x11,x12,…,x1n)与 b(x21,x22,…,x2n)间的欧几里得距离&lt;/li>
&lt;/ul>
&lt;p>{% math %}&lt;/p>
&lt;p>d_{ab} = \sqrt{\sum\limits_{k=1}^n(x_{1k} - x_{2k})^2}&lt;/p>
&lt;p>{% endmath %}&lt;/p>
&lt;h3 id="切比雪夫距离chebyshev-distance">切比雪夫距离(Chebyshev Distance)&lt;/h3>
&lt;p>参考&lt;a href="https://zh.wikipedia.org/wiki/%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E8%B7%9D%E7%A6%BB">维基百科&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>数学上，切比雪夫距离（Chebyshev distance）或是L∞度量是向量空间中的一种度量，二个点之间的距离定义为_其各座标数值差的最大值_。以(x1,y1)和(x2,y2)二点为例，其切比雪夫距离为max(|x2-x1|,|y2-y1|)。切比雪夫距离得名自俄罗斯数学家切比雪夫。&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-22-Chebyshev.png" alt="">&lt;/p>
&lt;blockquote>
&lt;p>若将国际象棋棋盘放在二维直角座标系中，格子的边长定义为1，座标的x轴及y轴和棋盘方格平行，原点恰落在某一格的中心点，则王从一个位置走到其他位置需要的步数恰为二个位置的切比雪夫距离，因此切比雪夫距离也称为棋盘距离。例如位置F6和位置E2的切比雪夫距离为4。任何一个不在棋盘边缘的位置，和周围八个位置的切比雪夫距离都是1。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>二维平面两点a(x1,y1)与b(x2,y2)间的切比雪夫距离&lt;/li>
&lt;/ul>
&lt;p>$$
d_{ab} = max(|x_1-x_2|, |y_1 - y_2|)
$$&lt;/p>
&lt;ul>
&lt;li>两个n维向量a(x11,x12,…,x1n)与 b(x21,x22,…,x2n)间的切比雪夫距离&lt;/li>
&lt;/ul>
&lt;p>{% math %}&lt;/p>
&lt;p>d_{ab} = max(|x_{1i}-x_{2i}|)&lt;/p>
&lt;p>{% endmath %}&lt;/p>
&lt;p>等价于&lt;/p>
&lt;p>{% math %}&lt;/p>
&lt;p>d_{ab} = \lim\limits_{k \to \infty}(\sum\limits_{i=1}^{n}|x_{1i} - x_{2i}|^k)^{\frac{1}{k}}&lt;/p>
&lt;p>{% endmath %}&lt;/p>
&lt;h3 id="闵可夫斯基距离minkowski-distance">闵可夫斯基距离(Minkowski Distance)&lt;/h3>
&lt;p>可以将曼哈顿距离，欧几里得距离，切比雪夫距离三种距离的计算公式归纳
为一个计算公式，这就是闵可夫斯基距离(Minkowski Distance)。&lt;/p>
&lt;p>$$
d(x, y) = (\sum\limits_{k=1}^n|x_k - y_k|^r)^{\frac{1}{r}}
$$&lt;/p>
&lt;ul>
&lt;li>$r = 1$, 该公式就是曼哈顿距离&lt;/li>
&lt;li>$r = 2$, 该公式就是曼哈顿距离&lt;/li>
&lt;li>$r = \infty$, 该公式就是切比雪夫距离&lt;/li>
&lt;/ul>
&lt;h3 id="皮尔逊相关系数pearson-correlation-coefficient">皮尔逊相关系数(Pearson Correlation Coefficient)&lt;/h3>
&lt;p>参考:
&lt;a href="https://crazygit.wiseturtles.com/2018/01/19/pearson-correlation-coefficient/">皮尔逊相关系数&lt;/a>&lt;/p>
&lt;h3 id="余弦相似度cosine-similarity">余弦相似度(Cosine Similarity)&lt;/h3>
&lt;p>参考&lt;a href="https://baike.baidu.com/item/%E4%BD%99%E5%BC%A6%E7%9B%B8%E4%BC%BC%E5%BA%A6">百度百科&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>余弦相似度，又称为余弦相似性，是通过计算两个向量的夹角余弦值来评估他们的相似度。余弦相似度将向量根据坐标值，绘制到向量空间中，如最常见的二维空间。&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-23-cosine-distance.jpg" alt="">&lt;/p>
&lt;ul>
&lt;li>二维平面上，假设向量a、b的坐标分别为(x1,y1)、(x2,y2) 。则:&lt;/li>
&lt;/ul>
&lt;p>$$
cos\theta = \frac{x_1x_2+y_1y_2}{\sqrt{x_1^2 + y_1^2}\sqrt{x_2^2 + y_2^2}}
$$&lt;/p>
&lt;ul>
&lt;li>推广到n维空间，计算公式为:&lt;/li>
&lt;/ul>
&lt;p>$$
cos\theta = \frac{\sum\limits_1^n(Ai \times Bi)}{\sqrt{\sum\limits_1^nA_i^2}\sqrt{\sum\limits_1^nB_i^2}}
$$&lt;/p>
&lt;h4 id="性质">性质&lt;/h4>
&lt;p>余弦值的范围在[-1,1]之间，值越趋近于1，代表两个向量的方向越接近；越趋近于-1，他们的方向越相反；接近于0，表示两个向量近乎于正交。&lt;/p>
&lt;h3 id="实战">实战&lt;/h3>
&lt;p>在介绍了一大堆的相似度计算之后，我们来通过一些例子，说明具体的用法。
假设我们要为一个在线音乐网站的用户推荐乐队。用户可以用1-5颗星来评价他喜欢的乐队，其中包含半颗星(如2.5星)，下表展示了8位用户对8支乐队的评价:&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-23-Recommand-Music-Bannd.png" alt="">&lt;/p>
&lt;p>图中的&lt;code>-&lt;/code>表示没有评分。在计算两个用户的距离时，只考虑他们都评价过的乐队。暂时不考虑数据缺失的情况。&lt;/p>
&lt;p>数据转换成代码如下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="kn">import&lt;/span> &lt;span class="nn">json&lt;/span>
&lt;span class="n">users_string&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span class="s1">{
&lt;/span>&lt;span class="s1"> &amp;#34;Angelica&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;Blues Traveler&amp;#34;: 3.5,
&lt;/span>&lt;span class="s1"> &amp;#34;Broken Bells&amp;#34;: 2,
&lt;/span>&lt;span class="s1"> &amp;#34;Norah Jones&amp;#34;: 4.5,
&lt;/span>&lt;span class="s1"> &amp;#34;Phoenix&amp;#34;: 5,
&lt;/span>&lt;span class="s1"> &amp;#34;Slightly Stoopid&amp;#34;: 1.5,
&lt;/span>&lt;span class="s1"> &amp;#34;The Strokes&amp;#34;: 2.5,
&lt;/span>&lt;span class="s1"> &amp;#34;Vampire Weekend&amp;#34;: 2
&lt;/span>&lt;span class="s1"> },
&lt;/span>&lt;span class="s1"> &amp;#34;Bill&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;Blues Traveler&amp;#34;: 2,
&lt;/span>&lt;span class="s1"> &amp;#34;Broken Bells&amp;#34;: 3.5,
&lt;/span>&lt;span class="s1"> &amp;#34;Deadmau5&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;Phoenix&amp;#34;: 2,
&lt;/span>&lt;span class="s1"> &amp;#34;Slightly Stoopid&amp;#34;: 3.5,
&lt;/span>&lt;span class="s1"> &amp;#34;Vampire Weekend&amp;#34;: 3
&lt;/span>&lt;span class="s1"> },
&lt;/span>&lt;span class="s1"> &amp;#34;Chan&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;Blues Traveler&amp;#34;: 5,
&lt;/span>&lt;span class="s1"> &amp;#34;Broken Bells&amp;#34;: 1,
&lt;/span>&lt;span class="s1"> &amp;#34;Deadmau5&amp;#34;: 1,
&lt;/span>&lt;span class="s1"> &amp;#34;Norah Jones&amp;#34;: 3,
&lt;/span>&lt;span class="s1"> &amp;#34;Phoenix&amp;#34;: 5,
&lt;/span>&lt;span class="s1"> &amp;#34;Slightly Stoopid&amp;#34;: 1
&lt;/span>&lt;span class="s1"> },
&lt;/span>&lt;span class="s1"> &amp;#34;Dan&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;Blues Traveler&amp;#34;: 3,
&lt;/span>&lt;span class="s1"> &amp;#34;Broken Bells&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;Deadmau5&amp;#34;: 4.5,
&lt;/span>&lt;span class="s1"> &amp;#34;Phoenix&amp;#34;: 3,
&lt;/span>&lt;span class="s1"> &amp;#34;Slightly Stoopid&amp;#34;: 4.5,
&lt;/span>&lt;span class="s1"> &amp;#34;The Strokes&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;Vampire Weekend&amp;#34;: 2
&lt;/span>&lt;span class="s1"> },
&lt;/span>&lt;span class="s1"> &amp;#34;Hailey&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;Broken Bells&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;Deadmau5&amp;#34;: 1,
&lt;/span>&lt;span class="s1"> &amp;#34;Norah Jones&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;The Strokes&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;Vampire Weekend&amp;#34;: 1
&lt;/span>&lt;span class="s1"> },
&lt;/span>&lt;span class="s1"> &amp;#34;Jordyn&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;Broken Bells&amp;#34;: 4.5,
&lt;/span>&lt;span class="s1"> &amp;#34;Deadmau5&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;Norah Jones&amp;#34;: 5,
&lt;/span>&lt;span class="s1"> &amp;#34;Phoenix&amp;#34;: 5,
&lt;/span>&lt;span class="s1"> &amp;#34;Slightly Stoopid&amp;#34;: 4.5,
&lt;/span>&lt;span class="s1"> &amp;#34;The Strokes&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;Vampire Weekend&amp;#34;: 4
&lt;/span>&lt;span class="s1"> },
&lt;/span>&lt;span class="s1"> &amp;#34;Sam&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;Blues Traveler&amp;#34;: 5,
&lt;/span>&lt;span class="s1"> &amp;#34;Broken Bells&amp;#34;: 2,
&lt;/span>&lt;span class="s1"> &amp;#34;Norah Jones&amp;#34;: 3,
&lt;/span>&lt;span class="s1"> &amp;#34;Phoenix&amp;#34;: 5,
&lt;/span>&lt;span class="s1"> &amp;#34;Slightly Stoopid&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;The Strokes&amp;#34;: 5
&lt;/span>&lt;span class="s1"> },
&lt;/span>&lt;span class="s1"> &amp;#34;Veronica&amp;#34;: {
&lt;/span>&lt;span class="s1"> &amp;#34;Blues Traveler&amp;#34;: 3,
&lt;/span>&lt;span class="s1"> &amp;#34;Norah Jones&amp;#34;: 5,
&lt;/span>&lt;span class="s1"> &amp;#34;Phoenix&amp;#34;: 4,
&lt;/span>&lt;span class="s1"> &amp;#34;Slightly Stoopid&amp;#34;: 2.5,
&lt;/span>&lt;span class="s1"> &amp;#34;The Strokes&amp;#34;: 3
&lt;/span>&lt;span class="s1"> }
&lt;/span>&lt;span class="s1">}
&lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span class="n">users&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">json&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">loads&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">users_string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>计算曼哈顿距离&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">def&lt;/span> &lt;span class="nf">manhattan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rating1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rating2&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;计算曼哈顿距离&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span class="n">distance&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">rating1&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">rating2&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">difference&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">abs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rating1&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">rating2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="n">distance&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">difference&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">distance&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>测试一下效果&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">manhattan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Hailey&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Veronica&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mi">2&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">manhattan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Hailey&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Jordyn&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mf">7.5&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>下面再通过一个函数，实现找出最近的用户距离，该函数会返回一个用户列表，按照距离排序&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">def&lt;/span> &lt;span class="nf">computeNearestNeighbor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">distances&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">user&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">user&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="n">username&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">distance&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">manhattan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="n">distances&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">distance&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">user&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">distances&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">distances&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>测试一下，计算与用户Hailey最相似的用户&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">computeNearestNeighbor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Hailey&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">[(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Veronica&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Chan&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Sam&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="mf">4.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Dan&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="mf">5.0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Angelica&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="mf">5.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Bill&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="mf">7.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Jordyn&amp;#39;&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>最后再来根据距离做推荐&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">def&lt;/span> &lt;span class="nf">recommend&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="c1"># 找到距离最近的用户&lt;/span>
&lt;span class="n">nearest&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">computeNearestNeighbor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">)[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="n">recommendations&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;span class="c1"># 找出这位用户评价过，但自己未评价过的乐队&lt;/span>
&lt;span class="n">neighborRatings&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">nearest&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="n">userRatings&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">artist&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">neighborRatings&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">artist&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">userRatings&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">recommendations&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">artist&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">neighborRatings&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">artist&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;span class="c1"># 按照评分进行排序&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nb">sorted&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">recommendations&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">lambda&lt;/span> &lt;span class="n">recommend&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">recommend&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">reverse&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>为用户Hailey做推荐&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">recommend&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Hailey&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">[(&lt;/span>&lt;span class="s1">&amp;#39;Phoenix&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Blues Traveler&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Slightly Stoopid&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">2.5&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>闵科夫斯基算法&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">def&lt;/span> &lt;span class="nf">minkowski&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rating1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rating2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">r&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;闵可夫斯基算法&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span class="n">distance&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">rating1&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">rating2&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">distance&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nb">pow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">abs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rating1&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">rating2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">]),&lt;/span> &lt;span class="n">r&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nb">pow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">distance&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>皮尔逊系数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">def&lt;/span> &lt;span class="nf">pearson&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rating1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rating2&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">sum_xy&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="n">sum_x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="n">sum_y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="n">sum_x2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="n">sum_y2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="n">n&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">rating1&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">rating2&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">n&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rating1&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rating2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="n">sum_xy&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">y&lt;/span>
&lt;span class="n">sum_x&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">x&lt;/span>
&lt;span class="n">sum_y&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">y&lt;/span>
&lt;span class="n">sum_x2&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nb">pow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">sum_y2&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nb">pow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="c1"># now compute denominator&lt;/span>
&lt;span class="n">denominator&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sqrt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sum_x2&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nb">pow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sum_x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">*&lt;/span> &lt;span class="n">sqrt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sum_y2&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nb">pow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sum_y&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">denominator&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sum_xy&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sum_x&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">sum_y&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">denominator&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="相似度算法选择">相似度算法选择&lt;/h3>
&lt;p>根据数据的特性，不同的算法计算的结果会有偏差，但是大体上满足如下规律:&lt;/p>
&lt;ul>
&lt;li>如果数据存在&amp;quot;分数膨胀&amp;quot;，就使用皮尔逊相关系数&lt;/li>
&lt;li>如果数据比较密集，变量之间基本存在公有值，且这些距离数据都是非常重要的，那就使用曼哈顿距离或欧几里得距离&lt;/li>
&lt;li>如果数据是稀释的，就用余弦定理&lt;/li>
&lt;/ul>
&lt;h3 id="距离计算库">距离计算库&lt;/h3>
&lt;p>&lt;a href="https://docs.scipy.org/doc/scipy/reference/spatial.distance.html">&lt;code>scipy.spatial.distance&lt;/code>&lt;/a>模块包含了各种距离的计算方式。&lt;/p>
&lt;ul>
&lt;li>scipy.spatial.distance.cityblock 曼哈顿距离&lt;/li>
&lt;li>scipy.spatial.distance.euclidean 欧几里得距离&lt;/li>
&lt;li>scipy.spatial.distance.chebyshev 切比雪夫距离&lt;/li>
&lt;li>scipy.spatial.distance.minkowski 闵可夫斯基距离&lt;/li>
&lt;li>scipy.stats.pearsonr 皮尔逊相关系数&lt;/li>
&lt;/ul>
&lt;h3 id="k最邻近算法">K最邻近算法&lt;/h3>
&lt;p>如果只使用最相似的一个用户来做推荐，如果这个用户有特殊的偏好，就会直接反应在推荐内容里。解决方法之一就是寻找多个相似的用户，这里就要用到K最邻近算法了。&lt;/p>
&lt;p>完整实现请参考:&lt;/p>
&lt;p>&lt;a href="https://github.com/zacharski/pg2dm-python/blob/master/ch2/recommender.py">https://github.com/zacharski/pg2dm-python/blob/master/ch2/recommender.py&lt;/a>&lt;/p></description></item><item><title>皮尔逊相关系数(Pearson Correlation Coefficient)</title><link>https://crazygit.wiseturtles.com/2018/01/19/pearson-correlation-coefficient/</link><pubDate>Fri, 19 Jan 2018 17:48:36 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/01/19/pearson-correlation-coefficient/</guid><description>&lt;p>在介绍皮尔逊相关系数前，先来回顾一些统计相关的术语，便于我们更好的理解后面的计算公式。&lt;/p>
&lt;h2 id="方差variance">方差（Variance）&lt;/h2>
&lt;p>参考&lt;a href="https://baike.baidu.com/item/%E6%96%B9%E5%B7%AE">百度百科&lt;/a>&lt;/p>
&lt;p>&lt;strong>注意&lt;/strong>:&lt;/p>
&lt;blockquote>
&lt;p>方差在统计描述和概率分布中各有不同的定义，并有不同的公式。&lt;/p>
&lt;/blockquote>
&lt;p>下面主要介绍在统计描述中的方差&lt;/p>
&lt;blockquote>
&lt;p>在统计描述中，方差用来计算每一个变量（观察值）与总体均数之间的差异。为避免出现离均差总和为零，离均差平方和受样本含量的影响，统计学采用平均离均差平方和来描述变量的变异程度。&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>总体方差&lt;/strong>计算公式为:&lt;/p>
&lt;p>$$
\sigma^2 = \frac{\sum(X-\mu)^2}{N}
$$&lt;/p>
&lt;p>$\sigma^2$为总体方差，$X$为变量，$\mu$为总体均值，$N$为总体例数。&lt;/p>
&lt;p>实际工作中，总体均数难以得到时，应用样本统计量代替总体参数，经校正后，&lt;/p>
&lt;p>&lt;strong>样本方差&lt;/strong>计算公式：&lt;/p>
&lt;p>$$
S^2 = \frac{\sum(X-\bar{X}) ^2}{(n-1)}
$$&lt;/p>
&lt;p>$S^2$为样本方差，$X$为变量，$\bar{X}$为样本均值，$n$为样本例数。&lt;/p>
&lt;p>例如:&lt;/p>
&lt;p>两个人X, Y 5次考试测验的分数分别是:&lt;/p>
&lt;ul>
&lt;li>X: 50, 100, 100, 60, 50&lt;/li>
&lt;li>Y: 73, 70, 75, 72, 70&lt;/li>
&lt;/ul>
&lt;p>X, Y的平均值分别为:&lt;/p>
&lt;p>$$
\mu_x = \bar{X} = \frac{(50+100+100+60+50)}{5} = 72
$$&lt;/p>
&lt;p>$$
\mu_y = \bar{Y} = \frac{(73+70+75+72+70)}{5} = 72
$$&lt;/p>
&lt;p>总体方差为:&lt;/p>
&lt;p>$$
\sigma^2_x = \frac{(50-72)^2+(100-72)^2+(100-72)^2+(60-72)^2+(50-72)^2}{5}= \frac{2680}{5}=536
$$&lt;/p>
&lt;p>$$
\sigma^2_y = \frac{(73-72)^2+(70-72)^2+(75-72)^2+(72-72)^2+(70-72)^2}{5}=\frac{18}{4}=3.6
$$&lt;/p>
&lt;p>样本方差为:&lt;/p>
&lt;p>$$
S^2_x = \frac{(50-72)^2+(100-72)^2+(100-72)^2+(60-72)^2+(50-72)^2}{5-1} = \frac{2680}{4} = 670
$$&lt;/p>
&lt;p>$$
S^2_y = \frac{(73-72)^2+(70-72)^2+(75-72)^2+(72-72)^2+(70-72)^2}{5-1}=\frac{18}{4}=4.5
$$&lt;/p>
&lt;h3 id="使用python模块计算">使用python模块计算&lt;/h3>
&lt;p>&lt;code>statistic&lt;/code>和&lt;code>numpy&lt;/code>包含了计算方差的方式&lt;/p>
&lt;p>&lt;code>statistics.variance&lt;/code>计算&lt;strong>样本方差&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="nn">statistics&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">statistics&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">variance&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mi">670&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">statistics&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">variance&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">73&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mf">4.5&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>numpy&lt;/code>可以通过设置参数&lt;code>ddof&lt;/code>参数来选择计算方式。默认是计算&lt;strong>全局方差&lt;/strong>&lt;/p>
&lt;p>计算全局方差(&lt;code>ddof=0&lt;/code>)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">var&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mf">536.0&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">var&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">73&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mf">3.6&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>计算样本方差(&lt;code>ddof=1&lt;/code>)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">var&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ddof&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="mf">670.0&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">var&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">73&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ddof&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="mf">4.5&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="扩展阅读">扩展阅读&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="http://mortada.net/computing-sample-variance-why-divide-by-n-1.html">Computing Sample Variance: Why Divide by N - 1?&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.youtube.com/watch?v=xslIhnquFoE">Variance: The Mystery of n-1 (Part 1: The problem with using n)&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="标准差standard-deviation">标准差(Standard Deviation)&lt;/h2>
&lt;p>参考&lt;a href="https://baike.baidu.com/item/%E6%A0%87%E5%87%86%E5%B7%AE%E5%85%AC%E5%BC%8F">百度百科&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>标准差（Standard Deviation）, 中文环境中又常称均方差，用σ表示。标准差是方差的算术平方根。标准差能反映一个数据集的离散程度。平均数相同的两组数据，标准差未必相同。&lt;/p>
&lt;/blockquote>
&lt;p>标准差的计算公式为:&lt;/p>
&lt;p>$$
\sigma = \sqrt{方差} = \sqrt{\frac{(X-\mu)^2}{N}}
$$&lt;/p>
&lt;p>同计算方差类似，计算标准差如下:&lt;/p>
&lt;p>样本的标准差&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">statistics&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stdev&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mf">25.88435821108957&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">statistics&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stdev&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">73&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mf">2.1213203435596424&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>总体的样本差&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">std&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mf">23.15167380558045&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">std&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">73&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="mf">1.8973665961010275&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>样本的标准差&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">std&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ddof&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="mf">25.88435821108957&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">std&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">73&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ddof&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="mf">2.1213203435596424&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>由标准差可以看出，虽然学生X, Y的平均分数相同(都是72分)&lt;/p>
&lt;ul>
&lt;li>X: 50, 100, 100, 60, 50&lt;/li>
&lt;li>Y: 73, 70, 75, 72, 70&lt;/li>
&lt;/ul>
&lt;p>但是,Y的标准差小于X的标准差。Y的考试成绩更稳定。&lt;/p>
&lt;h2 id="标准分数standard-score">标准分数(Standard Score)&lt;/h2>
&lt;p>参考&lt;a href="https://baike.baidu.com/item/%E6%A0%87%E5%87%86%E5%88%86%E6%95%B0">百度百科&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>标准分数也叫z分数(z-score)，是一种具有相等单位的量数。它是将原始分数与团体的平均数之差除以标准差所得的商数，是以标准差为单位度量原始分数离开其平均数的分数之上多少个标准差，或是在平均数之下多少个标准差。它是一个抽象值，不受原始测量单位的影响，并可接受进一步的统计处理&lt;/p>
&lt;/blockquote>
&lt;p>计算公式为:&lt;/p>
&lt;p>$$
z = \frac{x - \mu}{\sigma}
$$&lt;/p>
&lt;p>$x$为某一具体分数，$\mu$为平均数，$\sigma$为标准差。&lt;/p>
&lt;h3 id="使用场景">使用场景&lt;/h3>
&lt;p>某中学高一班期末考试，已知语文期末考试的全班平均分为73分，标准差为7分，甲得了78分；数学期末考试的全班平均分为80分，标准差为6.5分，甲得了83分。甲哪一门考试成绩比较好？&lt;/p>
&lt;p>因为两科期末考试的标准差不同，因此不能用原始分数直接比较。需要将原始分数转换成标准分数，然后进行比较。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-fallback" data-lang="fallback">Z(语文)=(78-73)/7=0.71
Z(数学)=(83-80)/6.5=0.46
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>甲的语文成绩在其整体分布中位于平均分之上0.71个标准差的地位，他的数学成绩在其整体分布中位于平均分之上0.46个标准差的地位。&lt;/p>
&lt;p>由此可见，甲的语文期末考试成绩优于数学期末考试成绩。
由于标准分数不仅能表明原始分数在分布中的地位，它还是以标准差为单位的等距量表，故经过把原始分数转化为标准分数，可以在不同分布的各原始分数之间进行比较。&lt;/p>
&lt;h3 id="使用python模块计算-1">使用python模块计算&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">from&lt;/span> &lt;span class="nn">scipy&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">stats&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">stats&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zscore&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="n">array&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">0.95025527&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.2094158&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="mf">1.2094158&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.51832106&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.95025527&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">stats&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zscore&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">73&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="n">array&lt;/span>&lt;span class="p">([&lt;/span> &lt;span class="mf">0.52704628&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">1.05409255&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.58113883&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">1.05409255&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">stats&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zscore&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ddof&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">array&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">0.84993415&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.08173437&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.08173437&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.46360045&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.84993415&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">stats&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zscore&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">73&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ddof&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">array&lt;/span>&lt;span class="p">([&lt;/span> &lt;span class="mf">0.47140452&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.94280904&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.41421356&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.94280904&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="皮尔逊相关系数pearson-correlation-coefficient">皮尔逊相关系数(Pearson Correlation Coefficient)&lt;/h2>
&lt;p>参考&lt;a href="https://baike.baidu.com/item/%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0">百度百科&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>相关系数是最早由统计学家卡尔·皮尔逊设计的统计指标，是研究变量之间线性相关程度的量，一般用字母 r 表示。由于研究对象的不同，相关系数有多种定义方式，较为常用的是皮尔逊相关系数。&lt;/p>
&lt;/blockquote>
&lt;p>&lt;em>需要说明的是，皮尔逊相关系数并不是唯一的相关系数，但是最常见的相关系数&lt;/em>&lt;/p>
&lt;p>定义1&lt;/p>
&lt;blockquote>
&lt;p>两个变量之间的皮尔逊相关系数定义为两个变量之间的协方差和标准差的商&lt;/p>
&lt;/blockquote>
&lt;p>计算公式如下:&lt;/p>
&lt;p>$$
P_{xy}=\frac{cov(X, Y)}{\sigma_x\sigma_y}
$$&lt;/p>
&lt;p>定义2&lt;/p>
&lt;blockquote>
&lt;p>相关系数r亦可由$(X_i,Y_i)$样本点的标准分数均值估计&lt;/p>
&lt;/blockquote>
&lt;p>计算公式如下:&lt;/p>
&lt;p>{% math %}&lt;/p>
&lt;p>r_{xy} = \frac{1}{n}\sum\limits_{i=1}^n(Z_x)_i(Z_y)_i \\&lt;br>
= \frac{1}{n}\sum\limits_{i=1}^n\cdot\frac{x-\bar{x}}{\sqrt{\frac{1}{n}\sum\limits_{i=1}^n(x-\bar{x})^2}}\cdot\frac{y-\bar{y}}{\sqrt{\frac{1}{n}\sum\limits_{i=1}^n(y-\bar{y})^2}} \\&lt;br>
= \frac{\sum\limits_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum\limits_{i=1}^n(x-\bar{x})^2}\sqrt{\sum\limits_{i=1}^n(y-\bar{y})^2}}&lt;/p>
&lt;p>{% endmath %}&lt;/p>
&lt;p>其中$Z_x$为$x$的标准分数，其中$Z_y$为$y$的标准分数。$\bar{x}$为x的平均数，$\bar{y}$为y的平均数。&lt;/p>
&lt;p>举个例子(来自李政轩老师的视频教程&lt;a href="https://www.youtube.com/watch?v=nF-ixjPfaK0">皮尔逊相关系数&lt;/a>):&lt;/p>
&lt;p>有学生A, B, C&amp;hellip;G的数学成绩和自然成绩分别如下, 现在需要分析学生的数学成绩和自然成绩之间是否存在关系。比如学生数学成绩好的自然成绩也好？&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-22-zscore.png" alt="相关系数">&lt;/p>
&lt;p>标准化成绩的计算方式如下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">from&lt;/span> &lt;span class="nn">scipy&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">stats&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="nn">numpy&lt;/span> &lt;span class="kn">as&lt;/span> &lt;span class="nn">np&lt;/span>
&lt;span class="c1"># 设置打印3位小数&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">set_printoptions&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">precision&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1"># 标准化数学成绩&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">zscore_math&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">stats&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zscore&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">74&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">76&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">77&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">63&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">63&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">61&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ddof&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">zscore_math&lt;/span>
&lt;span class="n">array&lt;/span>&lt;span class="p">([&lt;/span> &lt;span class="mf">0.667&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.959&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.105&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.938&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.938&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">1.23&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="mf">0.375&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="c1"># 标准化自然成绩&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">zscore_sciense&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">stats&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zscore&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">84&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">83&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">85&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">74&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">81&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">73&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ddof&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">zscore_sciense&lt;/span>
&lt;span class="n">array&lt;/span>&lt;span class="p">([&lt;/span> &lt;span class="mf">0.92&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="mf">0.725&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.116&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">1.032&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.837&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.335&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">1.227&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="c1"># 两个标准化成绩相乘&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">dot_math_sciense&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">zscore_math&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">zscore_sciense&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">dot_math_sciense&lt;/span>
&lt;span class="n">array&lt;/span>&lt;span class="p">([&lt;/span> &lt;span class="mf">0.614&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.695&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.233&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.968&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.785&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.412&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mf">0.461&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>相关系数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="c1"># 下面除以(n-1)是因为前面一直用样本方差来计算的&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">r&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dot_math_sciense&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">r&lt;/span>
&lt;span class="mf">0.5704948696393594&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>相关系数为&lt;code>0.570&lt;/code>, 说明数学成绩和自然成绩之间没有什么关系
利用现成的库计算&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="c1"># 返回的元组第一个数就是相关系数&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">scipy&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pearsonr&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">74&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">76&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">77&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">63&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">63&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">61&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">84&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">83&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">85&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">74&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">81&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">73&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="p">(&lt;/span>&lt;span class="mf">0.5704948696393595&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.18107908965203987&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">corrcoef&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="mi">74&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">76&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">77&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">63&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">63&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">61&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">84&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">83&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">85&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">74&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">81&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">73&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="n">array&lt;/span>&lt;span class="p">([[&lt;/span>&lt;span class="mf">1.&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="mf">0.57&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="p">[&lt;/span>&lt;span class="mf">0.57&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">1.&lt;/span> &lt;span class="p">]])&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="相关系数的特性">相关系数的特性&lt;/h3>
&lt;p>$$
-1 \leq r_{xy} \leq 1
$$&lt;/p>
&lt;p>1表示完全正相关，-1表示完全负相关&lt;/p></description></item><item><title>《Fast Data Processing with Spark 2（Third Edition)》读书笔记四</title><link>https://crazygit.wiseturtles.com/2018/01/17/fast-data-processing-with-spark2-note-four/</link><pubDate>Wed, 17 Jan 2018 10:11:35 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/01/17/fast-data-processing-with-spark2-note-four/</guid><description>&lt;p>本书其它笔记&lt;a href="https://crazygit.wiseturtles.com/2018/01/26/fast-data-processing-with-spark2-note-index/">Fast Data Processing with Spark 2（Third Edition)》读书笔记目&lt;/a>&lt;/p>
&lt;h2 id="机器学习和spark-ml-pipelines">机器学习和Spark ML Pipelines&lt;/h2>
&lt;h3 id="spark机器学习算法表">Spark机器学习算法表&lt;/h3>
&lt;p>机器学习的相关算法: &lt;code>pyspark.ml&lt;/code>&lt;/p>
&lt;p>机器学习算法表&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-17-MachineLearningAlgorithms1.png" alt="">&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-17-MachineLearningAlgorithms2.png" alt="">&lt;/p>
&lt;p>机器学习处理流程&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-17-MachineLearningProcess.png" alt="">&lt;/p>
&lt;p>机器学习WorkFlow&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-17-MachineLearningWorkflow.png" alt="">&lt;/p>
&lt;p>机器学习API结构图&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-17-MachineLearningAPI.png" alt="">&lt;/p>
&lt;p>下面部分等待完善&lt;/p>
&lt;hr>
&lt;h3 id="基本统计">基本统计&lt;/h3>
&lt;h3 id="线性回归">线性回归&lt;/h3>
&lt;h4 id="分类">分类&lt;/h4>
&lt;h3 id="clustering">Clustering&lt;/h3>
&lt;h3 id="recommendation">Recommendation&lt;/h3>
&lt;h3 id="hyper-paramters">Hyper paramters&lt;/h3>
&lt;h2 id="graphx">GraphX&lt;/h2></description></item><item><title>《Fast Data Processing with Spark 2（Third Edition)》读书笔记三</title><link>https://crazygit.wiseturtles.com/2018/01/16/fast-data-processing-with-spark2-note-three/</link><pubDate>Tue, 16 Jan 2018 22:55:11 +0800</pubDate><guid>https://crazygit.wiseturtles.com/2018/01/16/fast-data-processing-with-spark2-note-three/</guid><description>&lt;p>本书其它笔记&lt;a href="https://crazygit.wiseturtles.com/2018/01/26/fast-data-processing-with-spark2-note-index/">Fast Data Processing with Spark 2（Third Edition)》读书笔记目&lt;/a>&lt;/p>
&lt;h2 id="数据分析的主力datasetsdataframes">数据分析的主力Datasets/DataFrames&lt;/h2>
&lt;h3 id="datasets概述">DataSets概述&lt;/h3>
&lt;p>Spark中，Dataset就是一组各式各样的列，类似一张excel表格或关系型数据库中的表。可以用于类型检查和语义化查询。&lt;/p>
&lt;p>在R和Python语言中，使用的依然是DataFrame类，但是包含了所有的DataSet APIs。因此可以这样认为，DataSet在Python和R语言中就叫做DataFrame。&lt;/p>
&lt;p>在Scala和Java语言中，使用的是DataSet接口，不存在DataFrame。&lt;/p>
&lt;h3 id="dataset-api概览">DataSet API概览&lt;/h3>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/crazygit/static@main/img/2018-01-16-DataSetAPIs.png" alt="DataSet APIs">&lt;/p>
&lt;p>下面的例子使用的数据文件下载地址:&lt;/p>
&lt;p>&lt;a href="https://github.com/xsankar/fdps-v3">https://github.com/xsankar/fdps-v3&lt;/a>&lt;/p>
&lt;h3 id="常见的dataset接口和函数">常见的Dataset接口和函数&lt;/h3>
&lt;h4 id="读写操作">读写操作&lt;/h4>
&lt;p>这个例子读取的csv文件内容如下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat data/spark-csv/cars.csv
year,make,model,comment,blank
2012,Tesla,S,No comment,
1997,Ford,E350,Go get one now they are going fast,
2015,Chevy,Volt,,
2016,Volvo,XC90,Good Car !,
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>读取和保存&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="c1"># -*- coding: utf-8 -*-&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">pyspark.sql&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">SparkSession&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="n">spark&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">SparkSession&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">builder&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">appName&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Datasets APIs Demo&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">master&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;local&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;spark.logConf&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;spark.logLevel&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;ERROR&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">getOrCreate&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="s2">&amp;#34;Running Spark Version {spark.version}&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">filePath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span>
&lt;span class="n">cars&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;header&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;inferSchema&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;data/spark-csv/cars.csv&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="s2">&amp;#34;Cars has {cars.count()} rows&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printSchema&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1"># 保存为csv格式&lt;/span>
&lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;overwrite&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;header&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;data/cars-out-csv.csv&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="c1"># 按年分区，保存为parquet格式&lt;/span>
&lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;overwrite&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">partitionBy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;year&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parquet&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;data/cars-out-pqt&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>mode&lt;/code>参数有:&lt;/p>
&lt;ul>
&lt;li>&lt;code>overwrite&lt;/code>: 如果文件存在，则覆写已经存在的文件&lt;/li>
&lt;li>&lt;code>append&lt;/code>: 追加写入到已经存在的文件&lt;/li>
&lt;li>&lt;code>ignore&lt;/code>: 会忽略&lt;code>Data Exists&lt;/code>, 并且不会保存数据，使用该模式需要特别注意&lt;/li>
&lt;li>&lt;code>error&lt;/code>: 如果文件存在，抛出异常&lt;/li>
&lt;/ul>
&lt;p>查看保存结果&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ tree data/cars-out-csv.csv data/cars-out-pqt
data/cars-out-csv.csv
├── _SUCCESS
└── part-00000-aa27bc5f-aaeb-4f0c-804f-2d5320803d0d-c000.csv
data/cars-out-pqt
├── _SUCCESS
├── &lt;span class="nv">year&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1997&lt;/span>
│   └── part-00000-160cc90f-7c7a-4d88-b1c8-16c4fd8ec831.c000.snappy.parquet
├── &lt;span class="nv">year&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2012&lt;/span>
│   └── part-00000-160cc90f-7c7a-4d88-b1c8-16c4fd8ec831.c000.snappy.parquet
├── &lt;span class="nv">year&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2015&lt;/span>
│   └── part-00000-160cc90f-7c7a-4d88-b1c8-16c4fd8ec831.c000.snappy.parquet
└── &lt;span class="nv">year&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2016&lt;/span>
└── part-00000-160cc90f-7c7a-4d88-b1c8-16c4fd8ec831.c000.snappy.parquet
&lt;span class="m">4&lt;/span> directories, &lt;span class="m">7&lt;/span> files
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>从保存结果可以看出，保存为csv文件时，是一个目录，而不是单个的csv文件。&lt;/p>
&lt;p>保存为&lt;code>parquet&lt;/code>格式时，由于按照年来分区，因此生成了4个年份的子目录。这样做的好处是可以节约查询时间，比如当查询语句包含&lt;code>year=2015&lt;/code>, 只会去查询&lt;code>year=2015&lt;/code>这个目录的数据。在数据量大时，非常有助于提高查询效率。&lt;/p>
&lt;p>读取保存的数据&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="c1"># -*- coding: utf-8 -*-&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">pyspark.sql&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">SparkSession&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="n">spark&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">SparkSession&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">builder&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">appName&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Datasets APIs Demo&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">master&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;local&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;spark.logConf&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;spark.logLevel&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;ERROR&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">.&lt;/span>&lt;span class="n">getOrCreate&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="s2">&amp;#34;Running Spark Version {spark.version}&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">filePath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span>
&lt;span class="n">cars&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parquet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;data/cars-out-pqt&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="s2">&amp;#34;Cars has {cars.count()} rows&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printSchema&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="聚合函数">聚合函数&lt;/h4>
&lt;p>首页让我们加载测试数据&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">filePath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;header&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;true&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;inferSchema&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;true&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;data/car-data/car-mileage.csv&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="s2">&amp;#34;Cars has {cars.count()} rows&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">Cars&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printSchema&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">root&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">mpg&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">displacement&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">hp&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">torque&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">CRatio&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">RARatio&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">CarbBarrells&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">NoOfSpeed&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">length&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">weight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">automatic&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">mpg&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">displacement&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">hp&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">torque&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">CRatio&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">RARatio&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">CarbBarrells&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">NoOfSpeed&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">weight&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">automatic&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mf">18.9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">350.0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">165&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">260&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">2.56&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">200.3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">69.9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3910&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mf">17.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">350.0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">170&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">275&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.5&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">2.56&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">199.6&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">72.9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3860&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mf">20.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">250.0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">105&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">185&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.25&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">2.73&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">196.7&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">72.2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3510&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="mf">18.25&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">351.0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">143&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">255&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">3.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">199.9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">74.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3890&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="mf">20.07&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">225.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">95&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">170&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">2.76&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">194.1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">71.8&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3365&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+&lt;/span>
&lt;span class="n">only&lt;/span> &lt;span class="n">showing&lt;/span> &lt;span class="n">top&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>descripe&lt;/code>统计列&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">describe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;mpg&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;hp&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;weight&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;automatic&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+-------+-----------------+-----------------+----------------+-------------------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">summary&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">mpg&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">hp&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">weight&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">automatic&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------+-----------------+-----------------+----------------+-------------------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">count&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">mean&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">20.223125&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">136.875&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">3586.6875&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">0.71875&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">stddev&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">6.318289089312789&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">44.98082028541039&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">947.943187269323&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">0.45680340939917435&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="nb">min&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">11.2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1905&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="nb">max&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">36.5&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">223&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">5430&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------+-----------------+-----------------+----------------+-------------------+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>分组统计&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupBy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;automatic&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;mpg&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;torque&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---------+------------------+-----------------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">automatic&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mpg&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">torque&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------+------------------+-----------------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">17.324782608695646&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">257.3636363636364&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">27.630000000000006&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">109.375&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------+------------------+-----------------+&lt;/span>
&lt;span class="c1"># 不分组的情况&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupBy&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;mpg&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;torque&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---------+-----------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mpg&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">torque&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------+-----------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="mf">20.223125&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">217.9&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------+-----------+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>其它的聚合函数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">from&lt;/span> &lt;span class="nn">pyspark.sql.functions&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">avg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">mean&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">agg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;mpg&amp;#34;&lt;/span>&lt;span class="p">]),&lt;/span> &lt;span class="n">mean&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;torque&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---------+-----------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mpg&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">torque&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------+-----------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="mf">20.223125&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">217.9&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------+-----------+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="统计函数">统计函数&lt;/h4>
&lt;p>从前面的DataSets API概览图里可以看到，统计相关的函数都是在&lt;code>sql.stat.*&lt;/code>下面。&lt;/p>
&lt;p>下面看一个利用统计函数的例子&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">filePath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;header&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;true&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;inferSchema&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;true&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;data/car-data/car-mileage.csv&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">mpg&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">displacement&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">hp&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">torque&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">CRatio&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">RARatio&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">CarbBarrells&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">NoOfSpeed&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">weight&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">automatic&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mf">18.9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">350.0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">165&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">260&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">2.56&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">200.3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">69.9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3910&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mf">17.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">350.0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">170&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">275&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.5&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">2.56&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">199.6&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">72.9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3860&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mf">20.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">250.0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">105&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">185&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.25&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">2.73&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">196.7&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">72.2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3510&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="mf">18.25&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">351.0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">143&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">255&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">3.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">199.9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">74.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3890&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="mf">20.07&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">225.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">95&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">170&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">8.4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">2.76&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">194.1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">71.8&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3365&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+&lt;/span>
&lt;span class="n">only&lt;/span> &lt;span class="n">showing&lt;/span> &lt;span class="n">top&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;span class="c1"># 计算相关性&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cor&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stat&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">corr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;hp&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;weight&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;hp to weight: Correlation = &lt;/span>&lt;span class="si">%.4f&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">cor&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">hp&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">weight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Correlation&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">0.8834&lt;/span>
&lt;span class="c1"># 计算协方差&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cov&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stat&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cov&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;hp&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;weight&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;hp to weight: Covariance = &lt;/span>&lt;span class="si">%.4f&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">cov&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">hp&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">weight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Covariance&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">37667.5403&lt;/span>
&lt;span class="c1"># 交叉表显示&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stat&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">crosstab&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;automatic&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;NoOfSpeed&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+-------------------+---+---+---+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">automatic_NoOfSpeed&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------------------+---+---+---+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------------------+---+---+---+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>交叉表的功能是分组统计数据。上面的交叉表类似下面的效果&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">cars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">createOrReplaceGlobalTempView&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Cars&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sql&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Select automatic, NoOfSpeed, count(*) from global_temp.Cars group by automatic, NoOfSpeed&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---------+---------+--------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">automatic&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">NoOfSpeed&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------+---------+--------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------+---------+--------+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>交叉表在数据统计中非常有用，有利于我们观察各组数据直接的关系。下面是利用交叉表查看泰坦尼克号中幸存者和他的属性关系。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;span class="lnt">85
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">filePath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">passengers&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;header&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;inferSchema&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;data/titanic3_02.csv&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">passengers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">passengers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Pclass&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">passengers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Survived&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">passengers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Gender&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">passengers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Age&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="o">...&lt;/span> &lt;span class="n">passengers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;SibSp&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">passengers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Parch&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="n">passengers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Fare&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="o">...&lt;/span>
&lt;span class="c1"># Pclass: 票的等级&lt;/span>
&lt;span class="c1"># SibSp: 兄弟姐妹/配偶在船上&lt;/span>
&lt;span class="c1"># Parch: 父母/子女在船上&lt;/span>
&lt;span class="c1"># Fare: 票价&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">+------+--------+------+------+-----+-----+--------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">Pclass&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">Survived&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">Gender&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">Age&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">SibSp&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">Parch&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">Fare&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+------+--------+------+------+-----+-----+--------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">female&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">29.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">211.3375&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">male&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">0.9167&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">151.55&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">female&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">2.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">151.55&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">male&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">30.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">151.55&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">female&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">25.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">151.55&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+------+--------+------+------+-----+-----+--------+&lt;/span>
&lt;span class="n">only&lt;/span> &lt;span class="n">showing&lt;/span> &lt;span class="n">top&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printSchema&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">root&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">Pclass&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">Survived&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">Gender&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">string&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">Age&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">SibSp&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">Parch&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">Fare&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupBy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Gender&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+------+-----+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">Gender&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+------+-----+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">female&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">466&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">male&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">843&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+------+-----+&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stat&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">crosstab&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Survived&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;Gender&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---------------+------+----+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">Survived_Gender&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">female&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">male&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------------+------+----+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">339&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">161&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">127&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">682&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---------------+------+----+&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stat&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">crosstab&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Survived&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;SibSp&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+--------------+---+---+---+---+---+---+---+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">Survived_SibSp&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+--------------+---+---+---+---+---+---+---+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">309&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">163&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">19&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">582&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">156&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">19&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+--------------+---+---+---+---+---+---+---+&lt;/span>
&lt;span class="c1"># 因为Age是浮点型，直接用Age创建的交叉表的结果非常长，不便于观察。所以将它转换为整型&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">ageDist&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;Survived&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;age&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;age&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cast&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;int&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;AgeBracket&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">ageDist&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">+--------+----------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">Survived&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">AgeBracket&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+--------+----------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">30&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+--------+----------+&lt;/span>
&lt;span class="n">only&lt;/span> &lt;span class="n">showing&lt;/span> &lt;span class="n">top&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;span class="c1"># 20s和30s之间的人最多，还有很多不知道年龄的人&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">ageDist&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">crosstab&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Survived&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;AgeBracket&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+-------------------+---+---+---+---+---+---+---+---+---+----+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">Survived_AgeBracket&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">30&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">80&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">null&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------------------+---+---+---+---+---+---+---+---+---+----+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">56&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">127&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">98&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">52&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">73&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">87&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">217&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">134&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">83&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">38&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">22&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">190&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------------------+---+---+---+---+---+---+---+---+---+----+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="科学计算函数">科学计算函数&lt;/h4>
&lt;p>科学统计函数基本都在&lt;code>sql.functions&lt;/code>下面。&lt;/p>
&lt;p>如: log(), log10(), sqrt(), cbrt(), exp(), pow(), sin(), cos(), tan(), acos(), asin(), atan(), toDegrees(), toRadians()&lt;/p>
&lt;p>使用示例如下:&lt;/p>
&lt;p>创建一个DataFrame&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">from&lt;/span> &lt;span class="nn">pyspark.sql&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Row&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">row&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Row&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;val&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">l&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">rdd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sc&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parallelize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">l&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1"># 有两种方式将rdd转换为dataframe&lt;/span>
&lt;span class="c1"># 方法一:&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">df&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">createDataFrame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rdd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="c1"># 方法二&lt;/span>
&lt;span class="c1"># &amp;gt;&amp;gt;&amp;gt; df = rdd.map(row).toDF()&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>一些示例&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">from&lt;/span> &lt;span class="nn">pyspark.sql.functions&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">log&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">log10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sart&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="n">log1p&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;val&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;val&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ln&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---+------------------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">ln&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+------------------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">0.6931471805599453&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">1.0986122886681098&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+------------------+&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;val&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">log10&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;val&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;log10&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---+-------------------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">log10&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+-------------------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">0.3010299956639812&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">0.47712125471966244&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+-------------------+&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;val&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">sqrt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;val&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;sqrt&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---+------------------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">sqrt&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+------------------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">1.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">1.4142135623730951&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">1.7320508075688772&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+------------------+&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;val&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">log1p&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;val&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ln1p&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---+------------------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">ln1p&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+------------------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">0.6931471805599453&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">1.0986122886681096&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">1.3862943611198906&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+------------------+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>对于给定的直角三角形的两个直角边，求其斜边的长度&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">filePath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;header&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;inferScheam&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;data/hypot.csv&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---+---+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">X&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">Y&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+---+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">24&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">13&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">84&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+---+&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">from&lt;/span> &lt;span class="nn">pyspark.sql.functions&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">hypot&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;X&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;Y&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="o">...&lt;/span> &lt;span class="n">hypot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;X&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;Y&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;hypot&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">+---+---+-----+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">X&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">Y&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">hypot&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+---+-----+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">5.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">13.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">24&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">25.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">41.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">61.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">13&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">84&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">85.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+---+---+-----+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="实战">实战&lt;/h4>
&lt;p>下面让我们通过一个实战，使用前面学到的接口和函数。&lt;/p>
&lt;p>我们使用Northwind Sales的数据集来分析下面的问题:&lt;/p>
&lt;ul>
&lt;li>How many orders were placed by each customer?&lt;/li>
&lt;li>How many orders were placed in each country?&lt;/li>
&lt;li>How many orders were placed for each month/year?&lt;/li>
&lt;li>What is the total number of sales for each customer, year-wise?&lt;/li>
&lt;li>What * is the average order by customer, year-wise?&lt;/li>
&lt;/ul>
&lt;p>读取数据&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">filePath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orders&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;header&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;inferSchema&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;data/NW/NW-Orders-01.csv&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">...&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="s2">&amp;#34;Orders has {orders.count()} rows&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">Orders&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="mi">830&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">+-------+----------+----------+-------------------+-----------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">OrderID&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">CustomerID&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">EmployeeID&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">OrderDate&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">ShipCountry&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------+----------+----------+-------------------+-----------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10248&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">VINET&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">1996&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">07&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">02&lt;/span> &lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">France&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10249&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">TOMSP&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">1996&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">07&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">03&lt;/span> &lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">Germany&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10250&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">HANAR&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">1996&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">07&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">06&lt;/span> &lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">Brazil&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10251&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">VICTE&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">1996&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">07&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">06&lt;/span> &lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">France&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10252&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">SUPRD&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mi">1996&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">07&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">07&lt;/span> &lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">Belgium&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------+----------+----------+-------------------+-----------+&lt;/span>
&lt;span class="n">only&lt;/span> &lt;span class="n">showing&lt;/span> &lt;span class="n">top&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printSchema&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">root&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">OrderID&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">CustomerID&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">string&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">EmployeeID&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">OrderDate&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">timestamp&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">ShipCountry&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">string&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orderDetails&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;header&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;inferSchema&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>\
&lt;span class="o">...&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;data/NW/NW-Order-Details.csv&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="s2">&amp;#34;Order Details has {orderDetails.count()} rows&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">Order&lt;/span> &lt;span class="n">Details&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="mi">2155&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orderDetails&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">+-------+---------+---------+---+--------+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">OrderID&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">ProductId&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">UnitPrice&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">Qty&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">Discount&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------+---------+---------+---+--------+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10248&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">14.0&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10248&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">42&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">9.8&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10248&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">34.8&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10249&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">18.6&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="mi">10249&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">51&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">42.4&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mf">0.0&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-------+---------+---------+---+--------+&lt;/span>
&lt;span class="n">only&lt;/span> &lt;span class="n">showing&lt;/span> &lt;span class="n">top&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orderDetails&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printSchema&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">root&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">OrderID&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">ProductId&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">UnitPrice&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">Qty&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">integer&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">|--&lt;/span> &lt;span class="n">Discount&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">double&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nullable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>解答问题1: &lt;code>How many orders were placed by each customer?&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orderByCustomer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">orders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupBy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;CustomerID&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="kn">from&lt;/span> &lt;span class="nn">pyspark.sql.functions&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">desc&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orderByCustomer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">desc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;count&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">+----------+-----+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">CustomerID&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+----------+-----+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">SAVEA&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">31&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">ERNSH&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">30&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">QUICK&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">28&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">HUNGO&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">19&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">FOLKO&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">19&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+----------+-----+&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>解答问题2: &lt;code>How many orders were placed in each country?&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orderByCountry&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">orders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupBy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;ShipCountry&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">orderByCountry&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">desc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;count&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">+-----------+-----+&lt;/span>
&lt;span class="o">|&lt;/span>&lt;span class="n">ShipCountry&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-----------+-----+&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">Germany&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">122&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">USA&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">122&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">Brazil&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">82&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">France&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">77&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">|&lt;/span> &lt;span class="n">UK&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="mi">56&lt;/span>&lt;span class="o">|&lt;/span>
&lt;span class="o">+-----------+-----+&lt;/span>
&lt;span class="n">only&lt;/span> &lt;span class="n">showing&lt;/span> &lt;span class="n">top&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">rows&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>后面三个问题可以如下解答&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="c1"># -*- coding: utf-8 -*-&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">pyspark.sql&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">SparkSession&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">pyspark.sql.functions&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">to_date&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">month&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">year&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="n">spark&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">SparkSession&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">builder&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">appName&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Datasets APIs Demo&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">master&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;local&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;spark.logConf&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;spark.logLevel&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;ERROR&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">getOrCreate&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="s2">&amp;#34;Running Spark Version {spark.version}&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">filePath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span>
&lt;span class="n">orders&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;header&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;inferSchema&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;data/NW/NW-Orders-01.csv&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">orderDetails&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;header&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;inferSchema&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">csv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filePath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;data/NW/NW-Order-Details.csv&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">orderDetails&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">orderDetails&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;OrderID&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="p">((&lt;/span>&lt;span class="n">orderDetails&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;UnitPrice&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">orderDetails&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Qty&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="p">(&lt;/span>
&lt;span class="n">orderDetails&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;UnitPrice&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">orderDetails&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Qty&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">orderDetails&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;Discount&amp;#39;&lt;/span>&lt;span class="p">]))&lt;/span>&lt;span class="o">.&lt;/span>
&lt;span class="n">name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;OrderPrice&amp;#39;&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1"># 设置DataFrame orderTot的别名为OrderTotal&lt;/span>
&lt;span class="n">orderTot&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupBy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;OrderID&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;OrderPrice&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">alias&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;OrderTotal&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">orderTot&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;OrderID&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">orders_df&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">orders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">orderTot&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">orders&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;OrderID&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">orderTot&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;OrderID&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="s2">&amp;#34;inner&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">orders&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;OrderID&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="n">orders&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;CustomerID&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="n">orders&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;OrderDate&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="n">orders&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;ShipCountry&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">alias&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;ShipCountry&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">orderTot&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;sum(OrderPrice)&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">alias&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Total&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">orders_df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;CustomerID&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1"># 过滤出空行&lt;/span>
&lt;span class="n">orders_df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">orders_df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;Total&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">isNull&lt;/span>&lt;span class="p">())&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1"># 添加Date列&lt;/span>
&lt;span class="n">orders_df2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">orders_df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">withColumn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Date&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">to_date&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">orders_df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;OrderDate&amp;#39;&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;span class="n">orders_df2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">orders_df2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printSchema&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1"># 添加Month和Year列&lt;/span>
&lt;span class="n">orders_df3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">orders_df2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">withColumn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Month&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">month&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">orders_df2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;OrderDate&amp;#34;&lt;/span>&lt;span class="p">]))&lt;/span> \
&lt;span class="o">.&lt;/span>&lt;span class="n">withColumn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Year&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">year&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">orders_df2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;OrderDate&amp;#34;&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;span class="n">orders_df3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">orders_df3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printSchema&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1"># 问题3&lt;/span>
&lt;span class="n">ordersByYM&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">orders_df3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupBy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Year&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;Month&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Total&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">alias&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Total&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">ordersByYM&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ordersByYM&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;Year&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ordersByYM&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;Month&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1"># 问题4&lt;/span>
&lt;span class="n">ordersByCY&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">orders_df3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupBy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;CustomerID&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;Year&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Total&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">alias&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Total&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">ordersByCY&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ordersByCY&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;CustomerID&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ordersByCY&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;Year&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1"># 问题5&lt;/span>
&lt;span class="n">ordersCA&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">orders_df3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupBy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;CustomerID&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">avg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Total&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">alias&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Total&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">ordersCA&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;avg(Total)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ascending&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">False&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">spark&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>